2025-11-09T23:38:14.1156917Z ##[group]Run cargo fmt -- --check
2025-11-09T23:38:14.1158147Z [36;1mcargo fmt -- --check[0m
2025-11-09T23:38:14.1192814Z shell: /usr/bin/bash -e {0}
2025-11-09T23:38:14.1193685Z env:
2025-11-09T23:38:14.1194582Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:14.1195487Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:14.1196399Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:14.1198937Z ##[endgroup]
2025-11-09T23:38:14.3167714Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:4:
2025-11-09T23:38:14.3178077Z  use consensus_proof::block::connect_block;
2025-11-09T23:38:14.3180210Z  use consensus_proof::segwit::Witness;
2025-11-09T23:38:14.3181918Z  use consensus_proof::{
2025-11-09T23:38:14.3184576Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet,
2025-11-09T23:38:14.3188471Z +    Block, BlockHeader, OutPoint, Transaction, TransactionInput, TransactionOutput, UtxoSet,
2025-11-09T23:38:14.3191232Z  };
2025-11-09T23:38:14.3193183Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-09T23:38:14.3195613Z  
2025-11-09T23:38:14.3198550Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:23:
2025-11-09T23:38:14.3202087Z              sequence: 0xffffffff,
2025-11-09T23:38:14.3203608Z          }],
2025-11-09T23:38:14.3205046Z          outputs: vec![TransactionOutput {
2025-11-09T23:38:14.3206864Z -            value: 50_000_000_000, // 50 BTC
2025-11-09T23:38:14.3208566Z +            value: 50_000_000_000,     // 50 BTC
2025-11-09T23:38:14.3210331Z              script_pubkey: vec![0x51], // OP_1
2025-11-09T23:38:14.3211977Z          }],
2025-11-09T23:38:14.3213358Z          lock_time: 0,
2025-11-09T23:38:14.3216621Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:44:
2025-11-09T23:38:14.3220097Z              }],
2025-11-09T23:38:14.3221352Z              outputs: vec![
2025-11-09T23:38:14.3222886Z                  TransactionOutput {
2025-11-09T23:38:14.3224737Z -                    value: 10_000_000, // 0.1 BTC
2025-11-09T23:38:14.3226552Z +                    value: 10_000_000,             // 0.1 BTC
2025-11-09T23:38:14.3228530Z                      script_pubkey: vec![0x51; 25], // Longer script
2025-11-09T23:38:14.3230403Z                  },
2025-11-09T23:38:14.3231740Z                  TransactionOutput {
2025-11-09T23:38:14.3235323Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:113:
2025-11-09T23:38:14.3238934Z      benchmark_connect_block_realistic_1000tx
2025-11-09T23:38:14.3241216Z  );
2025-11-09T23:38:14.3242467Z  criterion_main!(benches);
2025-11-09T23:38:14.3243913Z -
2025-11-09T23:38:14.3245154Z  
2025-11-09T23:38:14.3330115Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:1:
2025-11-09T23:38:14.3333371Z +use bllvm_consensus::crypto::OptimizedSha256;
2025-11-09T23:38:14.3335599Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-09T23:38:14.3339112Z  use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3397557Z -use bllvm_consensus::crypto::OptimizedSha256;
2025-11-09T23:38:14.3398849Z  
2025-11-09T23:38:14.3399595Z  fn benchmark_sha256(c: &mut Criterion) {
2025-11-09T23:38:14.3400618Z      let data = vec![0u8; 1024];
2025-11-09T23:38:14.3402404Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:29:
2025-11-09T23:38:14.3404280Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.3405420Z  fn benchmark_sha_ni_single(c: &mut Criterion) {
2025-11-09T23:38:14.3406548Z      use bllvm_consensus::crypto::sha_ni;
2025-11-09T23:38:14.3407967Z -    
2025-11-09T23:38:14.3409111Z +
2025-11-09T23:38:14.3410340Z      if !sha_ni::is_sha_ni_available() {
2025-11-09T23:38:14.3412080Z          return; // Skip on CPUs without SHA-NI
2025-11-09T23:38:14.3413296Z      }
2025-11-09T23:38:14.3415742Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:36:
2025-11-09T23:38:14.3417562Z -    
2025-11-09T23:38:14.3418211Z +
2025-11-09T23:38:14.3418890Z      let data_32b = vec![0u8; 32];
2025-11-09T23:38:14.3419817Z      let data_64b = vec![0u8; 64];
2025-11-09T23:38:14.3420735Z      let data_1kb = vec![0u8; 1024];
2025-11-09T23:38:14.3422512Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:40:
2025-11-09T23:38:14.3424520Z -    
2025-11-09T23:38:14.3425309Z +
2025-11-09T23:38:14.3426063Z      // 32-byte input (typical transaction hash)
2025-11-09T23:38:14.3427137Z      c.bench_function("sha_ni_32b", |b| {
2025-11-09T23:38:14.3428784Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_32b))))
2025-11-09T23:38:14.3430816Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:44:
2025-11-09T23:38:14.3432645Z      });
2025-11-09T23:38:14.3433326Z -    
2025-11-09T23:38:14.3434180Z +
2025-11-09T23:38:14.3435351Z      c.bench_function("sha2_crate_32b", |b| {
2025-11-09T23:38:14.3436340Z          b.iter(|| {
2025-11-09T23:38:14.3437241Z              let hash = Sha256::digest(black_box(&data_32b));
2025-11-09T23:38:14.3439163Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:49:
2025-11-09T23:38:14.3440992Z              black_box(hash)
2025-11-09T23:38:14.3441803Z          })
2025-11-09T23:38:14.3442461Z      });
2025-11-09T23:38:14.3443098Z -    
2025-11-09T23:38:14.3443734Z +
2025-11-09T23:38:14.3447071Z      // 64-byte input (typical block header)
2025-11-09T23:38:14.3448167Z      c.bench_function("sha_ni_64b", |b| {
2025-11-09T23:38:14.3449333Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_64b))))
2025-11-09T23:38:14.3451345Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:56:
2025-11-09T23:38:14.3453183Z      });
2025-11-09T23:38:14.3453830Z -    
2025-11-09T23:38:14.3455022Z +
2025-11-09T23:38:14.3455823Z      c.bench_function("sha2_crate_64b", |b| {
2025-11-09T23:38:14.3458919Z          b.iter(|| {
2025-11-09T23:38:14.3460154Z              let hash = Sha256::digest(black_box(&data_64b));
2025-11-09T23:38:14.3462083Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:61:
2025-11-09T23:38:14.3463917Z              black_box(hash)
2025-11-09T23:38:14.3465111Z          })
2025-11-09T23:38:14.3465795Z      });
2025-11-09T23:38:14.3466432Z -    
2025-11-09T23:38:14.3467079Z +
2025-11-09T23:38:14.3467922Z      // 1KB input
2025-11-09T23:38:14.3468956Z      c.bench_function("sha_ni_1kb", |b| {
2025-11-09T23:38:14.3470144Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_1kb))))
2025-11-09T23:38:14.3472144Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:68:
2025-11-09T23:38:14.3473956Z      });
2025-11-09T23:38:14.3474821Z -    
2025-11-09T23:38:14.3475471Z +
2025-11-09T23:38:14.3476147Z      // Double SHA256 comparison
2025-11-09T23:38:14.3478848Z      c.bench_function("sha_ni_double_32b", |b| {
2025-11-09T23:38:14.3480067Z          b.iter(|| black_box(sha_ni::hash256(black_box(&data_32b))))
2025-11-09T23:38:14.3482073Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:73:
2025-11-09T23:38:14.3483857Z      });
2025-11-09T23:38:14.3484630Z -    
2025-11-09T23:38:14.3485285Z +
2025-11-09T23:38:14.3486054Z      c.bench_function("sha2_crate_double_32b", |b| {
2025-11-09T23:38:14.3487095Z          b.iter(|| {
2025-11-09T23:38:14.3487988Z              let hash1 = Sha256::digest(black_box(&data_32b));
2025-11-09T23:38:14.3491603Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:194:
2025-11-09T23:38:14.3493470Z  
2025-11-09T23:38:14.3494163Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3495775Z  fn benchmark_merkle_root_batching(c: &mut Criterion) {
2025-11-09T23:38:14.3497023Z -use bllvm_consensus::mining::calculate_merkle_root;
2025-11-09T23:38:14.3498608Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3500232Z +    use bllvm_consensus::mining::calculate_merkle_root;
2025-11-09T23:38:14.3501810Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3503236Z  
2025-11-09T23:38:14.3503927Z      let tx_counts = vec![10, 100, 1000];
2025-11-09T23:38:14.3505038Z  
2025-11-09T23:38:14.3506572Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:232:
2025-11-09T23:38:14.3509381Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3510462Z  fn benchmark_block_validation_tx_ids(c: &mut Criterion) {
2025-11-09T23:38:14.3511804Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-09T23:38:14.3513654Z -use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3515940Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3519038Z +    use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3520861Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3522704Z  
2025-11-09T23:38:14.3523479Z      let tx_counts = vec![10, 100];
2025-11-09T23:38:14.3524634Z  
2025-11-09T23:38:14.3526191Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:539:
2025-11-09T23:38:14.3528022Z  );
2025-11-09T23:38:14.3530943Z  
2025-11-09T23:38:14.3531641Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.3533215Z -criterion_group!(benches, benchmark_sha256, benchmark_double_sha256, benchmark_sha_ni_single);
2025-11-09T23:38:14.3534934Z +criterion_group!(
2025-11-09T23:38:14.3535664Z +    benches,
2025-11-09T23:38:14.3536399Z +    benchmark_sha256,
2025-11-09T23:38:14.3537201Z +    benchmark_double_sha256,
2025-11-09T23:38:14.3538087Z +    benchmark_sha_ni_single
2025-11-09T23:38:14.3538900Z +);
2025-11-09T23:38:14.3539528Z  
2025-11-09T23:38:14.3540183Z  criterion_main!(benches);
2025-11-09T23:38:14.3540988Z  
2025-11-09T23:38:14.3542862Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:11:
2025-11-09T23:38:14.3545133Z  //!
2025-11-09T23:38:14.3546155Z  //! Run with: cargo bench --bench performance_focused --features production
2025-11-09T23:38:14.3548975Z  
2025-11-09T23:38:14.3550129Z -use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-09T23:38:14.3551582Z  use bllvm_consensus::{
2025-11-09T23:38:14.3553038Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet, UTXO,
2025-11-09T23:38:14.3554812Z -    block::connect_block,
2025-11-09T23:38:14.3555647Z -    segwit::Witness,
2025-11-09T23:38:14.3556889Z +    block::connect_block, segwit::Witness, Block, BlockHeader, OutPoint, Transaction,
2025-11-09T23:38:14.3558477Z +    TransactionInput, TransactionOutput, UtxoSet, UTXO,
2025-11-09T23:38:14.3559562Z  };
2025-11-09T23:38:14.3560688Z +use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-09T23:38:14.3562094Z  
2025-11-09T23:38:14.3563135Z  // ============================================================================
2025-11-09T23:38:14.3564709Z  // CRYPTOGRAPHIC OPERATIONS (SHA-NI + AVX2)
2025-11-09T23:38:14.3566710Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:23:
2025-11-09T23:38:14.3568633Z  // ============================================================================
2025-11-09T23:38:14.3569624Z  
2025-11-09T23:38:14.3570336Z  fn bench_hash_single(c: &mut Criterion) {
2025-11-09T23:38:14.3571471Z -    let data_32b = vec![0u8; 32];  // Transaction hash size
2025-11-09T23:38:14.3573022Z -    let data_64b = vec![0u8; 64];  // Block header size
2025-11-09T23:38:14.3574050Z -    
2025-11-09T23:38:14.3576799Z +    let data_32b = vec![0u8; 32]; // Transaction hash size
2025-11-09T23:38:14.3577993Z +    let data_64b = vec![0u8; 64]; // Block header size
2025-11-09T23:38:14.3578993Z +
2025-11-09T23:38:14.3579775Z      let mut group = c.benchmark_group("hash_single");
2025-11-09T23:38:14.3580796Z -    
2025-11-09T23:38:14.3581434Z +
2025-11-09T23:38:14.3582236Z      // Single SHA256 - 32 bytes (typical transaction hash)
2025-11-09T23:38:14.3583399Z      group.bench_function("sha256_32b", |b| {
2025-11-09T23:38:14.3584547Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3586370Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:36:
2025-11-09T23:38:14.3588963Z              black_box(hash)
2025-11-09T23:38:14.3589764Z          })
2025-11-09T23:38:14.3590427Z      });
2025-11-09T23:38:14.3591057Z -    
2025-11-09T23:38:14.3591714Z +
2025-11-09T23:38:14.3592439Z      // Double SHA256 - 32 bytes (Bitcoin standard)
2025-11-09T23:38:14.3593586Z      group.bench_function("double_sha256_32b", |b| {
2025-11-09T23:38:14.3594773Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3596578Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:46:
2025-11-09T23:38:14.3598442Z              black_box(hash2)
2025-11-09T23:38:14.3600751Z          })
2025-11-09T23:38:14.3601406Z      });
2025-11-09T23:38:14.3602047Z -    
2025-11-09T23:38:14.3602686Z +
2025-11-09T23:38:14.3603352Z      // Block header hash - 64 bytes
2025-11-09T23:38:14.3604502Z      group.bench_function("double_sha256_64b", |b| {
2025-11-09T23:38:14.3605597Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3607408Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:56:
2025-11-09T23:38:14.3609537Z              black_box(hash2)
2025-11-09T23:38:14.3611199Z          })
2025-11-09T23:38:14.3611876Z      });
2025-11-09T23:38:14.3612512Z -    
2025-11-09T23:38:14.3613410Z +
2025-11-09T23:38:14.3614057Z      group.finish();
2025-11-09T23:38:14.3614919Z  }
2025-11-09T23:38:14.3615546Z  
2025-11-09T23:38:14.3617079Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:63:
2025-11-09T23:38:14.3618953Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3619871Z  fn bench_hash_batch(c: &mut Criterion) {
2025-11-09T23:38:14.3621040Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-09T23:38:14.3622560Z -    
2025-11-09T23:38:14.3623225Z +
2025-11-09T23:38:14.3623892Z      let data = vec![0u8; 64];
2025-11-09T23:38:14.3625021Z      let mut group = c.benchmark_group("hash_batch");
2025-11-09T23:38:14.3626349Z -    
2025-11-09T23:38:14.3626983Z +
2025-11-09T23:38:14.3627690Z      // Batch sizes that matter in real blocks
2025-11-09T23:38:14.3628696Z      for size in [8, 16, 32, 64, 128].iter() {
2025-11-09T23:38:14.3631919Z          let inputs: Vec<&[u8]> = vec![data.as_slice(); *size];
2025-11-09T23:38:14.3633901Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:73:
2025-11-09T23:38:14.3635873Z -        
2025-11-09T23:38:14.3637043Z -        group.bench_with_input(BenchmarkId::new("avx2_double_sha256", size), size, |b, _| {
2025-11-09T23:38:14.3639154Z -            b.iter(|| {
2025-11-09T23:38:14.3640303Z -                black_box(simd_vectorization::batch_double_sha256(black_box(&inputs)))
2025-11-09T23:38:14.3641882Z -            })
2025-11-09T23:38:14.3642587Z -        });
2025-11-09T23:38:14.3643252Z +
2025-11-09T23:38:14.3643927Z +        group.bench_with_input(
2025-11-09T23:38:14.3645038Z +            BenchmarkId::new("avx2_double_sha256", size),
2025-11-09T23:38:14.3646062Z +            size,
2025-11-09T23:38:14.3646764Z +            |b, _| {
2025-11-09T23:38:14.3647998Z +                b.iter(|| black_box(simd_vectorization::batch_double_sha256(black_box(&inputs))))
2025-11-09T23:38:14.3649760Z +            },
2025-11-09T23:38:14.3650482Z +        );
2025-11-09T23:38:14.3651162Z      }
2025-11-09T23:38:14.3651816Z -    
2025-11-09T23:38:14.3652477Z +
2025-11-09T23:38:14.3653148Z      group.finish();
2025-11-09T23:38:14.3653956Z  }
2025-11-09T23:38:14.3654736Z  
2025-11-09T23:38:14.3656330Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:100:
2025-11-09T23:38:14.3658235Z              sequence: 0xffffffff,
2025-11-09T23:38:14.3659127Z          }],
2025-11-09T23:38:14.3659909Z          outputs: vec![TransactionOutput {
2025-11-09T23:38:14.3660923Z -            value: 1_000_000, // 0.01 BTC
2025-11-09T23:38:14.3661915Z +            value: 1_000_000,          // 0.01 BTC
2025-11-09T23:38:14.3662955Z              script_pubkey: vec![0x51], // OP_1
2025-11-09T23:38:14.3663929Z          }],
2025-11-09T23:38:14.3664820Z          lock_time: 0,
2025-11-09T23:38:14.3666554Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:109:
2025-11-09T23:38:14.3668415Z  
2025-11-09T23:38:14.3669204Z  fn bench_transaction_basics(c: &mut Criterion) {
2025-11-09T23:38:14.3670395Z      let tx = create_simple_transaction();
2025-11-09T23:38:14.3671361Z -    
2025-11-09T23:38:14.3672032Z +
2025-11-09T23:38:14.3672834Z      let mut group = c.benchmark_group("transaction");
2025-11-09T23:38:14.3673891Z -    
2025-11-09T23:38:14.3674670Z +
2025-11-09T23:38:14.3675588Z      // Transaction serialization (needed for tx ID calculation)
2025-11-09T23:38:14.3678196Z      group.bench_function("serialize", |b| {
2025-11-09T23:38:14.3679588Z          use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3681828Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:118:
2025-11-09T23:38:14.3683701Z -        b.iter(|| {
2025-11-09T23:38:14.3684744Z -            black_box(serialize_transaction(black_box(&tx)))
2025-11-09T23:38:14.3685846Z -        })
2025-11-09T23:38:14.3686763Z +        b.iter(|| black_box(serialize_transaction(black_box(&tx))))
2025-11-09T23:38:14.3687904Z      });
2025-11-09T23:38:14.3688579Z -    
2025-11-09T23:38:14.3689237Z +
2025-11-09T23:38:14.3690103Z      // Transaction ID calculation (SHA256D of serialized tx)
2025-11-09T23:38:14.3691331Z      group.bench_function("calculate_id", |b| {
2025-11-09T23:38:14.3692472Z          use bllvm_consensus::block::calculate_tx_id;
2025-11-09T23:38:14.3694542Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:126:
2025-11-09T23:38:14.3696420Z -        b.iter(|| {
2025-11-09T23:38:14.3698804Z -            black_box(calculate_tx_id(black_box(&tx)))
2025-11-09T23:38:14.3699823Z -        })
2025-11-09T23:38:14.3700670Z +        b.iter(|| black_box(calculate_tx_id(black_box(&tx))))
2025-11-09T23:38:14.3701743Z      });
2025-11-09T23:38:14.3702420Z -    
2025-11-09T23:38:14.3703081Z +
2025-11-09T23:38:14.3703754Z      group.finish();
2025-11-09T23:38:14.3704632Z  }
2025-11-09T23:38:14.3705282Z  
2025-11-09T23:38:14.3706873Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:153:
2025-11-09T23:38:14.3708795Z                  script_pubkey: vec![0x51],
2025-11-09T23:38:14.3709747Z              }],
2025-11-09T23:38:14.3710486Z              lock_time: 0,
2025-11-09T23:38:14.3711305Z -        }
2025-11-09T23:38:14.3711986Z +        },
2025-11-09T23:38:14.3712665Z      ];
2025-11-09T23:38:14.3713539Z -    
2025-11-09T23:38:14.3714198Z +
2025-11-09T23:38:14.3715055Z      // Regular transactions
2025-11-09T23:38:14.3715938Z      for i in 0..num_txs {
2025-11-09T23:38:14.3716830Z          transactions.push(Transaction {
2025-11-09T23:38:14.3718731Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:181:
2025-11-09T23:38:14.3720632Z              lock_time: 0,
2025-11-09T23:38:14.3721766Z          });
2025-11-09T23:38:14.3722463Z      }
2025-11-09T23:38:14.3723117Z -    
2025-11-09T23:38:14.3723788Z +
2025-11-09T23:38:14.3724569Z      Block {
2025-11-09T23:38:14.3725324Z          header: BlockHeader {
2025-11-09T23:38:14.3726206Z              version: 1,
2025-11-09T23:38:14.3727932Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:198:
2025-11-09T23:38:14.3730381Z  fn bench_block_validation(c: &mut Criterion) {
2025-11-09T23:38:14.3731603Z      let mut group = c.benchmark_group("block_validation");
2025-11-09T23:38:14.3732981Z      group.sample_size(10); // Fewer samples for longer benchmarks
2025-11-09T23:38:14.3734153Z -    
2025-11-09T23:38:14.3735095Z +
2025-11-09T23:38:14.3736155Z      // Small block (10 txs) - typical for quick blocks
2025-11-09T23:38:14.3737323Z      let block_10 = create_realistic_block(10);
2025-11-09T23:38:14.3739226Z      let witnesses_10: Vec<Witness> = block_10.transactions.iter().map(|_| Vec::new()).collect();
2025-11-09T23:38:14.3741898Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:205:
2025-11-09T23:38:14.3743767Z -    
2025-11-09T23:38:14.3744568Z +
2025-11-09T23:38:14.3745300Z      group.bench_function("10_txs", |b| {
2025-11-09T23:38:14.3746283Z          b.iter(|| {
2025-11-09T23:38:14.3748870Z              let utxo_set = UtxoSet::new();
2025-11-09T23:38:14.3750746Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:215:
2025-11-09T23:38:14.3752600Z              );
2025-11-09T23:38:14.3753310Z          })
2025-11-09T23:38:14.3753994Z      });
2025-11-09T23:38:14.3754834Z -    
2025-11-09T23:38:14.3755497Z +
2025-11-09T23:38:14.3756289Z      // Medium block (100 txs) - typical average block
2025-11-09T23:38:14.3759222Z      let block_100 = create_realistic_block(100);
2025-11-09T23:38:14.3760822Z      let witnesses_100: Vec<Witness> = block_100.transactions.iter().map(|_| Vec::new()).collect();
2025-11-09T23:38:14.3763474Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:222:
2025-11-09T23:38:14.3765491Z -    
2025-11-09T23:38:14.3766162Z +
2025-11-09T23:38:14.3766898Z      group.bench_function("100_txs", |b| {
2025-11-09T23:38:14.3767879Z          b.iter(|| {
2025-11-09T23:38:14.3768711Z              let utxo_set = UtxoSet::new();
2025-11-09T23:38:14.3771820Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:232:
2025-11-09T23:38:14.3773675Z              );
2025-11-09T23:38:14.3774542Z          })
2025-11-09T23:38:14.3775222Z      });
2025-11-09T23:38:14.3775887Z -    
2025-11-09T23:38:14.3776541Z +
2025-11-09T23:38:14.3777212Z      group.finish();
2025-11-09T23:38:14.3779435Z  }
2025-11-09T23:38:14.3780091Z  
2025-11-09T23:38:14.3781665Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:242:
2025-11-09T23:38:14.3783555Z  
2025-11-09T23:38:14.3784858Z  fn bench_utxo_operations(c: &mut Criterion) {
2025-11-09T23:38:14.3785955Z      use std::collections::HashMap;
2025-11-09T23:38:14.3786865Z -    
2025-11-09T23:38:14.3787527Z +
2025-11-09T23:38:14.3788293Z      let mut utxo_set: UtxoSet = HashMap::new();
2025-11-09T23:38:14.3789350Z      let outpoint = OutPoint {
2025-11-09T23:38:14.3790236Z          hash: [1; 32],
2025-11-09T23:38:14.3791942Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:253:
2025-11-09T23:38:14.3793857Z          script_pubkey: vec![0x51],
2025-11-09T23:38:14.3794908Z          height: 0,
2025-11-09T23:38:14.3795652Z      };
2025-11-09T23:38:14.3796315Z -    
2025-11-09T23:38:14.3796975Z +
2025-11-09T23:38:14.3797734Z      let mut group = c.benchmark_group("utxo");
2025-11-09T23:38:14.3798726Z -    
2025-11-09T23:38:14.3799386Z +
2025-11-09T23:38:14.3800044Z      // Insert UTXO
2025-11-09T23:38:14.3801229Z      group.bench_function("insert", |b| {
2025-11-09T23:38:14.3802204Z          b.iter(|| {
2025-11-09T23:38:14.3804151Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:264:
2025-11-09T23:38:14.3806267Z              black_box(set)
2025-11-09T23:38:14.3807082Z          })
2025-11-09T23:38:14.3807760Z      });
2025-11-09T23:38:14.3808418Z -    
2025-11-09T23:38:14.3809075Z +
2025-11-09T23:38:14.3809734Z      // Lookup UTXO
2025-11-09T23:38:14.3810625Z      utxo_set.insert(outpoint.clone(), utxo.clone());
2025-11-09T23:38:14.3811747Z      group.bench_function("get", |b| {
2025-11-09T23:38:14.3813798Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:271:
2025-11-09T23:38:14.3815813Z -        b.iter(|| {
2025-11-09T23:38:14.3816728Z -            black_box(utxo_set.get(black_box(&outpoint)))
2025-11-09T23:38:14.3817792Z -        })
2025-11-09T23:38:14.3818690Z +        b.iter(|| black_box(utxo_set.get(black_box(&outpoint))))
2025-11-09T23:38:14.3819831Z      });
2025-11-09T23:38:14.3820487Z -    
2025-11-09T23:38:14.3821152Z +
2025-11-09T23:38:14.3821804Z      // Remove UTXO
2025-11-09T23:38:14.3823957Z      group.bench_function("remove", |b| {
2025-11-09T23:38:14.3825088Z          b.iter(|| {
2025-11-09T23:38:14.3826771Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:280:
2025-11-09T23:38:14.3828762Z              black_box(set.remove(black_box(&outpoint)))
2025-11-09T23:38:14.3829800Z          })
2025-11-09T23:38:14.3832014Z      });
2025-11-09T23:38:14.3832701Z -    
2025-11-09T23:38:14.3833363Z +
2025-11-09T23:38:14.3834038Z      group.finish();
2025-11-09T23:38:14.3834977Z  }
2025-11-09T23:38:14.3835629Z  
2025-11-09T23:38:14.3837230Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:318:
2025-11-09T23:38:14.3839101Z      block_benches,
2025-11-09T23:38:14.3839886Z      utxo_benches
2025-11-09T23:38:14.3840604Z  );
2025-11-09T23:38:14.3841258Z -
2025-11-09T23:38:14.3841902Z  
2025-11-09T23:38:14.3843583Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/examples/cpu_features.rs:3:
2025-11-09T23:38:14.3845775Z      {
2025-11-09T23:38:14.3846551Z          println!("CPU Feature Detection:");
2025-11-09T23:38:14.3849478Z          println!("  AVX2: {}", std::arch::is_x86_feature_detected!("avx2"));
2025-11-09T23:38:14.3851245Z -        println!("  SSE4.1: {}", std::arch::is_x86_feature_detected!("sse4.1"));
2025-11-09T23:38:14.3852515Z +        println!(
2025-11-09T23:38:14.3853280Z +            "  SSE4.1: {}",
2025-11-09T23:38:14.3854253Z +            std::arch::is_x86_feature_detected!("sse4.1")
2025-11-09T23:38:14.3855447Z +        );
2025-11-09T23:38:14.3856418Z          println!("  SHA-NI: {}", std::arch::is_x86_feature_detected!("sha"));
2025-11-09T23:38:14.3859665Z          println!("  AVX: {}", std::arch::is_x86_feature_detected!("avx"));
2025-11-09T23:38:14.3860861Z      }
2025-11-09T23:38:14.4585575Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:58:
2025-11-09T23:38:14.4588801Z              return override_val;
2025-11-09T23:38:14.4590371Z          }
2025-11-09T23:38:14.4591625Z      }
2025-11-09T23:38:14.4592775Z -    
2025-11-09T23:38:14.4593907Z +
2025-11-09T23:38:14.4595772Z      // Load from environment variable (supports config files via std::env)
2025-11-09T23:38:14.4597607Z      // Default to 0 (validate all blocks) for maximum safety
2025-11-09T23:38:14.4598962Z      std::env::var("ASSUME_VALID_HEIGHT")
2025-11-09T23:38:14.4601460Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:199:
2025-11-09T23:38:14.4603372Z              .collect();
2025-11-09T23:38:14.4604165Z  
2025-11-09T23:38:14.4605464Z          // Batch UTXO lookup for all transactions (single pass through HashMap)
2025-11-09T23:38:14.4607682Z -        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> = 
2025-11-09T23:38:14.4610133Z +        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> =
2025-11-09T23:38:14.4611616Z              std::collections::HashMap::with_capacity(all_prevouts.len());
2025-11-09T23:38:14.4613065Z          for prevout in &all_prevouts {
2025-11-09T23:38:14.4614167Z              if let Some(utxo) = utxo_set.get(prevout) {
2025-11-09T23:38:14.4630553Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:297:
2025-11-09T23:38:14.4632499Z                          let input_utxos: Vec<(usize, Option<&ByteString>)> = {
2025-11-09T23:38:14.4633859Z                              let mut result = Vec::with_capacity(tx.inputs.len());
2025-11-09T23:38:14.4637388Z                              for (j, input) in tx.inputs.iter().enumerate() {
2025-11-09T23:38:14.4638890Z -                                result.push((j, utxo_set.get(&input.prevout).map(|u| &u.script_pubkey)));
2025-11-09T23:38:14.4640278Z +                                result.push((
2025-11-09T23:38:14.4641276Z +                                    j,
2025-11-09T23:38:14.4642418Z +                                    utxo_set.get(&input.prevout).map(|u| &u.script_pubkey),
2025-11-09T23:38:14.4643577Z +                                ));
2025-11-09T23:38:14.4644692Z                              }
2025-11-09T23:38:14.4645559Z                              result
2025-11-09T23:38:14.4646434Z                          };
2025-11-09T23:38:14.4647872Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:365:
2025-11-09T23:38:14.4650347Z  
2025-11-09T23:38:14.4651026Z                  if !script_valid {
2025-11-09T23:38:14.4651930Z                      return Ok((
2025-11-09T23:38:14.4652891Z -                        ValidationResult::Invalid(format!(
2025-11-09T23:38:14.4654024Z -                            "Invalid script at transaction {i}"
2025-11-09T23:38:14.4655597Z -                        )),
2025-11-09T23:38:14.4656898Z +                        ValidationResult::Invalid(format!("Invalid script at transaction {i}")),
2025-11-09T23:38:14.4659759Z                          utxo_set,
2025-11-09T23:38:14.4660630Z                      ));
2025-11-09T23:38:14.4661405Z                  }
2025-11-09T23:38:14.4662766Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:374:
2025-11-09T23:38:14.4664455Z  
2025-11-09T23:38:14.4665265Z                  // Use checked arithmetic to prevent fee overflow
2025-11-09T23:38:14.4666511Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-09T23:38:14.4668181Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-09T23:38:14.4671355Z +                    ConsensusError::BlockValidation(format!(
2025-11-09T23:38:14.4672542Z +                        "Total fees overflow at transaction {i}"
2025-11-09T23:38:14.4673591Z +                    ))
2025-11-09T23:38:14.4674480Z                  })?;
2025-11-09T23:38:14.4675223Z              }
2025-11-09T23:38:14.4676091Z          }
2025-11-09T23:38:14.4677408Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:426:
2025-11-09T23:38:14.4681150Z                          .map_err(|e| ConsensusError::TransactionValidation(e.to_string()))?;
2025-11-09T23:38:14.4682406Z  
2025-11-09T23:38:14.4683310Z                      let fee = total_input.checked_sub(total_output).ok_or_else(|| {
2025-11-09T23:38:14.4685168Z -                        ConsensusError::TransactionValidation("Fee calculation underflow".to_string())
2025-11-09T23:38:14.4686739Z +                        ConsensusError::TransactionValidation(
2025-11-09T23:38:14.4687881Z +                            "Fee calculation underflow".to_string(),
2025-11-09T23:38:14.4688908Z +                        )
2025-11-09T23:38:14.4689734Z                      })?;
2025-11-09T23:38:14.4690509Z  
2025-11-09T23:38:14.4691168Z                      if fee < 0 {
2025-11-09T23:38:14.4693026Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:441:
2025-11-09T23:38:14.4694695Z  
2025-11-09T23:38:14.4695544Z                  if !matches!(input_valid, ValidationResult::Valid) {
2025-11-09T23:38:14.4696641Z                      return Ok((
2025-11-09T23:38:14.4697962Z -                        ValidationResult::Invalid(format!("Invalid transaction inputs at index {i}")),
2025-11-09T23:38:14.4699460Z +                        ValidationResult::Invalid(format!(
2025-11-09T23:38:14.4700574Z +                            "Invalid transaction inputs at index {i}"
2025-11-09T23:38:14.4701602Z +                        )),
2025-11-09T23:38:14.4702420Z                          utxo_set,
2025-11-09T23:38:14.4703268Z                      ));
2025-11-09T23:38:14.4704021Z                  }
2025-11-09T23:38:14.4705494Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:495:
2025-11-09T23:38:14.4707061Z  
2025-11-09T23:38:14.4707842Z                  // Use checked arithmetic to prevent fee overflow
2025-11-09T23:38:14.4709094Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-09T23:38:14.4710743Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-09T23:38:14.4712318Z +                    ConsensusError::BlockValidation(format!(
2025-11-09T23:38:14.4713617Z +                        "Total fees overflow at transaction {i}"
2025-11-09T23:38:14.4714736Z +                    ))
2025-11-09T23:38:14.4715478Z                  })?;
2025-11-09T23:38:14.4716211Z              }
2025-11-09T23:38:14.4716900Z          }
2025-11-09T23:38:14.4719667Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:779:
2025-11-09T23:38:14.4721567Z      // Estimate: current size + new outputs - spent inputs (for non-coinbase)
2025-11-09T23:38:14.4722877Z      #[cfg(feature = "production")]
2025-11-09T23:38:14.4723784Z      {
2025-11-09T23:38:14.4724622Z -        let estimated_new_size = utxo_set.len()
2025-11-09T23:38:14.4725674Z +        let estimated_new_size = utxo_set
2025-11-09T23:38:14.4726605Z +            .len()
2025-11-09T23:38:14.4727409Z              .saturating_add(tx.outputs.len())
2025-11-09T23:38:14.4728662Z              .saturating_sub(if is_coinbase(tx) { 0 } else { tx.inputs.len() });
2025-11-09T23:38:14.4731425Z          if estimated_new_size > utxo_set.capacity() {
2025-11-09T23:38:14.4733072Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:896:
2025-11-09T23:38:14.4734972Z  /// is the transaction in Bitcoin wire format.
2025-11-09T23:38:14.4736550Z  ///
2025-11-09T23:38:14.4738375Z  /// For batch operations, use serialize_transaction + batch_double_sha256 instead.
2025-11-09T23:38:14.4740844Z -/// 
2025-11-09T23:38:14.4741918Z +///
2025-11-09T23:38:14.4744002Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-09T23:38:14.4746579Z  /// for 2-3x faster transaction ID calculation.
2025-11-09T23:38:14.4748935Z  #[inline(always)]
2025-11-09T23:38:14.4750305Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:903:
2025-11-09T23:38:14.4751991Z  pub fn calculate_tx_id(tx: &Transaction) -> Hash {
2025-11-09T23:38:14.4753686Z -    use crate::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.4755141Z      use crate::crypto::OptimizedSha256;
2025-11-09T23:38:14.4758142Z +    use crate::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.4759403Z  
2025-11-09T23:38:14.4760166Z      // Serialize transaction to Bitcoin wire format
2025-11-09T23:38:14.4761274Z      let serialized = serialize_transaction(tx);
2025-11-09T23:38:14.4763140Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:8:
2025-11-09T23:38:14.4765224Z  //! - Batch (8+ items): Uses AVX2 8-way parallel processing
2025-11-09T23:38:14.4766938Z  //! - Expected: 4-8x speedup for batch operations on AVX2-capable CPUs
2025-11-09T23:38:14.4768121Z  
2025-11-09T23:38:14.4768861Z -use sha2::{Digest, Sha256};
2025-11-09T23:38:14.4770148Z  use crate::crypto::sha256_avx2;
2025-11-09T23:38:14.4771049Z +use sha2::{Digest, Sha256};
2025-11-09T23:38:14.4771866Z  
2025-11-09T23:38:14.4772654Z  /// Batch SHA256 using AVX2 8-way parallel processing
2025-11-09T23:38:14.4773689Z  ///
2025-11-09T23:38:14.4777748Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:46:
2025-11-09T23:38:14.4779465Z      }
2025-11-09T23:38:14.4780103Z  
2025-11-09T23:38:14.4780905Z      let mut results = Vec::with_capacity(inputs.len());
2025-11-09T23:38:14.4781932Z -    
2025-11-09T23:38:14.4782575Z +
2025-11-09T23:38:14.4783275Z      // Process in chunks of 8 using AVX2
2025-11-09T23:38:14.4784394Z      let chunks = inputs.chunks_exact(8);
2025-11-09T23:38:14.4785424Z      let remainder = chunks.remainder();
2025-11-09T23:38:14.4789134Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:55:
2025-11-09T23:38:14.4790898Z      for chunk in chunks {
2025-11-09T23:38:14.4791781Z          // Convert chunk to array of 8 references
2025-11-09T23:38:14.4792791Z          let chunk_array: [&[u8]; 8] = [
2025-11-09T23:38:14.4793778Z -            chunk[0], chunk[1], chunk[2], chunk[3],
2025-11-09T23:38:14.4796644Z -            chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-09T23:38:14.4797942Z +            chunk[0], chunk[1], chunk[2], chunk[3], chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-09T23:38:14.4799183Z          ];
2025-11-09T23:38:14.4799849Z -        
2025-11-09T23:38:14.4800503Z +
2025-11-09T23:38:14.4801228Z          // Use AVX2 8-way parallel double SHA256
2025-11-09T23:38:14.4802469Z          // Note: sha256_8way_avx2 expects 64-byte inputs (one SHA256 block)
2025-11-09T23:38:14.4804425Z          // For non-64-byte inputs, it will fall back to sequential processing
2025-11-09T23:38:14.4808743Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:93:
2025-11-09T23:38:14.4810450Z          })
2025-11-09T23:38:14.4811130Z          .collect()
2025-11-09T23:38:14.4811829Z  }
2025-11-09T23:38:14.4812458Z -
2025-11-09T23:38:14.4813337Z  
2025-11-09T23:38:14.4815016Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:99:
2025-11-09T23:38:14.4816758Z  
2025-11-09T23:38:14.4817398Z      #[test]
2025-11-09T23:38:14.4818104Z      fn test_hash_eq_random() {
2025-11-09T23:38:14.4819370Z -        let hash1: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32];
2025-11-09T23:38:14.4821133Z -        let hash2: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33];
2025-11-09T23:38:14.4822456Z -        
2025-11-09T23:38:14.4823176Z +        let hash1: Hash = [
2025-11-09T23:38:14.4824155Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-09T23:38:14.4825402Z +            25, 26, 27, 28, 29, 30, 31, 32,
2025-11-09T23:38:14.4826293Z +        ];
2025-11-09T23:38:14.4826994Z +        let hash2: Hash = [
2025-11-09T23:38:14.4827974Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-09T23:38:14.4830507Z +            25, 26, 27, 28, 29, 30, 31, 33,
2025-11-09T23:38:14.4831397Z +        ];
2025-11-09T23:38:14.4832040Z +
2025-11-09T23:38:14.4832750Z          // Should match standard comparison
2025-11-09T23:38:14.4834047Z          assert_eq!(hash_eq(&hash1, &hash1), hash1 == hash1);
2025-11-09T23:38:14.4835393Z          assert_eq!(hash_eq(&hash1, &hash2), hash1 == hash2);
2025-11-09T23:38:14.4838817Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:108:
2025-11-09T23:38:14.4840929Z      }
2025-11-09T23:38:14.4841567Z  }
2025-11-09T23:38:14.4842197Z -
2025-11-09T23:38:14.4842831Z  
2025-11-09T23:38:14.4844221Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:49:
2025-11-09T23:38:14.4846019Z          Ok(a + b)
2025-11-09T23:38:14.4846726Z      } else {
2025-11-09T23:38:14.4847772Z          // Mixed signs: use checked arithmetic (overflow not possible, but safer)
2025-11-09T23:38:14.4849086Z -        a.checked_add(b).ok_or_else(|| {
2025-11-09T23:38:14.4850469Z -            ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-09T23:38:14.4851815Z -        })
2025-11-09T23:38:14.4852519Z +        a.checked_add(b)
2025-11-09T23:38:14.4853856Z +            .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-09T23:38:14.4856160Z      }
2025-11-09T23:38:14.4858839Z  }
2025-11-09T23:38:14.4859890Z  
2025-11-09T23:38:14.4862354Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:58:
2025-11-09T23:38:14.4867561Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.4869308Z  pub fn safe_add(a: i64, b: i64) -> Result<i64> {
2025-11-09T23:38:14.4871416Z      // Always use checked arithmetic in non-production builds
2025-11-09T23:38:14.4873505Z -    a.checked_add(b).ok_or_else(|| {
2025-11-09T23:38:14.4876435Z -        ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-09T23:38:14.4877812Z -    })
2025-11-09T23:38:14.4878480Z +    a.checked_add(b)
2025-11-09T23:38:14.4879775Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-09T23:38:14.4881218Z  }
2025-11-09T23:38:14.4881848Z  
2025-11-09T23:38:14.4882602Z  /// Fast-path subtraction with overflow checking
2025-11-09T23:38:14.4886379Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:98:
2025-11-09T23:38:14.4888103Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.4889144Z  pub fn safe_sub(a: i64, b: i64) -> Result<i64> {
2025-11-09T23:38:14.4890338Z      // Always use checked arithmetic in non-production builds
2025-11-09T23:38:14.4891494Z -    a.checked_sub(b).ok_or_else(|| {
2025-11-09T23:38:14.4892860Z -        ConsensusError::TransactionValidation("Arithmetic underflow".to_string())
2025-11-09T23:38:14.4894210Z -    })
2025-11-09T23:38:14.4895179Z +    a.checked_sub(b)
2025-11-09T23:38:14.4896511Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic underflow".to_string()))
2025-11-09T23:38:14.4899266Z  }
2025-11-09T23:38:14.4899888Z  
2025-11-09T23:38:14.4900522Z  #[cfg(test)]
2025-11-09T23:38:14.4901958Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:129:
2025-11-09T23:38:14.4903698Z          assert!(safe_sub(i64::MIN, 1).is_err());
2025-11-09T23:38:14.4904757Z      }
2025-11-09T23:38:14.4905396Z  }
2025-11-09T23:38:14.4906025Z -
2025-11-09T23:38:14.4906671Z  
2025-11-09T23:38:14.4908017Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:71:
2025-11-09T23:38:14.4910899Z      }
2025-11-09T23:38:14.4911542Z  
2025-11-09T23:38:14.4912330Z      /// Hash data using the best available implementation
2025-11-09T23:38:14.4913671Z -    /// 
2025-11-09T23:38:14.4914821Z +    ///
2025-11-09T23:38:14.4915986Z      /// Priority:
2025-11-09T23:38:14.4917703Z      /// 1. SHA-NI (Intel SHA Extensions) - 10-15x faster for single hashes
2025-11-09T23:38:14.4920986Z      /// 2. sha2 crate with asm - baseline fallback
2025-11-09T23:38:14.4922676Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:78:
2025-11-09T23:38:14.4924414Z -    /// 
2025-11-09T23:38:14.4925159Z +    ///
2025-11-09T23:38:14.4926098Z      /// For batch operations, see batch_sha256 in optimizations module.
2025-11-09T23:38:14.4927389Z      pub fn hash(&self, data: &[u8]) -> [u8; 32] {
2025-11-09T23:38:14.4928764Z          #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.4930362Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:85:
2025-11-09T23:38:14.4932043Z                  return sha_ni::sha256(data);
2025-11-09T23:38:14.4932959Z              }
2025-11-09T23:38:14.4933644Z          }
2025-11-09T23:38:14.4934460Z -        
2025-11-09T23:38:14.4935249Z +
2025-11-09T23:38:14.4936009Z          // Fallback: sha2 crate with asm optimizations
2025-11-09T23:38:14.4938942Z          let mut hasher = Sha256::new();
2025-11-09T23:38:14.4939889Z          hasher.update(data);
2025-11-09T23:38:14.4941421Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:96:
2025-11-09T23:38:14.4943024Z      }
2025-11-09T23:38:14.4943659Z  
2025-11-09T23:38:14.4944553Z      /// Compute double SHA256 (SHA256(SHA256(data)))
2025-11-09T23:38:14.4945537Z -    /// 
2025-11-09T23:38:14.4946187Z +    ///
2025-11-09T23:38:14.4947108Z      /// Uses SHA-NI if available for optimal single-hash performance.
2025-11-09T23:38:14.4948399Z      pub fn hash256(&self, data: &[u8]) -> [u8; 32] {
2025-11-09T23:38:14.4949425Z          #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.4951037Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:105:
2025-11-09T23:38:14.4952720Z                  return sha_ni::hash256(data);
2025-11-09T23:38:14.4953643Z              }
2025-11-09T23:38:14.4954434Z          }
2025-11-09T23:38:14.4955083Z -        
2025-11-09T23:38:14.4955726Z +
2025-11-09T23:38:14.4956408Z          let first = self.hash(data);
2025-11-09T23:38:14.4957329Z          self.hash(&first)
2025-11-09T23:38:14.4958111Z      }
2025-11-09T23:38:14.4962199Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:17:
2025-11-09T23:38:14.4963980Z  struct AlignedInitialHash([u32; 8]);
2025-11-09T23:38:14.4965015Z  
2025-11-09T23:38:14.4965929Z  static INITIAL_HASH: AlignedInitialHash = AlignedInitialHash([
2025-11-09T23:38:14.4967246Z -    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a,
2025-11-09T23:38:14.4970279Z -    0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-09T23:38:14.4972009Z +    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-09T23:38:14.4973489Z  ]);
2025-11-09T23:38:14.4974115Z  
2025-11-09T23:38:14.4974936Z  // SHA256 K constants
2025-11-09T23:38:14.4976757Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:27:
2025-11-09T23:38:14.4978558Z  struct AlignedKArray([u32; 64]);
2025-11-09T23:38:14.4979428Z  
2025-11-09T23:38:14.4980197Z  static K_ARRAY: AlignedKArray = AlignedKArray([
2025-11-09T23:38:14.4981318Z -    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,
2025-11-09T23:38:14.4982423Z -    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.4983522Z -    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,
2025-11-09T23:38:14.4984758Z -    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.4985895Z -    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,
2025-11-09T23:38:14.4987006Z -    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.4988157Z -    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-09T23:38:14.4989258Z -    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.4991454Z -    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,
2025-11-09T23:38:14.4992544Z -    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.4993633Z -    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,
2025-11-09T23:38:14.4995269Z -    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.4996366Z -    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,
2025-11-09T23:38:14.4997461Z -    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.4998556Z -    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,
2025-11-09T23:38:14.4999671Z -    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.5001570Z +    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.5003598Z +    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.5005784Z +    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.5009410Z +    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.5011431Z +    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.5013703Z +    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.5015930Z +    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.5019275Z +    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.5020762Z  ]);
2025-11-09T23:38:14.5021395Z  
2025-11-09T23:38:14.5022095Z  /// Helper functions for AVX2 operations
2025-11-09T23:38:14.5023845Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:64:
2025-11-09T23:38:14.5025929Z      pub unsafe fn add3(x: __m256i, y: __m256i, z: __m256i) -> __m256i {
2025-11-09T23:38:14.5027095Z          add(add(x, y), z)
2025-11-09T23:38:14.5027880Z      }
2025-11-09T23:38:14.5028513Z -    
2025-11-09T23:38:14.5029144Z +
2025-11-09T23:38:14.5029785Z      #[inline(always)]
2025-11-09T23:38:14.5030851Z      pub unsafe fn add4(x: __m256i, y: __m256i, z: __m256i, w: __m256i) -> __m256i {
2025-11-09T23:38:14.5032203Z          // Core: Add(x, y, z, w) = Add(Add(x, y), Add(z, w))
2025-11-09T23:38:14.5034023Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:71:
2025-11-09T23:38:14.5035882Z          add(add(x, y), add(z, w))
2025-11-09T23:38:14.5038463Z      }
2025-11-09T23:38:14.5039106Z -    
2025-11-09T23:38:14.5039741Z +
2025-11-09T23:38:14.5040390Z      #[inline(always)]
2025-11-09T23:38:14.5041534Z      pub unsafe fn add5(x: __m256i, y: __m256i, z: __m256i, w: __m256i, v: __m256i) -> __m256i {
2025-11-09T23:38:14.5042988Z          // Core: Add(x, y, z, w, v) = Add(Add(x, y, z), Add(w, v))
2025-11-09T23:38:14.5044965Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:171:
2025-11-09T23:38:14.5049120Z  /// One round of SHA-256
2025-11-09T23:38:14.5049966Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.5050821Z  macro_rules! round {
2025-11-09T23:38:14.5051923Z -    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {
2025-11-09T23:38:14.5053169Z -        {
2025-11-09T23:38:14.5053877Z -            use helpers::*;
2025-11-09T23:38:14.5055151Z -            // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-09T23:38:14.5056742Z -            let t1 = add(add($h, helpers::sigma1($e)), add(helpers::ch($e, $f, $g), $k));
2025-11-09T23:38:14.5058186Z -            let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-09T23:38:14.5059325Z -            $d = add($d, t1);
2025-11-09T23:38:14.5060175Z -            $h = add(t1, t2);
2025-11-09T23:38:14.5060986Z -        }
2025-11-09T23:38:14.5061638Z -    };
2025-11-09T23:38:14.5062629Z +    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {{
2025-11-09T23:38:14.5064412Z +        use helpers::*;
2025-11-09T23:38:14.5065553Z +        // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-09T23:38:14.5066812Z +        let t1 = add(
2025-11-09T23:38:14.5067615Z +            add($h, helpers::sigma1($e)),
2025-11-09T23:38:14.5068596Z +            add(helpers::ch($e, $f, $g), $k),
2025-11-09T23:38:14.5069525Z +        );
2025-11-09T23:38:14.5070394Z +        let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-09T23:38:14.5071806Z +        $d = add($d, t1);
2025-11-09T23:38:14.5072612Z +        $h = add(t1, t2);
2025-11-09T23:38:14.5073443Z +    }};
2025-11-09T23:38:14.5074079Z  }
2025-11-09T23:38:14.5075020Z  
2025-11-09T23:38:14.5075841Z  /// Read 8 32-bit words from 8 different 64-byte blocks
2025-11-09T23:38:14.5077702Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:190:
2025-11-09T23:38:14.5079459Z      let mut words = [0u32; 8];
2025-11-09T23:38:14.5080301Z      for i in 0..8 {
2025-11-09T23:38:14.5081077Z          let pos = (i * 64) + offset;
2025-11-09T23:38:14.5082015Z -        words[i] = u32::from_le_bytes([
2025-11-09T23:38:14.5082961Z -            input[pos],
2025-11-09T23:38:14.5083769Z -            input[pos + 1],
2025-11-09T23:38:14.5087009Z -            input[pos + 2],
2025-11-09T23:38:14.5087879Z -            input[pos + 3],
2025-11-09T23:38:14.5088699Z -        ]);
2025-11-09T23:38:14.5089885Z +        words[i] = u32::from_le_bytes([input[pos], input[pos + 1], input[pos + 2], input[pos + 3]]);
2025-11-09T23:38:14.5091256Z      }
2025-11-09T23:38:14.5091902Z -    
2025-11-09T23:38:14.5092540Z +
2025-11-09T23:38:14.5093474Z      // _mm256_set_epi32 places first argument at index 7, last at index 0
2025-11-09T23:38:14.5095359Z      // Core: ReadLE32(chunk + 0) is first arg -> index 7, ReadLE32(chunk + 64) is second arg -> index 6, etc.
2025-11-09T23:38:14.5098764Z      // So words[0] (chunk + 0) should be first arg -> index 7
2025-11-09T23:38:14.5100610Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:205:
2025-11-09T23:38:14.5102608Z      // So chunk 0 goes to index 7, chunk 1 (chunk + 64) goes to index 6, etc.
2025-11-09T23:38:14.5104474Z      // This means words[0] -> index 7, words[1] -> index 6, ..., words[7] -> index 0
2025-11-09T23:38:14.5105797Z      let ret = _mm256_set_epi32(
2025-11-09T23:38:14.5107140Z -        words[0] as i32,  // chunk + 0 -> index 7 (first arg)
2025-11-09T23:38:14.5108387Z -        words[1] as i32,  // chunk + 64 -> index 6 (second arg)
2025-11-09T23:38:14.5109530Z -        words[2] as i32,  // chunk + 128 -> index 5
2025-11-09T23:38:14.5110726Z -        words[3] as i32,  // chunk + 192 -> index 4
2025-11-09T23:38:14.5111803Z -        words[4] as i32,  // chunk + 256 -> index 3
2025-11-09T23:38:14.5113056Z -        words[5] as i32,  // chunk + 320 -> index 2
2025-11-09T23:38:14.5114100Z -        words[6] as i32,  // chunk + 384 -> index 1
2025-11-09T23:38:14.5117634Z -        words[7] as i32,  // chunk + 448 -> index 0 (last arg)
2025-11-09T23:38:14.5118837Z +        words[0] as i32, // chunk + 0 -> index 7 (first arg)
2025-11-09T23:38:14.5120031Z +        words[1] as i32, // chunk + 64 -> index 6 (second arg)
2025-11-09T23:38:14.5121144Z +        words[2] as i32, // chunk + 128 -> index 5
2025-11-09T23:38:14.5122561Z +        words[3] as i32, // chunk + 192 -> index 4
2025-11-09T23:38:14.5123620Z +        words[4] as i32, // chunk + 256 -> index 3
2025-11-09T23:38:14.5124835Z +        words[5] as i32, // chunk + 320 -> index 2
2025-11-09T23:38:14.5125877Z +        words[6] as i32, // chunk + 384 -> index 1
2025-11-09T23:38:14.5126976Z +        words[7] as i32, // chunk + 448 -> index 0 (last arg)
2025-11-09T23:38:14.5139180Z      );
2025-11-09T23:38:14.5141503Z -    
2025-11-09T23:38:14.5142156Z +
2025-11-09T23:38:14.5143155Z      // Byte swap within each 32-bit word using shuffle (matching Core exactly)
2025-11-09T23:38:14.5144745Z      // SHA256 operates on big-endian 32-bit words internally
2025-11-09T23:38:14.5146037Z      // We read little-endian, so we need to byte-swap each word
2025-11-09T23:38:14.5147972Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:221:
2025-11-09T23:38:14.5149960Z      // The shuffle mask 0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203
2025-11-09T23:38:14.5151175Z      // reverses bytes within each 32-bit word
2025-11-09T23:38:14.5152548Z -    // 
2025-11-09T23:38:14.5153201Z +    //
2025-11-09T23:38:14.5156299Z      // Note: _mm256_shuffle_epi8 operates on 8-bit elements across the entire vector
2025-11-09T23:38:14.5157874Z      // The mask pattern is designed to swap bytes within each word
2025-11-09T23:38:14.5159063Z      let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.5160799Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:227:
2025-11-09T23:38:14.5162638Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5163749Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5165279Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.5166620Z +        0x00010203,
2025-11-09T23:38:14.5167341Z      );
2025-11-09T23:38:14.5168058Z      _mm256_shuffle_epi8(ret, shuffle_mask)
2025-11-09T23:38:14.5168971Z  }
2025-11-09T23:38:14.5170441Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:236:
2025-11-09T23:38:14.5172545Z      // Core's Write8 does: byte-swap with shuffle, then WriteLE32 to each position
2025-11-09T23:38:14.5173949Z      // Byte swap within each 32-bit word using shuffle
2025-11-09T23:38:14.5175136Z      let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.5176162Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5177265Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5178686Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.5180031Z +        0x00010203,
2025-11-09T23:38:14.5180753Z      );
2025-11-09T23:38:14.5181492Z      let v = _mm256_shuffle_epi8(v, shuffle_mask);
2025-11-09T23:38:14.5182464Z -    
2025-11-09T23:38:14.5183102Z +
2025-11-09T23:38:14.5184013Z      // Extract and write to 8 different positions (Core's WriteLE32)
2025-11-09T23:38:14.5185702Z      // Unroll loop because _mm256_extract_epi32 requires compile-time constant index
2025-11-09T23:38:14.5187154Z      let word0 = _mm256_extract_epi32(v, 7) as u32;
2025-11-09T23:38:14.5189014Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:264:
2025-11-09T23:38:14.5191003Z  /// Transform 8 double SHA256 blocks in parallel (SHA256D)
2025-11-09T23:38:14.5192211Z  /// Input: 512 bytes (8 * 64-byte blocks, contiguous)
2025-11-09T23:38:14.5193353Z  /// Output: 256 bytes (8 * 32-byte hashes, contiguous)
2025-11-09T23:38:14.5194540Z -/// 
2025-11-09T23:38:14.5195194Z +///
2025-11-09T23:38:14.5196246Z  /// This performs double SHA256 (SHA256(SHA256(input))) on 8 blocks in parallel.
2025-11-09T23:38:14.5197576Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.5198687Z  unsafe fn transform_8way(out: &mut [u8], input: &[u8]) {
2025-11-09T23:38:14.5200573Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:271:
2025-11-09T23:38:14.5202354Z      use helpers::*;
2025-11-09T23:38:14.5203094Z -    
2025-11-09T23:38:14.5203727Z +
2025-11-09T23:38:14.5205147Z      // Initialize state with initial hash values (host byte order, matching Core)
2025-11-09T23:38:14.5208299Z      let mut a = _mm256_set1_epi32(INITIAL_HASH.0[0] as i32);
2025-11-09T23:38:14.5209504Z      let mut b = _mm256_set1_epi32(INITIAL_HASH.0[1] as i32);
2025-11-09T23:38:14.5211367Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:279:
2025-11-09T23:38:14.5213432Z      let mut f = _mm256_set1_epi32(INITIAL_HASH.0[5] as i32);
2025-11-09T23:38:14.5214823Z      let mut g = _mm256_set1_epi32(INITIAL_HASH.0[6] as i32);
2025-11-09T23:38:14.5216035Z      let mut h = _mm256_set1_epi32(INITIAL_HASH.0[7] as i32);
2025-11-09T23:38:14.5217070Z -    
2025-11-09T23:38:14.5217706Z +
2025-11-09T23:38:14.5218389Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5219204Z      {
2025-11-09T23:38:14.5219978Z          let a_init = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5222129Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:312:
2025-11-09T23:38:14.5223850Z      {
2025-11-09T23:38:14.5224744Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5225881Z          let w0_val_7 = _mm256_extract_epi32(w0, 7) as u32;
2025-11-09T23:38:14.5227495Z -        println!("DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}", w0_val, w0_val_7);
2025-11-09T23:38:14.5228996Z +        println!(
2025-11-09T23:38:14.5230068Z +            "DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}",
2025-11-09T23:38:14.5231349Z +            w0_val, w0_val_7
2025-11-09T23:38:14.5232165Z +        );
2025-11-09T23:38:14.5232869Z          if w0_val == 0 && w0_val_7 == 0 {
2025-11-09T23:38:14.5233990Z              println!("DEBUG: w0 is zero (expected for zero input)");
2025-11-09T23:38:14.5235220Z          }
2025-11-09T23:38:14.5236716Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:322:
2025-11-09T23:38:14.5238426Z      {
2025-11-09T23:38:14.5239234Z          let a_after_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5240461Z          let h_after_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5241957Z -        println!("DEBUG After round 0: a=0x{:08x}, h=0x{:08x}", a_after_round0, h_after_round0);
2025-11-09T23:38:14.5243290Z +        println!(
2025-11-09T23:38:14.5244109Z +            "DEBUG After round 0: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5245289Z +            a_after_round0, h_after_round0
2025-11-09T23:38:14.5246200Z +        );
2025-11-09T23:38:14.5246848Z      }
2025-11-09T23:38:14.5249372Z      w1 = read8(input, 4);
2025-11-09T23:38:14.5250325Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-09T23:38:14.5252461Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:330:
2025-11-09T23:38:14.5254215Z      {
2025-11-09T23:38:14.5255174Z          let a_after_round1 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5256395Z          let h_after_round1 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5259511Z -        println!("DEBUG After round 1: a=0x{:08x}, h=0x{:08x}", a_after_round1, h_after_round1);
2025-11-09T23:38:14.5260848Z +        println!(
2025-11-09T23:38:14.5262075Z +            "DEBUG After round 1: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5263138Z +            a_after_round1, h_after_round1
2025-11-09T23:38:14.5264058Z +        );
2025-11-09T23:38:14.5264848Z      }
2025-11-09T23:38:14.5265519Z      w2 = read8(input, 8);
2025-11-09T23:38:14.5266483Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-09T23:38:14.5268337Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:349:
2025-11-09T23:38:14.5270236Z          let a_after_round7 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5271480Z          let b_after_round7 = _mm256_extract_epi32(b, 0) as u32;
2025-11-09T23:38:14.5272700Z          let h_after_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5274935Z -        println!("DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}", a_after_round7, b_after_round7, h_after_round7);
2025-11-09T23:38:14.5276464Z +        println!(
2025-11-09T23:38:14.5279181Z +            "DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5280385Z +            a_after_round7, b_after_round7, h_after_round7
2025-11-09T23:38:14.5281382Z +        );
2025-11-09T23:38:14.5282036Z      }
2025-11-09T23:38:14.5282708Z      w8 = read8(input, 32);
2025-11-09T23:38:14.5283653Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[8]), w8));
2025-11-09T23:38:14.5285618Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:371:
2025-11-09T23:38:14.5289080Z      {
2025-11-09T23:38:14.5290109Z          let a_after_round15 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5291483Z          let h_after_round15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5292980Z -        println!("DEBUG After round 15: a=0x{:08x}, h=0x{:08x}", a_after_round15, h_after_round15);
2025-11-09T23:38:14.5294892Z +        println!(
2025-11-09T23:38:14.5295744Z +            "DEBUG After round 15: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5296807Z +            a_after_round15, h_after_round15
2025-11-09T23:38:14.5299115Z +        );
2025-11-09T23:38:14.5299757Z      }
2025-11-09T23:38:14.5300390Z  
2025-11-09T23:38:14.5301071Z      // Rounds 16-63: Message schedule
2025-11-09T23:38:14.5303119Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:382:
2025-11-09T23:38:14.5305092Z          let w14_val = _mm256_extract_epi32(w14, 0) as u32;
2025-11-09T23:38:14.5306219Z          let w9_val = _mm256_extract_epi32(w9, 0) as u32;
2025-11-09T23:38:14.5309096Z          let w1_val = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5310817Z -        println!("DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}", w0_before, w14_val, w9_val, w1_val);
2025-11-09T23:38:14.5312396Z +        println!(
2025-11-09T23:38:14.5313669Z +            "DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5315116Z +            w0_before, w14_val, w9_val, w1_val
2025-11-09T23:38:14.5316044Z +        );
2025-11-09T23:38:14.5316695Z      }
2025-11-09T23:38:14.5319558Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5321541Z +    helpers::inc4(
2025-11-09T23:38:14.5322267Z +        &mut w0,
2025-11-09T23:38:14.5323013Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5323905Z +        w9,
2025-11-09T23:38:14.5324744Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5325604Z +    );
2025-11-09T23:38:14.5326277Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5329002Z      {
2025-11-09T23:38:14.5329797Z          let w0_after_inc = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5331678Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:405:
2025-11-09T23:38:14.5333771Z                   a_after_round16, b_after_round16, c_after_round16, d_after_round16,
2025-11-09T23:38:14.5335387Z                   e_after_round16, f_after_round16, g_after_round16, h_after_round16);
2025-11-09T23:38:14.5338674Z      }
2025-11-09T23:38:14.5339749Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5341099Z +    helpers::inc4(
2025-11-09T23:38:14.5341802Z +        &mut w1,
2025-11-09T23:38:14.5342544Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5343410Z +        w10,
2025-11-09T23:38:14.5344931Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5345839Z +    );
2025-11-09T23:38:14.5348280Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[17]), w1));
2025-11-09T23:38:14.5349759Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5351083Z +    helpers::inc4(
2025-11-09T23:38:14.5351799Z +        &mut w2,
2025-11-09T23:38:14.5352544Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5353408Z +        w11,
2025-11-09T23:38:14.5354134Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5355515Z +    );
2025-11-09T23:38:14.5356384Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-09T23:38:14.5357466Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5360184Z      {
2025-11-09T23:38:14.5361654Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:414:
2025-11-09T23:38:14.5363587Z          let a_after_round18 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5365051Z          println!("DEBUG After round 18: a=0x{:08x}", a_after_round18);
2025-11-09T23:38:14.5366393Z      }
2025-11-09T23:38:14.5367595Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5369966Z +    helpers::inc4(
2025-11-09T23:38:14.5370680Z +        &mut w3,
2025-11-09T23:38:14.5371406Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5372266Z +        w12,
2025-11-09T23:38:14.5372976Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5373838Z +    );
2025-11-09T23:38:14.5375162Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-09T23:38:14.5376640Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5379173Z +    helpers::inc4(
2025-11-09T23:38:14.5379879Z +        &mut w4,
2025-11-09T23:38:14.5380626Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5381481Z +        w13,
2025-11-09T23:38:14.5382199Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5383049Z +    );
2025-11-09T23:38:14.5383850Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-09T23:38:14.5385087Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5385907Z      {
2025-11-09T23:38:14.5387386Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:423:
2025-11-09T23:38:14.5390145Z          let a_after_round20 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5391584Z          println!("DEBUG After round 20: a=0x{:08x}", a_after_round20);
2025-11-09T23:38:14.5392919Z      }
2025-11-09T23:38:14.5393984Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5395448Z +    helpers::inc4(
2025-11-09T23:38:14.5396175Z +        &mut w5,
2025-11-09T23:38:14.5396918Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5399533Z +        w14,
2025-11-09T23:38:14.5400256Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5401107Z +    );
2025-11-09T23:38:14.5401906Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-09T23:38:14.5403358Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5406712Z +    helpers::inc4(
2025-11-09T23:38:14.5407497Z +        &mut w6,
2025-11-09T23:38:14.5408615Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5409501Z +        w15,
2025-11-09T23:38:14.5410226Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5411084Z +    );
2025-11-09T23:38:14.5411879Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-09T23:38:14.5413579Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5415034Z +    helpers::inc4(
2025-11-09T23:38:14.5415743Z +        &mut w7,
2025-11-09T23:38:14.5416474Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5417338Z +        w0,
2025-11-09T23:38:14.5418050Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5418910Z +    );
2025-11-09T23:38:14.5419684Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-09T23:38:14.5421143Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5422473Z +    helpers::inc4(
2025-11-09T23:38:14.5423179Z +        &mut w8,
2025-11-09T23:38:14.5423920Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5424907Z +        w1,
2025-11-09T23:38:14.5425628Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5428045Z +    );
2025-11-09T23:38:14.5428840Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[24]), w8));
2025-11-09T23:38:14.5430341Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5431676Z +    helpers::inc4(
2025-11-09T23:38:14.5432431Z +        &mut w9,
2025-11-09T23:38:14.5433220Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5434085Z +        w2,
2025-11-09T23:38:14.5434920Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5435794Z +    );
2025-11-09T23:38:14.5436744Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[25]), w9));
2025-11-09T23:38:14.5438624Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5439961Z +    helpers::inc4(
2025-11-09T23:38:14.5440669Z +        &mut w10,
2025-11-09T23:38:14.5441415Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5442278Z +        w3,
2025-11-09T23:38:14.5442997Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5444415Z +    );
2025-11-09T23:38:14.5445243Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[26]), w10));
2025-11-09T23:38:14.5446708Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5449262Z +    helpers::inc4(
2025-11-09T23:38:14.5449966Z +        &mut w11,
2025-11-09T23:38:14.5450714Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5451575Z +        w4,
2025-11-09T23:38:14.5452294Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5453157Z +    );
2025-11-09T23:38:14.5453955Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[27]), w11));
2025-11-09T23:38:14.5455636Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5458613Z +    helpers::inc4(
2025-11-09T23:38:14.5459322Z +        &mut w12,
2025-11-09T23:38:14.5460063Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5460936Z +        w5,
2025-11-09T23:38:14.5461885Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5462806Z +    );
2025-11-09T23:38:14.5463611Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[28]), w12));
2025-11-09T23:38:14.5465248Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5466602Z +    helpers::inc4(
2025-11-09T23:38:14.5467304Z +        &mut w13,
2025-11-09T23:38:14.5468046Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5468911Z +        w6,
2025-11-09T23:38:14.5469625Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5470485Z +    );
2025-11-09T23:38:14.5471281Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-09T23:38:14.5472834Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5474179Z +    helpers::inc4(
2025-11-09T23:38:14.5475012Z +        &mut w14,
2025-11-09T23:38:14.5475761Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5476620Z +        w7,
2025-11-09T23:38:14.5477329Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5478195Z +    );
2025-11-09T23:38:14.5481018Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-09T23:38:14.5482400Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5483516Z      {
2025-11-09T23:38:14.5485126Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:468:
2025-11-09T23:38:14.5487247Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5490078Z          let w11_val = _mm256_extract_epi32(w11, 0) as u32;
2025-11-09T23:38:14.5491198Z          let w6_val = _mm256_extract_epi32(w6, 0) as u32;
2025-11-09T23:38:14.5492830Z -        println!("DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}", w15_before, w13_val, w8_val, w0_val);
2025-11-09T23:38:14.5495099Z +        println!(
2025-11-09T23:38:14.5496140Z +            "DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}",
2025-11-09T23:38:14.5497427Z +            w15_before, w13_val, w8_val, w0_val
2025-11-09T23:38:14.5498348Z +        );
2025-11-09T23:38:14.5499558Z          println!("DEBUG w11: 0x{:08x}, w6: 0x{:08x}", w11_val, w6_val);
2025-11-09T23:38:14.5501056Z          let sigma1_w13 = _mm256_extract_epi32(helpers::sigma1_small(w13), 0) as u32;
2025-11-09T23:38:14.5502631Z          let sigma0_w0 = _mm256_extract_epi32(helpers::sigma0_small(w0), 0) as u32;
2025-11-09T23:38:14.5504828Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:475:
2025-11-09T23:38:14.5507077Z -        println!("DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}", sigma1_w13, sigma0_w0);
2025-11-09T23:38:14.5510642Z +        println!(
2025-11-09T23:38:14.5511611Z +            "DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}",
2025-11-09T23:38:14.5513062Z +            sigma1_w13, sigma0_w0
2025-11-09T23:38:14.5513931Z +        );
2025-11-09T23:38:14.5514698Z      }
2025-11-09T23:38:14.5515769Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5518722Z +    helpers::inc4(
2025-11-09T23:38:14.5519800Z +        &mut w15,
2025-11-09T23:38:14.5520559Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5521443Z +        w8,
2025-11-09T23:38:14.5522147Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5523232Z +    );
2025-11-09T23:38:14.5523981Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5524931Z      {
2025-11-09T23:38:14.5525725Z          let w15_after = _mm256_extract_epi32(w15, 0) as u32;
2025-11-09T23:38:14.5529426Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:497:
2025-11-09T23:38:14.5531463Z                   a_after_round31, b_after_round31, c_after_round31, d_after_round31,
2025-11-09T23:38:14.5532960Z                   e_after_round31, f_after_round31, g_after_round31, h_after_round31);
2025-11-09T23:38:14.5534160Z      }
2025-11-09T23:38:14.5535328Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5538484Z +    helpers::inc4(
2025-11-09T23:38:14.5539193Z +        &mut w0,
2025-11-09T23:38:14.5539934Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5540812Z +        w9,
2025-11-09T23:38:14.5541515Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5542368Z +    );
2025-11-09T23:38:14.5543154Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-09T23:38:14.5544725Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5546066Z +    helpers::inc4(
2025-11-09T23:38:14.5546796Z +        &mut w1,
2025-11-09T23:38:14.5549164Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5550082Z +        w10,
2025-11-09T23:38:14.5550796Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5551645Z +    );
2025-11-09T23:38:14.5552432Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-09T23:38:14.5553877Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5555359Z +    helpers::inc4(
2025-11-09T23:38:14.5556064Z +        &mut w2,
2025-11-09T23:38:14.5556808Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5557662Z +        w11,
2025-11-09T23:38:14.5558379Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5559230Z +    );
2025-11-09T23:38:14.5560022Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-09T23:38:14.5561454Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5562766Z +    helpers::inc4(
2025-11-09T23:38:14.5563492Z +        &mut w3,
2025-11-09T23:38:14.5564222Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5565201Z +        w12,
2025-11-09T23:38:14.5565915Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5568449Z +    );
2025-11-09T23:38:14.5569236Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-09T23:38:14.5570749Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5572074Z +    helpers::inc4(
2025-11-09T23:38:14.5572780Z +        &mut w4,
2025-11-09T23:38:14.5573515Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5574487Z +        w13,
2025-11-09T23:38:14.5575210Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5576054Z +    );
2025-11-09T23:38:14.5578361Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-09T23:38:14.5579798Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5581118Z +    helpers::inc4(
2025-11-09T23:38:14.5582131Z +        &mut w5,
2025-11-09T23:38:14.5583048Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5583911Z +        w14,
2025-11-09T23:38:14.5586625Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5587479Z +    );
2025-11-09T23:38:14.5588274Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-09T23:38:14.5589720Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5591045Z +    helpers::inc4(
2025-11-09T23:38:14.5591750Z +        &mut w6,
2025-11-09T23:38:14.5592492Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5593352Z +        w15,
2025-11-09T23:38:14.5594062Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5595045Z +    );
2025-11-09T23:38:14.5597956Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-09T23:38:14.5599443Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5600772Z +    helpers::inc4(
2025-11-09T23:38:14.5601511Z +        &mut w7,
2025-11-09T23:38:14.5602251Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5603120Z +        w0,
2025-11-09T23:38:14.5603827Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5607010Z +    );
2025-11-09T23:38:14.5607819Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-09T23:38:14.5609255Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5610584Z +    helpers::inc4(
2025-11-09T23:38:14.5611289Z +        &mut w8,
2025-11-09T23:38:14.5612028Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5613030Z +        w1,
2025-11-09T23:38:14.5613738Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5614770Z +    );
2025-11-09T23:38:14.5615553Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-09T23:38:14.5618518Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5619851Z +    helpers::inc4(
2025-11-09T23:38:14.5620575Z +        &mut w9,
2025-11-09T23:38:14.5621312Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5622161Z +        w2,
2025-11-09T23:38:14.5622872Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5623732Z +    );
2025-11-09T23:38:14.5624635Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-09T23:38:14.5626092Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5627434Z +    helpers::inc4(
2025-11-09T23:38:14.5628146Z +        &mut w10,
2025-11-09T23:38:14.5628889Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5629747Z +        w3,
2025-11-09T23:38:14.5630447Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5631317Z +    );
2025-11-09T23:38:14.5632107Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-09T23:38:14.5633564Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5635111Z +    helpers::inc4(
2025-11-09T23:38:14.5635824Z +        &mut w11,
2025-11-09T23:38:14.5636567Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5637420Z +        w4,
2025-11-09T23:38:14.5638129Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5647707Z +    );
2025-11-09T23:38:14.5648580Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-09T23:38:14.5650089Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5651445Z +    helpers::inc4(
2025-11-09T23:38:14.5652167Z +        &mut w12,
2025-11-09T23:38:14.5652912Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5653798Z +        w5,
2025-11-09T23:38:14.5654653Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5655536Z +    );
2025-11-09T23:38:14.5656326Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-09T23:38:14.5657802Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5659535Z +    helpers::inc4(
2025-11-09T23:38:14.5660246Z +        &mut w13,
2025-11-09T23:38:14.5660993Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5661870Z +        w6,
2025-11-09T23:38:14.5662587Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5663457Z +    );
2025-11-09T23:38:14.5664248Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-09T23:38:14.5665846Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5667205Z +    helpers::inc4(
2025-11-09T23:38:14.5667925Z +        &mut w14,
2025-11-09T23:38:14.5668665Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5669965Z +        w7,
2025-11-09T23:38:14.5670719Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5671592Z +    );
2025-11-09T23:38:14.5672386Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-09T23:38:14.5673841Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5676771Z +    helpers::inc4(
2025-11-09T23:38:14.5677489Z +        &mut w15,
2025-11-09T23:38:14.5678235Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5679106Z +        w8,
2025-11-09T23:38:14.5679831Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5680683Z +    );
2025-11-09T23:38:14.5681484Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-09T23:38:14.5682919Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5684249Z +    helpers::inc4(
2025-11-09T23:38:14.5685075Z +        &mut w0,
2025-11-09T23:38:14.5685826Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5686694Z +        w9,
2025-11-09T23:38:14.5689385Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5690252Z +    );
2025-11-09T23:38:14.5691047Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-09T23:38:14.5692491Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5693825Z +    helpers::inc4(
2025-11-09T23:38:14.5694739Z +        &mut w1,
2025-11-09T23:38:14.5695489Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5696370Z +        w10,
2025-11-09T23:38:14.5697086Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5697941Z +    );
2025-11-09T23:38:14.5700651Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-09T23:38:14.5702093Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5703434Z +    helpers::inc4(
2025-11-09T23:38:14.5704136Z +        &mut w2,
2025-11-09T23:38:14.5705009Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5705866Z +        w11,
2025-11-09T23:38:14.5706584Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5707443Z +    );
2025-11-09T23:38:14.5708237Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-09T23:38:14.5709669Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5711020Z +    helpers::inc4(
2025-11-09T23:38:14.5711733Z +        &mut w3,
2025-11-09T23:38:14.5712473Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5713516Z +        w12,
2025-11-09T23:38:14.5714228Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5715202Z +    );
2025-11-09T23:38:14.5717893Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-09T23:38:14.5719321Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5720639Z +    helpers::inc4(
2025-11-09T23:38:14.5721347Z +        &mut w4,
2025-11-09T23:38:14.5722079Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5722940Z +        w13,
2025-11-09T23:38:14.5723644Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5726641Z +    );
2025-11-09T23:38:14.5727553Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-09T23:38:14.5728991Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5730638Z +    helpers::inc4(
2025-11-09T23:38:14.5731343Z +        &mut w5,
2025-11-09T23:38:14.5732071Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5732926Z +        w14,
2025-11-09T23:38:14.5733652Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5734650Z +    );
2025-11-09T23:38:14.5735453Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-09T23:38:14.5738362Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5739672Z +    helpers::inc4(
2025-11-09T23:38:14.5740383Z +        &mut w6,
2025-11-09T23:38:14.5741109Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5741967Z +        w15,
2025-11-09T23:38:14.5742680Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5743536Z +    );
2025-11-09T23:38:14.5744441Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-09T23:38:14.5745887Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5749037Z +    helpers::inc4(
2025-11-09T23:38:14.5749744Z +        &mut w7,
2025-11-09T23:38:14.5750480Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5751332Z +        w0,
2025-11-09T23:38:14.5752046Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5752894Z +    );
2025-11-09T23:38:14.5753690Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-09T23:38:14.5755235Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5756564Z +    helpers::inc4(
2025-11-09T23:38:14.5759085Z +        &mut w8,
2025-11-09T23:38:14.5759827Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5760677Z +        w1,
2025-11-09T23:38:14.5761393Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5762240Z +    );
2025-11-09T23:38:14.5763029Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-09T23:38:14.5764747Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5766144Z +    helpers::inc4(
2025-11-09T23:38:14.5766852Z +        &mut w9,
2025-11-09T23:38:14.5767583Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5768436Z +        w2,
2025-11-09T23:38:14.5769142Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5770002Z +    );
2025-11-09T23:38:14.5770786Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-09T23:38:14.5772235Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5773577Z +    helpers::inc4(
2025-11-09T23:38:14.5774469Z +        &mut w10,
2025-11-09T23:38:14.5775230Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5776085Z +        w3,
2025-11-09T23:38:14.5776800Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5777656Z +    );
2025-11-09T23:38:14.5778448Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-09T23:38:14.5779896Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5781243Z +    helpers::inc4(
2025-11-09T23:38:14.5781952Z +        &mut w11,
2025-11-09T23:38:14.5782693Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5783560Z +        w4,
2025-11-09T23:38:14.5784268Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5785269Z +    );
2025-11-09T23:38:14.5786059Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-09T23:38:14.5787520Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5788859Z +    helpers::inc4(
2025-11-09T23:38:14.5789568Z +        &mut w12,
2025-11-09T23:38:14.5790309Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5791182Z +        w5,
2025-11-09T23:38:14.5791897Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5792744Z +    );
2025-11-09T23:38:14.5793534Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-09T23:38:14.5795153Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5796802Z +    helpers::inc4(
2025-11-09T23:38:14.5797511Z +        &mut w13,
2025-11-09T23:38:14.5798256Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5799118Z +        w6,
2025-11-09T23:38:14.5799831Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5800690Z +    );
2025-11-09T23:38:14.5801480Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-09T23:38:14.5802951Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5804410Z +    helpers::inc4(
2025-11-09T23:38:14.5805124Z +        &mut w14,
2025-11-09T23:38:14.5805857Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5808483Z +        w7,
2025-11-09T23:38:14.5809188Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5810061Z +    );
2025-11-09T23:38:14.5810853Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[62]), w14));
2025-11-09T23:38:14.5812342Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5813865Z +    helpers::inc4(
2025-11-09T23:38:14.5814855Z +        &mut w15,
2025-11-09T23:38:14.5815647Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5818387Z +        w8,
2025-11-09T23:38:14.5819100Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5819953Z +    );
2025-11-09T23:38:14.5820755Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[63]), w15));
2025-11-09T23:38:14.5821831Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5822652Z      {
2025-11-09T23:38:14.5824113Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:578:
2025-11-09T23:38:14.5826581Z          // First SHA256 of 64 zero bytes should produce: 0x42fda5f5 (little-endian of first word)
2025-11-09T23:38:14.5828157Z          // So a should be: 0x42fda5f5 - 0x6a09e667 = 0xd8f3bf8e
2025-11-09T23:38:14.5829614Z          println!("DEBUG Expected a after round 63: 0xd8f3bf8e (0x42fda5f5 - 0x6a09e667)");
2025-11-09T23:38:14.5832203Z -        println!("DEBUG Difference: 0x{:08x}", a_after_round63.wrapping_sub(0xd8f3bf8e));
2025-11-09T23:38:14.5833554Z +        println!(
2025-11-09T23:38:14.5834447Z +            "DEBUG Difference: 0x{:08x}",
2025-11-09T23:38:14.5835472Z +            a_after_round63.wrapping_sub(0xd8f3bf8e)
2025-11-09T23:38:14.5836429Z +        );
2025-11-09T23:38:14.5837069Z      }
2025-11-09T23:38:14.5837690Z  
2025-11-09T23:38:14.5840271Z      // Add initial hash values (Transform 1 complete)
2025-11-09T23:38:14.5842089Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:586:
2025-11-09T23:38:14.5843792Z      {
2025-11-09T23:38:14.5844678Z          let a_before = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5845799Z          let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5847419Z -        println!("DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}", a_before, h_before);
2025-11-09T23:38:14.5848961Z +        println!(
2025-11-09T23:38:14.5850013Z +            "DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5852548Z +            a_before, h_before
2025-11-09T23:38:14.5853354Z +        );
2025-11-09T23:38:14.5854263Z          println!("Expected SHA256(64 zeros) first word: 0xf5a5fd42");
2025-11-09T23:38:14.5855761Z      }
2025-11-09T23:38:14.5856472Z      a = add(a, k(INITIAL_HASH.0[0]));
2025-11-09T23:38:14.5860266Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:601:
2025-11-09T23:38:14.5861981Z      {
2025-11-09T23:38:14.5862746Z          let a_after = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5863871Z          let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5865621Z -        println!("DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}", a_after, h_after);
2025-11-09T23:38:14.5867337Z +        println!(
2025-11-09T23:38:14.5868508Z +            "DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5869759Z +            a_after, h_after
2025-11-09T23:38:14.5870563Z +        );
2025-11-09T23:38:14.5871445Z          println!("Expected: a=0xf5a5fd42 (from SHA256(64 zeros))");
2025-11-09T23:38:14.5872597Z      }
2025-11-09T23:38:14.5873223Z  
2025-11-09T23:38:14.5874797Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:610:
2025-11-09T23:38:14.5876501Z      {
2025-11-09T23:38:14.5878718Z          let a_before_t2 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5880028Z          let b_before_t2 = _mm256_extract_epi32(b, 0) as u32;
2025-11-09T23:38:14.5881585Z -        println!("DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}", a_before_t2, b_before_t2);
2025-11-09T23:38:14.5883033Z +        println!(
2025-11-09T23:38:14.5883956Z +            "DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}",
2025-11-09T23:38:14.5885605Z +            a_before_t2, b_before_t2
2025-11-09T23:38:14.5886479Z +        );
2025-11-09T23:38:14.5887173Z      }
2025-11-09T23:38:14.5887809Z      let t0 = a;
2025-11-09T23:38:14.5888505Z      let t1 = b;
2025-11-09T23:38:14.5891561Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:711:
2025-11-09T23:38:14.5893264Z      {
2025-11-09T23:38:14.5894068Z          let w0_combined = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5895576Z          let w1_combined = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5897226Z -        println!("DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}", w0_combined, w1_combined);
2025-11-09T23:38:14.5898740Z +        println!(
2025-11-09T23:38:14.5899754Z +            "DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5900996Z +            w0_combined, w1_combined
2025-11-09T23:38:14.5901853Z +        );
2025-11-09T23:38:14.5902519Z      }
2025-11-09T23:38:14.5903137Z  
2025-11-09T23:38:14.5903886Z      // Transform 3: Final SHA256 on the combined state
2025-11-09T23:38:14.5905822Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:730:
2025-11-09T23:38:14.5908899Z      {
2025-11-09T23:38:14.5909666Z          let w0_t3 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5910758Z          let w1_t3 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5912098Z -        println!("DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}", w0_t3, w1_t3);
2025-11-09T23:38:14.5913515Z +        println!(
2025-11-09T23:38:14.5914490Z +            "DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5915527Z +            w0_t3, w1_t3
2025-11-09T23:38:14.5916288Z +        );
2025-11-09T23:38:14.5916929Z      }
2025-11-09T23:38:14.5917724Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[0]), w0));
2025-11-09T23:38:14.5918787Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5922413Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:737:
2025-11-09T23:38:14.5924113Z      {
2025-11-09T23:38:14.5925052Z          let a_after_t3_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5926298Z          let h_after_t3_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5929461Z -        println!("DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)", a_after_t3_round0, h_after_t3_round0);
2025-11-09T23:38:14.5931158Z +        println!(
2025-11-09T23:38:14.5932276Z +            "DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)",
2025-11-09T23:38:14.5933664Z +            a_after_t3_round0, h_after_t3_round0
2025-11-09T23:38:14.5934764Z +        );
2025-11-09T23:38:14.5935415Z      }
2025-11-09T23:38:14.5936205Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-09T23:38:14.5937387Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-09T23:38:14.5939891Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:750:
2025-11-09T23:38:14.5941597Z      {
2025-11-09T23:38:14.5942381Z          // After round 7, the new a (for next round) is in h
2025-11-09T23:38:14.5943576Z          let h_after_t3_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5945209Z -        println!("DEBUG Transform 3 after round 7: h (new a)=0x{:08x}", h_after_t3_round7);
2025-11-09T23:38:14.5946551Z +        println!(
2025-11-09T23:38:14.5947428Z +            "DEBUG Transform 3 after round 7: h (new a)=0x{:08x}",
2025-11-09T23:38:14.5948512Z +            h_after_t3_round7
2025-11-09T23:38:14.5949308Z +        );
2025-11-09T23:38:14.5949945Z      }
2025-11-09T23:38:14.5950666Z      round!(a, b, c, d, e, f, g, h, k(0x5807aa98));
2025-11-09T23:38:14.5951712Z      round!(h, a, b, c, d, e, f, g, k(0x12835b01));
2025-11-09T23:38:14.5953472Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:778:
2025-11-09T23:38:14.5955444Z          let f_after_15 = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.5956583Z          let g_after_15 = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.5957720Z          let h_after_15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5959476Z -        println!("DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_after_15, b_after_15, c_after_15, d_after_15);
2025-11-09T23:38:14.5961548Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_after_15, f_after_15, g_after_15, h_after_15);
2025-11-09T23:38:14.5962872Z +        println!(
2025-11-09T23:38:14.5963962Z +            "DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.5965470Z +            a_after_15, b_after_15, c_after_15, d_after_15
2025-11-09T23:38:14.5966443Z +        );
2025-11-09T23:38:14.5967097Z +        println!(
2025-11-09T23:38:14.5967914Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5968988Z +            e_after_15, f_after_15, g_after_15, h_after_15
2025-11-09T23:38:14.5969959Z +        );
2025-11-09T23:38:14.5970974Z          println!("  Expected: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-09T23:38:14.5972247Z      }
2025-11-09T23:38:14.5972868Z  
2025-11-09T23:38:14.5974416Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:795:
2025-11-09T23:38:14.5976278Z          let f_before_16 = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.5977445Z          let g_before_16 = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.5978614Z          let h_before_16 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5980426Z -        println!("DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_16, b_before_16, c_before_16, d_before_16);
2025-11-09T23:38:14.5982925Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_16, f_before_16, g_before_16, h_before_16);
2025-11-09T23:38:14.5984924Z -        println!("  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-09T23:38:14.5986340Z +        println!(
2025-11-09T23:38:14.5987442Z +            "DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.5988860Z +            a_before_16, b_before_16, c_before_16, d_before_16
2025-11-09T23:38:14.5989856Z +        );
2025-11-09T23:38:14.5990561Z +        println!(
2025-11-09T23:38:14.5991364Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5992461Z +            e_before_16, f_before_16, g_before_16, h_before_16
2025-11-09T23:38:14.5993462Z +        );
2025-11-09T23:38:14.5994120Z +        println!(
2025-11-09T23:38:14.5995339Z +            "  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027"
2025-11-09T23:38:14.5996944Z +        );
2025-11-09T23:38:14.5997813Z          let w0_before_t3_round16 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5999147Z          let w1_before_t3_round16 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.6000932Z -        println!("DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}", w0_before_t3_round16, w1_before_t3_round16);
2025-11-09T23:38:14.6002507Z +        println!(
2025-11-09T23:38:14.6003490Z +            "DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.6005186Z +            w0_before_t3_round16, w1_before_t3_round16
2025-11-09T23:38:14.6006163Z +        );
2025-11-09T23:38:14.6006804Z      }
2025-11-09T23:38:14.6007728Z      // Save old values before round 16 - these will be needed in round 17
2025-11-09T23:38:14.6011122Z      // Round 16 modifies d and h, so we save c and d (which become $d and $e in round 17)
2025-11-09T23:38:14.6013573Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:818:
2025-11-09T23:38:14.6015495Z      {
2025-11-09T23:38:14.6016278Z          let w0_before = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.6017409Z          let w1_before = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.6020344Z -        println!("DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}", w0_before, w1_before);
2025-11-09T23:38:14.6021602Z +        println!(
2025-11-09T23:38:14.6022408Z +            "DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}",
2025-11-09T23:38:14.6023429Z +            w0_before, w1_before
2025-11-09T23:38:14.6024254Z +        );
2025-11-09T23:38:14.6025017Z      }
2025-11-09T23:38:14.6025811Z      helpers::inc(&mut w0, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6026856Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6030637Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:839:
2025-11-09T23:38:14.6032483Z          let g_after = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.6033638Z          println!("DEBUG T3 R17 after: g=0x{:08x}", g_after);
2025-11-09T23:38:14.6034771Z      }
2025-11-09T23:38:14.6035780Z -    helpers::inc3(&mut w2, helpers::sigma1_small(w0), helpers::sigma0_small(w3));
2025-11-09T23:38:14.6037056Z +    helpers::inc3(
2025-11-09T23:38:14.6037770Z +        &mut w2,
2025-11-09T23:38:14.6040487Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6041398Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6042246Z +    );
2025-11-09T23:38:14.6043016Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-09T23:38:14.6044517Z -    helpers::inc3(&mut w3, helpers::sigma1_small(w1), helpers::sigma0_small(w4));
2025-11-09T23:38:14.6045809Z +    helpers::inc3(
2025-11-09T23:38:14.6046509Z +        &mut w3,
2025-11-09T23:38:14.6047236Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6048142Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6048988Z +    );
2025-11-09T23:38:14.6049785Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-09T23:38:14.6051190Z -    helpers::inc3(&mut w4, helpers::sigma1_small(w2), helpers::sigma0_small(w5));
2025-11-09T23:38:14.6052463Z +    helpers::inc3(
2025-11-09T23:38:14.6053175Z +        &mut w4,
2025-11-09T23:38:14.6053510Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6053847Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6054136Z +    );
2025-11-09T23:38:14.6054697Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-09T23:38:14.6055349Z -    helpers::inc3(&mut w5, helpers::sigma1_small(w3), helpers::sigma0_small(w6));
2025-11-09T23:38:14.6055655Z +    helpers::inc3(
2025-11-09T23:38:14.6055944Z +        &mut w5,
2025-11-09T23:38:14.6056282Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6056614Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6058648Z +    );
2025-11-09T23:38:14.6059087Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-09T23:38:14.6060113Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), k(0x100), helpers::sigma0_small(w7));
2025-11-09T23:38:14.6060420Z +    helpers::inc4(
2025-11-09T23:38:14.6060710Z +        &mut w6,
2025-11-09T23:38:14.6061043Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6061329Z +        k(0x100),
2025-11-09T23:38:14.6061667Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6061944Z +    );
2025-11-09T23:38:14.6062384Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-09T23:38:14.6062968Z      helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, k(0x11002000));
2025-11-09T23:38:14.6063412Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-09T23:38:14.6064631Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:865:
2025-11-09T23:38:14.6065083Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-09T23:38:14.6065637Z      w14 = helpers::add3(helpers::sigma1_small(w12), w7, k(0x400022));
2025-11-09T23:38:14.6066102Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-09T23:38:14.6066842Z -    w15 = helpers::add4(k(0x100), helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.6067170Z +    w15 = helpers::add4(
2025-11-09T23:38:14.6069277Z +        k(0x100),
2025-11-09T23:38:14.6069610Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.6069900Z +        w8,
2025-11-09T23:38:14.6070231Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.6070510Z +    );
2025-11-09T23:38:14.6070956Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[31]), w15));
2025-11-09T23:38:14.6071236Z -    
2025-11-09T23:38:14.6071509Z +
2025-11-09T23:38:14.6072391Z      // Continue with standard message schedule for rounds 32-63 (matching Core Transform 3 pattern)
2025-11-09T23:38:14.6072723Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6073001Z      {
2025-11-09T23:38:14.6074110Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:874:
2025-11-09T23:38:14.6074681Z          let a_before_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6075184Z          println!("DEBUG T3 R32 before: a=0x{:08x}", a_before_32);
2025-11-09T23:38:14.6075462Z      }
2025-11-09T23:38:14.6076149Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6076463Z +    helpers::inc4(
2025-11-09T23:38:14.6076743Z +        &mut w0,
2025-11-09T23:38:14.6077075Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.6077362Z +        w9,
2025-11-09T23:38:14.6077694Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.6077973Z +    );
2025-11-09T23:38:14.6078407Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-09T23:38:14.6078740Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6079016Z      {
2025-11-09T23:38:14.6080117Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:881:
2025-11-09T23:38:14.6080570Z          let a_after_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6081035Z          println!("DEBUG T3 R32 after: a=0x{:08x}", a_after_32);
2025-11-09T23:38:14.6081485Z      }
2025-11-09T23:38:14.6082197Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.6082508Z +    helpers::inc4(
2025-11-09T23:38:14.6082793Z +        &mut w1,
2025-11-09T23:38:14.6083299Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.6083604Z +        w10,
2025-11-09T23:38:14.6083938Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.6084213Z +    );
2025-11-09T23:38:14.6086708Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-09T23:38:14.6087426Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.6087731Z +    helpers::inc4(
2025-11-09T23:38:14.6088011Z +        &mut w2,
2025-11-09T23:38:14.6088348Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6088920Z +        w11,
2025-11-09T23:38:14.6089254Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6089534Z +    );
2025-11-09T23:38:14.6089987Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-09T23:38:14.6090680Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.6090986Z +    helpers::inc4(
2025-11-09T23:38:14.6091274Z +        &mut w3,
2025-11-09T23:38:14.6091607Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6091902Z +        w12,
2025-11-09T23:38:14.6092232Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6092510Z +    );
2025-11-09T23:38:14.6092959Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-09T23:38:14.6093659Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.6093963Z +    helpers::inc4(
2025-11-09T23:38:14.6094254Z +        &mut w4,
2025-11-09T23:38:14.6094789Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6095094Z +        w13,
2025-11-09T23:38:14.6095421Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6095705Z +    );
2025-11-09T23:38:14.6098118Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-09T23:38:14.6098814Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.6099126Z +    helpers::inc4(
2025-11-09T23:38:14.6099410Z +        &mut w5,
2025-11-09T23:38:14.6099745Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6100029Z +        w14,
2025-11-09T23:38:14.6100353Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6100627Z +    );
2025-11-09T23:38:14.6101064Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-09T23:38:14.6101770Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.6102074Z +    helpers::inc4(
2025-11-09T23:38:14.6102352Z +        &mut w6,
2025-11-09T23:38:14.6102684Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6102978Z +        w15,
2025-11-09T23:38:14.6103315Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6103591Z +    );
2025-11-09T23:38:14.6104037Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-09T23:38:14.6107118Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.6107444Z +    helpers::inc4(
2025-11-09T23:38:14.6107731Z +        &mut w7,
2025-11-09T23:38:14.6108061Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.6108340Z +        w0,
2025-11-09T23:38:14.6108672Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.6108952Z +    );
2025-11-09T23:38:14.6109392Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-09T23:38:14.6110083Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.6110700Z +    helpers::inc4(
2025-11-09T23:38:14.6110991Z +        &mut w8,
2025-11-09T23:38:14.6111322Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.6111621Z +        w1,
2025-11-09T23:38:14.6112073Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.6112387Z +    );
2025-11-09T23:38:14.6113042Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-09T23:38:14.6121496Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6121858Z      {
2025-11-09T23:38:14.6123005Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:902:
2025-11-09T23:38:14.6123442Z          let a_after_40 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6123886Z          let h_after_40 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6124680Z -        println!("DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}", a_after_40, h_after_40);
2025-11-09T23:38:14.6124990Z +        println!(
2025-11-09T23:38:14.6125395Z +            "DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.6125716Z +            a_after_40, h_after_40
2025-11-09T23:38:14.6125996Z +        );
2025-11-09T23:38:14.6126611Z      }
2025-11-09T23:38:14.6127335Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.6127644Z +    helpers::inc4(
2025-11-09T23:38:14.6127926Z +        &mut w9,
2025-11-09T23:38:14.6128265Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.6128547Z +        w2,
2025-11-09T23:38:14.6128883Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.6129160Z +    );
2025-11-09T23:38:14.6129609Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-09T23:38:14.6130314Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.6130621Z +    helpers::inc4(
2025-11-09T23:38:14.6130911Z +        &mut w10,
2025-11-09T23:38:14.6131244Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.6131525Z +        w3,
2025-11-09T23:38:14.6131853Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.6132137Z +    );
2025-11-09T23:38:14.6132589Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-09T23:38:14.6133327Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.6133645Z +    helpers::inc4(
2025-11-09T23:38:14.6133935Z +        &mut w11,
2025-11-09T23:38:14.6134271Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.6134697Z +        w4,
2025-11-09T23:38:14.6135033Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.6135309Z +    );
2025-11-09T23:38:14.6135757Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-09T23:38:14.6136482Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.6136788Z +    helpers::inc4(
2025-11-09T23:38:14.6137074Z +        &mut w12,
2025-11-09T23:38:14.6137414Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.6137696Z +        w5,
2025-11-09T23:38:14.6138032Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.6138309Z +    );
2025-11-09T23:38:14.6138764Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-09T23:38:14.6139488Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.6139796Z +    helpers::inc4(
2025-11-09T23:38:14.6140088Z +        &mut w13,
2025-11-09T23:38:14.6140420Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.6140705Z +        w6,
2025-11-09T23:38:14.6141035Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.6141318Z +    );
2025-11-09T23:38:14.6141763Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-09T23:38:14.6142486Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.6142796Z +    helpers::inc4(
2025-11-09T23:38:14.6143081Z +        &mut w14,
2025-11-09T23:38:14.6143417Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.6143694Z +        w7,
2025-11-09T23:38:14.6144031Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.6144429Z +    );
2025-11-09T23:38:14.6144886Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-09T23:38:14.6145606Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.6145908Z +    helpers::inc4(
2025-11-09T23:38:14.6146195Z +        &mut w15,
2025-11-09T23:38:14.6148291Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.6148581Z +        w8,
2025-11-09T23:38:14.6148911Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.6149185Z +    );
2025-11-09T23:38:14.6149636Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-09T23:38:14.6150326Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6150629Z +    helpers::inc4(
2025-11-09T23:38:14.6150911Z +        &mut w0,
2025-11-09T23:38:14.6151254Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.6151536Z +        w9,
2025-11-09T23:38:14.6151863Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.6152150Z +    );
2025-11-09T23:38:14.6152867Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-09T23:38:14.6153206Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6153480Z      {
2025-11-09T23:38:14.6154720Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:924:
2025-11-09T23:38:14.6155149Z          let a_after_48 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6155623Z          println!("DEBUG T3 R48 after: a=0x{:08x}", a_after_48);
2025-11-09T23:38:14.6155912Z      }
2025-11-09T23:38:14.6156616Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.6158621Z +    helpers::inc4(
2025-11-09T23:38:14.6158911Z +        &mut w1,
2025-11-09T23:38:14.6159247Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.6159528Z +        w10,
2025-11-09T23:38:14.6159856Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.6160138Z +    );
2025-11-09T23:38:14.6160579Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-09T23:38:14.6161289Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.6161602Z +    helpers::inc4(
2025-11-09T23:38:14.6161885Z +        &mut w2,
2025-11-09T23:38:14.6162221Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6162501Z +        w11,
2025-11-09T23:38:14.6162837Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6163112Z +    );
2025-11-09T23:38:14.6163555Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-09T23:38:14.6164248Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.6164673Z +    helpers::inc4(
2025-11-09T23:38:14.6164958Z +        &mut w3,
2025-11-09T23:38:14.6165290Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6165576Z +        w12,
2025-11-09T23:38:14.6165904Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6166175Z +    );
2025-11-09T23:38:14.6166625Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-09T23:38:14.6167318Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.6167623Z +    helpers::inc4(
2025-11-09T23:38:14.6167912Z +        &mut w4,
2025-11-09T23:38:14.6168243Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6168525Z +        w13,
2025-11-09T23:38:14.6169293Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6169591Z +    );
2025-11-09T23:38:14.6170035Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-09T23:38:14.6170728Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.6171044Z +    helpers::inc4(
2025-11-09T23:38:14.6171323Z +        &mut w5,
2025-11-09T23:38:14.6171663Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6171944Z +        w14,
2025-11-09T23:38:14.6172280Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6172559Z +    );
2025-11-09T23:38:14.6172996Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-09T23:38:14.6173709Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.6174019Z +    helpers::inc4(
2025-11-09T23:38:14.6174487Z +        &mut w6,
2025-11-09T23:38:14.6174822Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6175112Z +        w15,
2025-11-09T23:38:14.6175442Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6175722Z +    );
2025-11-09T23:38:14.6176171Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-09T23:38:14.6176853Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.6177153Z +    helpers::inc4(
2025-11-09T23:38:14.6177435Z +        &mut w7,
2025-11-09T23:38:14.6177777Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.6178054Z +        w0,
2025-11-09T23:38:14.6178379Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.6178660Z +    );
2025-11-09T23:38:14.6179100Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-09T23:38:14.6180114Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.6180422Z +    helpers::inc4(
2025-11-09T23:38:14.6180718Z +        &mut w8,
2025-11-09T23:38:14.6181052Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.6181329Z +        w1,
2025-11-09T23:38:14.6181671Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.6181945Z +    );
2025-11-09T23:38:14.6182388Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-09T23:38:14.6182716Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6183000Z      {
2025-11-09T23:38:14.6184104Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:945:
2025-11-09T23:38:14.6184662Z          let a_after_56 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6185141Z          println!("DEBUG T3 R56 after: a=0x{:08x}", a_after_56);
2025-11-09T23:38:14.6185416Z      }
2025-11-09T23:38:14.6186124Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.6186429Z +    helpers::inc4(
2025-11-09T23:38:14.6186711Z +        &mut w9,
2025-11-09T23:38:14.6187044Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.6187323Z +        w2,
2025-11-09T23:38:14.6187659Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.6187932Z +    );
2025-11-09T23:38:14.6188373Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-09T23:38:14.6189078Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.6189386Z +    helpers::inc4(
2025-11-09T23:38:14.6189670Z +        &mut w10,
2025-11-09T23:38:14.6190003Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.6190292Z +        w3,
2025-11-09T23:38:14.6190625Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.6190902Z +    );
2025-11-09T23:38:14.6191350Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-09T23:38:14.6192076Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.6192380Z +    helpers::inc4(
2025-11-09T23:38:14.6192663Z +        &mut w11,
2025-11-09T23:38:14.6192997Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.6193276Z +        w4,
2025-11-09T23:38:14.6193614Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.6193896Z +    );
2025-11-09T23:38:14.6194457Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-09T23:38:14.6195167Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.6195468Z +    helpers::inc4(
2025-11-09T23:38:14.6195762Z +        &mut w12,
2025-11-09T23:38:14.6196096Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.6196373Z +        w5,
2025-11-09T23:38:14.6196707Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.6196984Z +    );
2025-11-09T23:38:14.6197427Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-09T23:38:14.6198153Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.6198463Z +    helpers::inc4(
2025-11-09T23:38:14.6198746Z +        &mut w13,
2025-11-09T23:38:14.6199078Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.6199365Z +        w6,
2025-11-09T23:38:14.6199699Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.6199974Z +    );
2025-11-09T23:38:14.6200416Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-09T23:38:14.6201299Z      // Core Transform 3 rounds 62-63: Use Add with 5 args, w14/w15 NOT modified (different from Transform 1)
2025-11-09T23:38:14.6202260Z -    round!(c, d, e, f, g, h, a, b, helpers::add5(k(K_ARRAY.0[62]), w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15)));
2025-11-09T23:38:14.6203199Z -    round!(b, c, d, e, f, g, h, a, helpers::add5(k(K_ARRAY.0[63]), w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0)));
2025-11-09T23:38:14.6203752Z +    round!(
2025-11-09T23:38:14.6204033Z +        c,
2025-11-09T23:38:14.6204432Z +        d,
2025-11-09T23:38:14.6204723Z +        e,
2025-11-09T23:38:14.6205001Z +        f,
2025-11-09T23:38:14.6205285Z +        g,
2025-11-09T23:38:14.6205565Z +        h,
2025-11-09T23:38:14.6205853Z +        a,
2025-11-09T23:38:14.6206134Z +        b,
2025-11-09T23:38:14.6206446Z +        helpers::add5(
2025-11-09T23:38:14.6206765Z +            k(K_ARRAY.0[62]),
2025-11-09T23:38:14.6207048Z +            w14,
2025-11-09T23:38:14.6207394Z +            helpers::sigma1_small(w12),
2025-11-09T23:38:14.6207673Z +            w7,
2025-11-09T23:38:14.6208018Z +            helpers::sigma0_small(w15)
2025-11-09T23:38:14.6208294Z +        )
2025-11-09T23:38:14.6208573Z +    );
2025-11-09T23:38:14.6210756Z +    round!(
2025-11-09T23:38:14.6211036Z +        b,
2025-11-09T23:38:14.6211313Z +        c,
2025-11-09T23:38:14.6211588Z +        d,
2025-11-09T23:38:14.6211875Z +        e,
2025-11-09T23:38:14.6212153Z +        f,
2025-11-09T23:38:14.6212452Z +        g,
2025-11-09T23:38:14.6212885Z +        h,
2025-11-09T23:38:14.6213170Z +        a,
2025-11-09T23:38:14.6213669Z +        helpers::add5(
2025-11-09T23:38:14.6214172Z +            k(K_ARRAY.0[63]),
2025-11-09T23:38:14.6214603Z +            w15,
2025-11-09T23:38:14.6214957Z +            helpers::sigma1_small(w13),
2025-11-09T23:38:14.6215240Z +            w8,
2025-11-09T23:38:14.6215581Z +            helpers::sigma0_small(w0)
2025-11-09T23:38:14.6215868Z +        )
2025-11-09T23:38:14.6216149Z +    );
2025-11-09T23:38:14.6216425Z  
2025-11-09T23:38:14.6216811Z      // Add initial hash values and write output
2025-11-09T23:38:14.6217259Z      // Core: Add initial hash values before writing output
2025-11-09T23:38:14.6218375Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:976:
2025-11-09T23:38:14.6218838Z          let f_before_final = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.6219305Z          let g_before_final = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.6219784Z          let h_before_final = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6220991Z -        println!("DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_final, b_before_final, c_before_final, d_before_final);
2025-11-09T23:38:14.6221868Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_final, f_before_final, g_before_final, h_before_final);
2025-11-09T23:38:14.6222833Z -        println!("DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)", a_before_final);
2025-11-09T23:38:14.6223129Z +        println!(
2025-11-09T23:38:14.6223811Z +            "DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.6224472Z +            a_before_final, b_before_final, c_before_final, d_before_final
2025-11-09T23:38:14.6224763Z +        );
2025-11-09T23:38:14.6225066Z +        println!(
2025-11-09T23:38:14.6225466Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.6226002Z +            e_before_final, f_before_final, g_before_final, h_before_final
2025-11-09T23:38:14.6227935Z +        );
2025-11-09T23:38:14.6228230Z +        println!(
2025-11-09T23:38:14.6228965Z +            "DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)",
2025-11-09T23:38:14.6229275Z +            a_before_final
2025-11-09T23:38:14.6229558Z +        );
2025-11-09T23:38:14.6229834Z      }
2025-11-09T23:38:14.6230193Z      // Write8(out, 0, Add(a, K(0x6a09e667ul)));
2025-11-09T23:38:14.6230602Z      let a_final = add(a, k(INITIAL_HASH.0[0]));
2025-11-09T23:38:14.6231800Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:985:
2025-11-09T23:38:14.6232134Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6232408Z      {
2025-11-09T23:38:14.6232884Z          let a_final_val = _mm256_extract_epi32(a_final, 0) as u32;
2025-11-09T23:38:14.6233912Z -        println!("DEBUG Transform 3 final a (after adding initial): 0x{:08x}", a_final_val);
2025-11-09T23:38:14.6234208Z +        println!(
2025-11-09T23:38:14.6234883Z +            "DEBUG Transform 3 final a (after adding initial): 0x{:08x}",
2025-11-09T23:38:14.6235191Z +            a_final_val
2025-11-09T23:38:14.6235470Z +        );
2025-11-09T23:38:14.6235745Z      }
2025-11-09T23:38:14.6236068Z      write8(out, 0, a_final);
2025-11-09T23:38:14.6236455Z      write8(out, 4, add(b, k(INITIAL_HASH.0[1])));
2025-11-09T23:38:14.6237614Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1015:
2025-11-09T23:38:14.6238214Z      // For inputs that aren't exactly 64 bytes, we need to handle padding
2025-11-09T23:38:14.6238708Z      // For now, use sha2 crate as fallback for non-64-byte inputs
2025-11-09T23:38:14.6239161Z      use bitcoin_hashes::{sha256d, Hash as BitcoinHash};
2025-11-09T23:38:14.6239449Z -    
2025-11-09T23:38:14.6239749Z +
2025-11-09T23:38:14.6240133Z      // Check if all inputs are exactly 64 bytes
2025-11-09T23:38:14.6240668Z      let all_64_bytes = inputs.iter().all(|input| input.len() == 64);
2025-11-09T23:38:14.6240955Z -    
2025-11-09T23:38:14.6241232Z +
2025-11-09T23:38:14.6241528Z      if !all_64_bytes {
2025-11-09T23:38:14.6241957Z          // Fallback to sha2 crate for non-64-byte inputs
2025-11-09T23:38:14.6242297Z          let mut results = [[0u8; 32]; 8];
2025-11-09T23:38:14.6243622Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1028:
2025-11-09T23:38:14.6243918Z          }
2025-11-09T23:38:14.6244230Z          return results;
2025-11-09T23:38:14.6244631Z      }
2025-11-09T23:38:14.6244911Z -    
2025-11-09T23:38:14.6245194Z +
2025-11-09T23:38:14.6245613Z      // Pack 8 inputs into contiguous 512-byte buffer
2025-11-09T23:38:14.6245946Z      let mut input_buf = [0u8; 512];
2025-11-09T23:38:14.6246333Z      for (i, input) in inputs.iter().enumerate() {
2025-11-09T23:38:14.6248557Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1035:
2025-11-09T23:38:14.6249020Z          input_buf[i * 64..(i + 1) * 64].copy_from_slice(input);
2025-11-09T23:38:14.6249300Z      }
2025-11-09T23:38:14.6249582Z -    
2025-11-09T23:38:14.6249854Z +
2025-11-09T23:38:14.6250185Z      // Transform (double SHA256)
2025-11-09T23:38:14.6250921Z      let mut output_buf = [0u8; 256];
2025-11-09T23:38:14.6251334Z      transform_8way(&mut output_buf, &input_buf);
2025-11-09T23:38:14.6252446Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1041:
2025-11-09T23:38:14.6252726Z -    
2025-11-09T23:38:14.6253012Z +
2025-11-09T23:38:14.6253304Z      // Unpack results
2025-11-09T23:38:14.6253640Z      let mut results = [[0u8; 32]; 8];
2025-11-09T23:38:14.6253935Z      for i in 0..8 {
2025-11-09T23:38:14.6255268Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1045:
2025-11-09T23:38:14.6255819Z          results[i].copy_from_slice(&output_buf[i * 32..(i + 1) * 32]);
2025-11-09T23:38:14.6256106Z      }
2025-11-09T23:38:14.6256391Z -    
2025-11-09T23:38:14.6256665Z +
2025-11-09T23:38:14.6258765Z      results
2025-11-09T23:38:14.6259050Z  }
2025-11-09T23:38:14.6259325Z  
2025-11-09T23:38:14.6260428Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1085:
2025-11-09T23:38:14.6260744Z          input_buf[1] = 0x45;
2025-11-09T23:38:14.6261063Z          input_buf[2] = 0x23;
2025-11-09T23:38:14.6261378Z          input_buf[3] = 0x01;
2025-11-09T23:38:14.6261655Z -        
2025-11-09T23:38:14.6261935Z +
2025-11-09T23:38:14.6262216Z          unsafe {
2025-11-09T23:38:14.6262537Z              // Read from offset 0
2025-11-09T23:38:14.6262877Z              let v = read8(&input_buf, 0);
2025-11-09T23:38:14.6263993Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1092:
2025-11-09T23:38:14.6264703Z -            
2025-11-09T23:38:14.6264982Z +
2025-11-09T23:38:14.6265325Z              // Extract the first word
2025-11-09T23:38:14.6265751Z              // After _mm256_set_epi32(words[7], ..., words[0]):
2025-11-09T23:38:14.6266122Z              // - Index 0 = words[0] (block 0)
2025-11-09T23:38:14.6267236Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1096:
2025-11-09T23:38:14.6267586Z              // - Index 7 = words[7] (block 7)
2025-11-09T23:38:14.6267956Z              // So we extract from index 0 for block 0
2025-11-09T23:38:14.6268363Z              let word0 = _mm256_extract_epi32(v, 0) as u32;
2025-11-09T23:38:14.6268649Z -            
2025-11-09T23:38:14.6268922Z +
2025-11-09T23:38:14.6269274Z              println!("Read8 shuffle test:");
2025-11-09T23:38:14.6269766Z              println!("  Input: 0x01234567 (LE bytes: [67, 45, 23, 01])");
2025-11-09T23:38:14.6270170Z              println!("  Output word0: 0x{:08x}", word0);
2025-11-09T23:38:14.6271288Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1103:
2025-11-09T23:38:14.6271989Z              println!("  Expected: 0x01234567 (if no swap) or 0x67452301 (if byte-reversed)");
2025-11-09T23:38:14.6272611Z              println!("  Or maybe: 0x23014567 or something else depending on shuffle");
2025-11-09T23:38:14.6272892Z -            
2025-11-09T23:38:14.6273171Z +
2025-11-09T23:38:14.6273542Z              // Also check what the shuffle mask does
2025-11-09T23:38:14.6273936Z              let test_word = _mm256_set1_epi32(0x01234567);
2025-11-09T23:38:14.6274421Z              let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.6275537Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1109:
2025-11-09T23:38:14.6275947Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.6276355Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.6278833Z +                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.6279136Z +                0x00010203,
2025-11-09T23:38:14.6279417Z              );
2025-11-09T23:38:14.6279953Z              let shuffled = _mm256_shuffle_epi8(test_word, shuffle_mask);
2025-11-09T23:38:14.6280482Z              let shuffled_word = _mm256_extract_epi32(shuffled, 0) as u32;
2025-11-09T23:38:14.6281592Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1134:
2025-11-09T23:38:14.6281927Z              let mut f = k(0x9b05688c);
2025-11-09T23:38:14.6282254Z              let mut g = k(0x1f83d9ab);
2025-11-09T23:38:14.6282583Z              let mut h = k(0x5be0cd19);
2025-11-09T23:38:14.6282867Z -            
2025-11-09T23:38:14.6283145Z +
2025-11-09T23:38:14.6283567Z              let d_before = _mm256_extract_epi32(d, 0) as u32;
2025-11-09T23:38:14.6284002Z              let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6284404Z -            
2025-11-09T23:38:14.6284677Z +
2025-11-09T23:38:14.6284995Z              // Call round macro
2025-11-09T23:38:14.6285385Z              round!(a, b, c, d, e, f, g, h, k(0x428a2f98));
2025-11-09T23:38:14.6285672Z -            
2025-11-09T23:38:14.6285943Z +
2025-11-09T23:38:14.6286355Z              let d_after = _mm256_extract_epi32(d, 0) as u32;
2025-11-09T23:38:14.6288385Z              let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6288667Z -            
2025-11-09T23:38:14.6288941Z +
2025-11-09T23:38:14.6289388Z              println!("Round macro state modification test:");
2025-11-09T23:38:14.6290108Z -            println!("  d before: 0x{:08x}, after: 0x{:08x} (should be different)", d_before, d_after);
2025-11-09T23:38:14.6290816Z -            println!("  h before: 0x{:08x}, after: 0x{:08x} (should be different)", h_before, h_after);
2025-11-09T23:38:14.6291387Z -            
2025-11-09T23:38:14.6291690Z +            println!(
2025-11-09T23:38:14.6292182Z +                "  d before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-09T23:38:14.6292504Z +                d_before, d_after
2025-11-09T23:38:14.6292791Z +            );
2025-11-09T23:38:14.6293092Z +            println!(
2025-11-09T23:38:14.6293575Z +                "  h before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-09T23:38:14.6293896Z +                h_before, h_after
2025-11-09T23:38:14.6294183Z +            );
2025-11-09T23:38:14.6294578Z +
2025-11-09T23:38:14.6294910Z              if d_before == d_after {
2025-11-09T23:38:14.6295309Z                  println!("  ERROR: d was not modified!");
2025-11-09T23:38:14.6295588Z              }
2025-11-09T23:38:14.6296715Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1168:
2025-11-09T23:38:14.6297078Z          // Test with 8 identical 64-byte inputs
2025-11-09T23:38:14.6297424Z          let test_data = [0u8; 64];
2025-11-09T23:38:14.6297745Z          let inputs: [&[u8]; 8] = [
2025-11-09T23:38:14.6298171Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6298594Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6299281Z +            &test_data, &test_data, &test_data, &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6299629Z +            &test_data,
2025-11-09T23:38:14.6299912Z          ];
2025-11-09T23:38:14.6300189Z  
2025-11-09T23:38:14.6300470Z          unsafe {
2025-11-09T23:38:14.6301586Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1176:
2025-11-09T23:38:14.6302004Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-09T23:38:14.6302281Z -            
2025-11-09T23:38:14.6302586Z +
2025-11-09T23:38:14.6303159Z              // Compute expected result using bitcoin_hashes (double SHA256)
2025-11-09T23:38:14.6303892Z              // bitcoin_hashes::sha256d is the standard Bitcoin double SHA256 implementation
2025-11-09T23:38:14.6304394Z              let mut engine = sha256d::Hash::engine();
2025-11-09T23:38:14.6305514Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1181:
2025-11-09T23:38:14.6305856Z              engine.input(&test_data);
2025-11-09T23:38:14.6306300Z              let expected = sha256d::Hash::from_engine(engine);
2025-11-09T23:38:14.6306703Z              let expected_bytes = expected.into_inner();
2025-11-09T23:38:14.6306991Z -            
2025-11-09T23:38:14.6307268Z +
2025-11-09T23:38:14.6307785Z              // Debug: print first few bytes
2025-11-09T23:38:14.6308239Z              println!("Expected: {:?}", &expected_bytes[..8]);
2025-11-09T23:38:14.6308664Z              println!("Got:      {:?}", &avx2_results[0][..8]);
2025-11-09T23:38:14.6309780Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1188:
2025-11-09T23:38:14.6310094Z -            
2025-11-09T23:38:14.6310369Z +
2025-11-09T23:38:14.6310790Z              // All 8 results should be identical (same input)
2025-11-09T23:38:14.6311235Z              for (i, result) in avx2_results.iter().enumerate() {
2025-11-09T23:38:14.6311600Z                  if result != &expected_bytes {
2025-11-09T23:38:14.6312928Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1192:
2025-11-09T23:38:14.6313457Z -                    println!("Mismatch at index {}: expected {:?}, got {:?}", 
2025-11-09T23:38:14.6313853Z -                        i, &expected_bytes[..16], &result[..16]);
2025-11-09T23:38:14.6314163Z +                    println!(
2025-11-09T23:38:14.6314719Z +                        "Mismatch at index {}: expected {:?}, got {:?}",
2025-11-09T23:38:14.6315022Z +                        i,
2025-11-09T23:38:14.6315366Z +                        &expected_bytes[..16],
2025-11-09T23:38:14.6315876Z +                        &result[..16]
2025-11-09T23:38:14.6316274Z +                    );
2025-11-09T23:38:14.6316556Z                  }
2025-11-09T23:38:14.6316861Z                  assert_eq!(
2025-11-09T23:38:14.6317210Z                      result, &expected_bytes,
2025-11-09T23:38:14.6318330Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1215:
2025-11-09T23:38:14.6318658Z              input_data[i][0] = i as u8;
2025-11-09T23:38:14.6318935Z          }
2025-11-09T23:38:14.6319254Z          let inputs: [&[u8]; 8] = [
2025-11-09T23:38:14.6319787Z -            &input_data[0], &input_data[1], &input_data[2], &input_data[3],
2025-11-09T23:38:14.6320311Z -            &input_data[4], &input_data[5], &input_data[6], &input_data[7],
2025-11-09T23:38:14.6320621Z +            &input_data[0],
2025-11-09T23:38:14.6320933Z +            &input_data[1],
2025-11-09T23:38:14.6321320Z +            &input_data[2],
2025-11-09T23:38:14.6321626Z +            &input_data[3],
2025-11-09T23:38:14.6321953Z +            &input_data[4],
2025-11-09T23:38:14.6322267Z +            &input_data[5],
2025-11-09T23:38:14.6322569Z +            &input_data[6],
2025-11-09T23:38:14.6323467Z +            &input_data[7],
2025-11-09T23:38:14.6323768Z          ];
2025-11-09T23:38:14.6324040Z  
2025-11-09T23:38:14.6324449Z          unsafe {
2025-11-09T23:38:14.6325575Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1223:
2025-11-09T23:38:14.6325988Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-09T23:38:14.6326268Z -            
2025-11-09T23:38:14.6326543Z +
2025-11-09T23:38:14.6326949Z              // Compute expected results using sha2 crate
2025-11-09T23:38:14.6327370Z              for (i, input) in input_data.iter().enumerate() {
2025-11-09T23:38:14.6327769Z                  let mut engine = sha256d::Hash::engine();
2025-11-09T23:38:14.6328888Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1228:
2025-11-09T23:38:14.6329246Z                  engine.input(input);
2025-11-09T23:38:14.6329690Z                  let expected = sha256d::Hash::from_engine(engine);
2025-11-09T23:38:14.6330098Z                  let expected_bytes = expected.into_inner();
2025-11-09T23:38:14.6330387Z -                
2025-11-09T23:38:14.6330659Z +
2025-11-09T23:38:14.6330961Z                  assert_eq!(
2025-11-09T23:38:14.6331333Z                      &avx2_results[i], &expected_bytes,
2025-11-09T23:38:14.6331915Z                      "AVX2 result {} does not match expected double SHA256 for input {}",
2025-11-09T23:38:14.6332936Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:59:
2025-11-09T23:38:14.6333223Z  
2025-11-09T23:38:14.6333984Z      // SHA256 constants (first 32 bits of fractional parts of cube roots of first 64 primes)
2025-11-09T23:38:14.6334474Z      const K: [u32; 64] = [
2025-11-09T23:38:14.6335354Z -        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.6336229Z -        0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.6338568Z -        0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.6339417Z -        0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.6340480Z -        0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.6341336Z -        0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.6342194Z -        0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.6343054Z -        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.6344524Z +        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4,
2025-11-09T23:38:14.6345281Z +        0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe,
2025-11-09T23:38:14.6346020Z +        0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f,
2025-11-09T23:38:14.6346745Z +        0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-09T23:38:14.6348772Z +        0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc,
2025-11-09T23:38:14.6349487Z +        0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b,
2025-11-09T23:38:14.6350197Z +        0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116,
2025-11-09T23:38:14.6350919Z +        0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.6351658Z +        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7,
2025-11-09T23:38:14.6351956Z +        0xc67178f2,
2025-11-09T23:38:14.6352234Z      ];
2025-11-09T23:38:14.6352508Z  
2025-11-09T23:38:14.6352859Z      // Process input data with padding
2025-11-09T23:38:14.6353886Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:73:
2025-11-09T23:38:14.6354582Z      let mut padded = Vec::with_capacity(((data.len() + 9 + 63) / 64) * 64);
2025-11-09T23:38:14.6354946Z      padded.extend_from_slice(data);
2025-11-09T23:38:14.6355221Z -    
2025-11-09T23:38:14.6355494Z +
2025-11-09T23:38:14.6355965Z      // Add padding: 0x80 byte, then zeros, then 64-bit length
2025-11-09T23:38:14.6356291Z      padded.push(0x80);
2025-11-09T23:38:14.6356637Z      let bit_len = (data.len() as u64) * 8;
2025-11-09T23:38:14.6359114Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:102:
2025-11-09T23:38:14.6359459Z          let state1_save = state1;
2025-11-09T23:38:14.6359743Z  
2025-11-09T23:38:14.6360032Z          // Rounds 0-3
2025-11-09T23:38:14.6360738Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32));
2025-11-09T23:38:14.6361069Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6361427Z +            msg0,
2025-11-09T23:38:14.6361936Z +            _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32),
2025-11-09T23:38:14.6362228Z +        );
2025-11-09T23:38:14.6362671Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6363024Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6363469Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6364610Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:109:
2025-11-09T23:38:14.6364893Z  
2025-11-09T23:38:14.6365188Z          // Rounds 4-7
2025-11-09T23:38:14.6365905Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32));
2025-11-09T23:38:14.6366241Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6366525Z +            msg1,
2025-11-09T23:38:14.6367040Z +            _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32),
2025-11-09T23:38:14.6367325Z +        );
2025-11-09T23:38:14.6367768Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6368126Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6368563Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6369592Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:115:
2025-11-09T23:38:14.6369958Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6370238Z  
2025-11-09T23:38:14.6370536Z          // Rounds 8-11
2025-11-09T23:38:14.6371253Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32));
2025-11-09T23:38:14.6371881Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6372164Z +            msg2,
2025-11-09T23:38:14.6372677Z +            _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32),
2025-11-09T23:38:14.6372955Z +        );
2025-11-09T23:38:14.6373408Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6373759Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6374196Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6375346Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:122:
2025-11-09T23:38:14.6375708Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6375984Z  
2025-11-09T23:38:14.6376288Z          // Rounds 12-15
2025-11-09T23:38:14.6377008Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32));
2025-11-09T23:38:14.6377319Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6377615Z +            msg3,
2025-11-09T23:38:14.6378144Z +            _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32),
2025-11-09T23:38:14.6378427Z +        );
2025-11-09T23:38:14.6378866Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6379226Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6379557Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6380589Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:132:
2025-11-09T23:38:14.6380952Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6381224Z  
2025-11-09T23:38:14.6381520Z          // Rounds 16-19
2025-11-09T23:38:14.6382230Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32));
2025-11-09T23:38:14.6382552Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6382830Z +            msg0,
2025-11-09T23:38:14.6383346Z +            _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32),
2025-11-09T23:38:14.6383648Z +        );
2025-11-09T23:38:14.6384082Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6384553Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6384889Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6385925Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:142:
2025-11-09T23:38:14.6386282Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6386556Z  
2025-11-09T23:38:14.6388588Z          // Rounds 20-23
2025-11-09T23:38:14.6389317Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32));
2025-11-09T23:38:14.6389632Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6389953Z +            msg1,
2025-11-09T23:38:14.6390628Z +            _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32),
2025-11-09T23:38:14.6390923Z +        );
2025-11-09T23:38:14.6391368Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6391725Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6392060Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6393088Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:152:
2025-11-09T23:38:14.6393457Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6393734Z  
2025-11-09T23:38:14.6394032Z          // Rounds 24-27
2025-11-09T23:38:14.6394875Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32));
2025-11-09T23:38:14.6395193Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6395474Z +            msg2,
2025-11-09T23:38:14.6395997Z +            _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32),
2025-11-09T23:38:14.6396284Z +        );
2025-11-09T23:38:14.6396722Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6397364Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6397704Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6400110Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:162:
2025-11-09T23:38:14.6400471Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6400746Z  
2025-11-09T23:38:14.6401049Z          // Rounds 28-31
2025-11-09T23:38:14.6401773Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32));
2025-11-09T23:38:14.6402089Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6402379Z +            msg3,
2025-11-09T23:38:14.6402899Z +            _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32),
2025-11-09T23:38:14.6403177Z +        );
2025-11-09T23:38:14.6403624Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6403979Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6404443Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6405471Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:172:
2025-11-09T23:38:14.6405837Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6406112Z  
2025-11-09T23:38:14.6406412Z          // Rounds 32-35
2025-11-09T23:38:14.6408607Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32));
2025-11-09T23:38:14.6408920Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6409202Z +            msg0,
2025-11-09T23:38:14.6409725Z +            _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32),
2025-11-09T23:38:14.6410007Z +        );
2025-11-09T23:38:14.6410445Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6410800Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6411134Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6412167Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:182:
2025-11-09T23:38:14.6412533Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6412977Z  
2025-11-09T23:38:14.6413275Z          // Rounds 36-39
2025-11-09T23:38:14.6413987Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32));
2025-11-09T23:38:14.6414475Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6414769Z +            msg1,
2025-11-09T23:38:14.6415291Z +            _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32),
2025-11-09T23:38:14.6415569Z +        );
2025-11-09T23:38:14.6416012Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6416364Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6416694Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6417726Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:192:
2025-11-09T23:38:14.6418108Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6418383Z  
2025-11-09T23:38:14.6418682Z          // Rounds 40-43
2025-11-09T23:38:14.6419411Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32));
2025-11-09T23:38:14.6419726Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6420009Z +            msg2,
2025-11-09T23:38:14.6420531Z +            _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32),
2025-11-09T23:38:14.6420809Z +        );
2025-11-09T23:38:14.6421254Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6421613Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6421958Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6423064Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:202:
2025-11-09T23:38:14.6423421Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6423962Z  
2025-11-09T23:38:14.6424257Z          // Rounds 44-47
2025-11-09T23:38:14.6425104Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32));
2025-11-09T23:38:14.6425424Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6425702Z +            msg3,
2025-11-09T23:38:14.6426223Z +            _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32),
2025-11-09T23:38:14.6426500Z +        );
2025-11-09T23:38:14.6426947Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6427300Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6427632Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6428656Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:212:
2025-11-09T23:38:14.6429017Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6429294Z  
2025-11-09T23:38:14.6429591Z          // Rounds 48-51
2025-11-09T23:38:14.6430331Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32));
2025-11-09T23:38:14.6430646Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6430927Z +            msg0,
2025-11-09T23:38:14.6431450Z +            _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32),
2025-11-09T23:38:14.6431727Z +        );
2025-11-09T23:38:14.6432175Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6432541Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6432944Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6433999Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:222:
2025-11-09T23:38:14.6434478Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6435099Z  
2025-11-09T23:38:14.6435423Z          // Rounds 52-55
2025-11-09T23:38:14.6436155Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32));
2025-11-09T23:38:14.6436499Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6436777Z +            msg1,
2025-11-09T23:38:14.6437301Z +            _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32),
2025-11-09T23:38:14.6437583Z +        );
2025-11-09T23:38:14.6438034Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6438387Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6438723Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6439763Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:231:
2025-11-09T23:38:14.6440207Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6440488Z  
2025-11-09T23:38:14.6440794Z          // Rounds 56-59
2025-11-09T23:38:14.6441516Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32));
2025-11-09T23:38:14.6441838Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6442126Z +            msg2,
2025-11-09T23:38:14.6442651Z +            _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32),
2025-11-09T23:38:14.6442930Z +        );
2025-11-09T23:38:14.6443433Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6443797Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6444132Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6445284Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:240:
2025-11-09T23:38:14.6445737Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6446010Z  
2025-11-09T23:38:14.6446316Z          // Rounds 60-63
2025-11-09T23:38:14.6448472Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32));
2025-11-09T23:38:14.6448789Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6449072Z +            msg3,
2025-11-09T23:38:14.6449882Z +            _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32),
2025-11-09T23:38:14.6450167Z +        );
2025-11-09T23:38:14.6450607Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6450963Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6451404Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6452425Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:254:
2025-11-09T23:38:14.6452952Z      // state0 contains h0,h1,h4,h5 and state1 contains h2,h3,h6,h7
2025-11-09T23:38:14.6453332Z      // Need to reorder to h0,h1,h2,h3,h4,h5,h6,h7
2025-11-09T23:38:14.6453655Z      let mut result = [0u8; 32];
2025-11-09T23:38:14.6453934Z -    
2025-11-09T23:38:14.6454216Z +
2025-11-09T23:38:14.6454696Z      // Extract and byte-swap each 32-bit word
2025-11-09T23:38:14.6455192Z      let state0_swapped = _mm_shuffle_epi8(state0, shuf_mask);
2025-11-09T23:38:14.6455709Z      let state1_swapped = _mm_shuffle_epi8(state1, shuf_mask);
2025-11-09T23:38:14.6458373Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:261:
2025-11-09T23:38:14.6458653Z -    
2025-11-09T23:38:14.6458928Z +
2025-11-09T23:38:14.6459528Z      _mm_storeu_si128(result.as_mut_ptr() as *mut __m128i, state0_swapped);
2025-11-09T23:38:14.6460178Z      _mm_storeu_si128(result.as_mut_ptr().add(16) as *mut __m128i, state1_swapped);
2025-11-09T23:38:14.6460459Z  
2025-11-09T23:38:14.6461491Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:286:
2025-11-09T23:38:14.6461821Z              fallback_sha256(data)
2025-11-09T23:38:14.6462098Z          }
2025-11-09T23:38:14.6462381Z      }
2025-11-09T23:38:14.6462654Z -    
2025-11-09T23:38:14.6462927Z +
2025-11-09T23:38:14.6463255Z      #[cfg(not(target_arch = "x86_64"))]
2025-11-09T23:38:14.6463536Z      {
2025-11-09T23:38:14.6463851Z          fallback_sha256(data)
2025-11-09T23:38:14.6465639Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:316:
2025-11-09T23:38:14.6465991Z      fn test_sha256_empty() {
2025-11-09T23:38:14.6466300Z          let input = b"";
2025-11-09T23:38:14.6466620Z          let result = sha256(input);
2025-11-09T23:38:14.6466899Z -        
2025-11-09T23:38:14.6467175Z +
2025-11-09T23:38:14.6467985Z          // Expected SHA256(""): e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2025-11-09T23:38:14.6468293Z          let expected = [
2025-11-09T23:38:14.6469028Z -            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24,
2025-11-09T23:38:14.6469730Z -            0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55,
2025-11-09T23:38:14.6470352Z +            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f,
2025-11-09T23:38:14.6470968Z +            0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b,
2025-11-09T23:38:14.6471303Z +            0x78, 0x52, 0xb8, 0x55,
2025-11-09T23:38:14.6471578Z          ];
2025-11-09T23:38:14.6471855Z -        
2025-11-09T23:38:14.6472133Z +
2025-11-09T23:38:14.6472476Z          assert_eq!(result, expected);
2025-11-09T23:38:14.6472766Z      }
2025-11-09T23:38:14.6473054Z  
2025-11-09T23:38:14.6474079Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:330:
2025-11-09T23:38:14.6474542Z      fn test_sha256_hello_world() {
2025-11-09T23:38:14.6474873Z          let input = b"hello world";
2025-11-09T23:38:14.6475203Z          let result = sha256(input);
2025-11-09T23:38:14.6475482Z -        
2025-11-09T23:38:14.6475750Z +
2025-11-09T23:38:14.6476079Z          // Compare with sha2 crate
2025-11-09T23:38:14.6476414Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6476775Z          let expected = Sha256::digest(input);
2025-11-09T23:38:14.6478107Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:337:
2025-11-09T23:38:14.6478389Z -        
2025-11-09T23:38:14.6478661Z +
2025-11-09T23:38:14.6479026Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6479301Z      }
2025-11-09T23:38:14.6479588Z  
2025-11-09T23:38:14.6480945Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:343:
2025-11-09T23:38:14.6481287Z          // Test various input sizes
2025-11-09T23:38:14.6481613Z          let zeros_64 = vec![0u8; 64];
2025-11-09T23:38:14.6481944Z          let ff_128 = vec![0xffu8; 128];
2025-11-09T23:38:14.6482219Z -        
2025-11-09T23:38:14.6482486Z +
2025-11-09T23:38:14.6482827Z          let test_cases: Vec<&[u8]> = vec![
2025-11-09T23:38:14.6483135Z              b"" as &[u8],
2025-11-09T23:38:14.6483407Z              b"a",
2025-11-09T23:38:14.6484559Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:357:
2025-11-09T23:38:14.6484865Z  
2025-11-09T23:38:14.6485195Z          for input in test_cases {
2025-11-09T23:38:14.6485523Z              let result = sha256(input);
2025-11-09T23:38:14.6485803Z -            
2025-11-09T23:38:14.6486075Z +
2025-11-09T23:38:14.6486404Z              // Must match sha2 crate
2025-11-09T23:38:14.6486744Z              use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6487182Z              let expected = Sha256::digest(input);
2025-11-09T23:38:14.6488197Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:364:
2025-11-09T23:38:14.6488470Z -            
2025-11-09T23:38:14.6489161Z -            assert_eq!(&result[..], &expected[..], "Mismatch for input length {}", input.len());
2025-11-09T23:38:14.6489439Z +
2025-11-09T23:38:14.6489733Z +            assert_eq!(
2025-11-09T23:38:14.6490037Z +                &result[..],
2025-11-09T23:38:14.6490343Z +                &expected[..],
2025-11-09T23:38:14.6490704Z +                "Mismatch for input length {}",
2025-11-09T23:38:14.6491019Z +                input.len()
2025-11-09T23:38:14.6491303Z +            );
2025-11-09T23:38:14.6491578Z          }
2025-11-09T23:38:14.6491845Z      }
2025-11-09T23:38:14.6492119Z  
2025-11-09T23:38:14.6493144Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:370:
2025-11-09T23:38:14.6493469Z      fn test_double_sha256() {
2025-11-09T23:38:14.6493793Z          let input = b"hello world";
2025-11-09T23:38:14.6494131Z          let result = hash256(input);
2025-11-09T23:38:14.6494575Z -        
2025-11-09T23:38:14.6494910Z +
2025-11-09T23:38:14.6495342Z          // Manually compute double SHA256 with sha2 crate
2025-11-09T23:38:14.6495678Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6496016Z          let first = Sha256::digest(input);
2025-11-09T23:38:14.6497039Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:377:
2025-11-09T23:38:14.6497427Z          let expected = Sha256::digest(&first);
2025-11-09T23:38:14.6497983Z -        
2025-11-09T23:38:14.6498322Z +
2025-11-09T23:38:14.6498728Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6506470Z      }
2025-11-09T23:38:14.6506854Z  
2025-11-09T23:38:14.6507957Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:384:
2025-11-09T23:38:14.6508366Z          // Test with 64 zero bytes (same as AVX2 test)
2025-11-09T23:38:14.6508710Z          let input = vec![0u8; 64];
2025-11-09T23:38:14.6509058Z          let result = hash256(&input);
2025-11-09T23:38:14.6509346Z -        
2025-11-09T23:38:14.6509626Z +
2025-11-09T23:38:14.6509965Z          // Compare with sha2 crate
2025-11-09T23:38:14.6510318Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6510682Z          let first = Sha256::digest(&input);
2025-11-09T23:38:14.6511746Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:391:
2025-11-09T23:38:14.6512473Z          let expected = Sha256::digest(&first);
2025-11-09T23:38:14.6512964Z -        
2025-11-09T23:38:14.6513262Z +
2025-11-09T23:38:14.6513643Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6513926Z      }
2025-11-09T23:38:14.6514206Z  }
2025-11-09T23:38:14.6515440Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:396:
2025-11-09T23:38:14.6515729Z -
2025-11-09T23:38:14.6516005Z  
2025-11-09T23:38:14.6517114Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/simd_bytes.rs:99:
2025-11-09T23:38:14.6517440Z          assert_eq!(dst, src);
2025-11-09T23:38:14.6517722Z      }
2025-11-09T23:38:14.6517997Z  }
2025-11-09T23:38:14.6518286Z -
2025-11-09T23:38:14.6518560Z  
2025-11-09T23:38:14.6519612Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:47:
2025-11-09T23:38:14.6519935Z  pub mod transaction;
2025-11-09T23:38:14.6520290Z  pub mod transaction_hash;
2025-11-09T23:38:14.6520600Z  pub mod types;
2025-11-09T23:38:14.6521118Z +#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6521723Z +pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-09T23:38:14.6522066Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6522444Z  pub use script::batch_verify_signatures;
2025-11-09T23:38:14.6522956Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6523875Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:53:
2025-11-09T23:38:14.6524199Z  pub use script::{
2025-11-09T23:38:14.6525000Z -    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool,
2025-11-09T23:38:14.6525411Z -    disable_caching, reset_benchmarking_state,
2025-11-09T23:38:14.6526244Z +    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool, disable_caching,
2025-11-09T23:38:14.6526587Z +    reset_benchmarking_state,
2025-11-09T23:38:14.6526884Z  };
2025-11-09T23:38:14.6527402Z -#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6528004Z -pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-09T23:38:14.6528514Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6528955Z  pub use transaction_hash::clear_sighash_templates;
2025-11-09T23:38:14.6529266Z  pub mod bip113;
2025-11-09T23:38:14.6530236Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mempool.rs:99:
2025-11-09T23:38:14.6530568Z                  .map(|(i, opt_utxo)| {
2025-11-09T23:38:14.6530933Z                      if let Some(utxo) = opt_utxo {
2025-11-09T23:38:14.6531295Z                          let input = &tx.inputs[*i];
2025-11-09T23:38:14.6531690Z -                        let witness: Option<&ByteString> =
2025-11-09T23:38:14.6532230Z -                            witnesses.and_then(|wits| wits.get(*i)).and_then(|wit| {
2025-11-09T23:38:14.6532587Z -                                wit.first()
2025-11-09T23:38:14.6532896Z -                            });
2025-11-09T23:38:14.6533324Z +                        let witness: Option<&ByteString> = witnesses
2025-11-09T23:38:14.6533699Z +                            .and_then(|wits| wits.get(*i))
2025-11-09T23:38:14.6534074Z +                            .and_then(|wit| wit.first());
2025-11-09T23:38:14.6534485Z  
2025-11-09T23:38:14.6535169Z                          verify_script(&input.script_sig, &utxo.script_pubkey, witness, flags)
2025-11-09T23:38:14.6535476Z                      } else {
2025-11-09T23:38:14.6536431Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mining.rs:440:
2025-11-09T23:38:14.6536722Z  }
2025-11-09T23:38:14.6536998Z  
2025-11-09T23:38:14.6537336Z  /// Simple SHA256 hash function
2025-11-09T23:38:14.6537617Z -/// 
2025-11-09T23:38:14.6537899Z +///
2025-11-09T23:38:14.6538745Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-09T23:38:14.6539485Z  /// for faster hashing in Merkle tree construction.
2025-11-09T23:38:14.6539797Z  #[inline(always)]
2025-11-09T23:38:14.6540857Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:239:
2025-11-09T23:38:14.6541539Z      /// - Small batches (< 4 items): Sequential (overhead not worth parallelization)
2025-11-09T23:38:14.6541977Z      /// - Medium batches (4-7 items): Chunked sequential
2025-11-09T23:38:14.6542882Z      /// - Large batches (≥8 items): Multi-core parallelization with Rayon
2025-11-09T23:38:14.6543177Z -    /// 
2025-11-09T23:38:14.6543468Z +    ///
2025-11-09T23:38:14.6543787Z      /// # Optimizations
2025-11-09T23:38:14.6544527Z      /// - Uses sha2 crate with "asm" feature for optimized assembly
2025-11-09T23:38:14.6545305Z      /// - For large batches, leverages Rayon for multi-core parallelization
2025-11-09T23:38:14.6546383Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:287:
2025-11-09T23:38:14.6548548Z                  return avx2_batch::batch_sha256_avx2(inputs);
2025-11-09T23:38:14.6548838Z              }
2025-11-09T23:38:14.6549122Z          }
2025-11-09T23:38:14.6549412Z -        
2025-11-09T23:38:14.6549696Z +
2025-11-09T23:38:14.6550157Z          // Fallback: Multi-core parallelization using Rayon
2025-11-09T23:38:14.6550593Z          // Rayon is enabled via the 'production' feature
2025-11-09T23:38:14.6551109Z          // This leverages multiple CPU cores for parallel hashing
2025-11-09T23:38:14.6552057Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:20:
2025-11-09T23:38:14.6552396Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6552752Z  use std::collections::VecDeque;
2025-11-09T23:38:14.6553089Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6553659Z -use std::sync::{OnceLock, RwLock, atomic::{AtomicBool, Ordering}};
2025-11-09T23:38:14.6553976Z +use std::sync::{
2025-11-09T23:38:14.6554500Z +    atomic::{AtomicBool, Ordering},
2025-11-09T23:38:14.6554814Z +    OnceLock, RwLock,
2025-11-09T23:38:14.6555101Z +};
2025-11-09T23:38:14.6555435Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6555754Z  use std::thread_local;
2025-11-09T23:38:14.6556035Z  
2025-11-09T23:38:14.6558772Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1044:
2025-11-09T23:38:14.6559274Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-09T23:38:14.6559891Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-09T23:38:14.6560258Z                          if tx.inputs.len() > 1 {
2025-11-09T23:38:14.6560967Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6561308Z +                            let sighashes =
2025-11-09T23:38:14.6561872Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6562246Z                              sighashes[input_index]
2025-11-09T23:38:14.6562556Z                          } else {
2025-11-09T23:38:14.6563081Z                              // Single input: use individual calculation (no overhead)
2025-11-09T23:38:14.6564060Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1051:
2025-11-09T23:38:14.6564956Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-09T23:38:14.6565348Z +                            calculate_transaction_sighash(
2025-11-09T23:38:14.6565669Z +                                tx,
2025-11-09T23:38:14.6566006Z +                                input_index,
2025-11-09T23:38:14.6566335Z +                                prevouts,
2025-11-09T23:38:14.6568424Z +                                SighashType::All,
2025-11-09T23:38:14.6568733Z +                            )?
2025-11-09T23:38:14.6569333Z                          }
2025-11-09T23:38:14.6569625Z                      }
2025-11-09T23:38:14.6570021Z                      #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.6570996Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1091:
2025-11-09T23:38:14.6571495Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-09T23:38:14.6572129Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-09T23:38:14.6572486Z                          if tx.inputs.len() > 1 {
2025-11-09T23:38:14.6573260Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6573612Z +                            let sighashes =
2025-11-09T23:38:14.6574170Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6574731Z                              sighashes[input_index]
2025-11-09T23:38:14.6575071Z                          } else {
2025-11-09T23:38:14.6575602Z                              // Single input: use individual calculation (no overhead)
2025-11-09T23:38:14.6576573Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1098:
2025-11-09T23:38:14.6578688Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-09T23:38:14.6579078Z +                            calculate_transaction_sighash(
2025-11-09T23:38:14.6579391Z +                                tx,
2025-11-09T23:38:14.6579724Z +                                input_index,
2025-11-09T23:38:14.6580460Z +                                prevouts,
2025-11-09T23:38:14.6580831Z +                                SighashType::All,
2025-11-09T23:38:14.6581495Z +                            )?
2025-11-09T23:38:14.6581796Z                          }
2025-11-09T23:38:14.6582093Z                      }
2025-11-09T23:38:14.6582479Z                      #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.6583484Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1474:
2025-11-09T23:38:14.6583808Z      clear_all_caches();
2025-11-09T23:38:14.6584122Z      clear_stack_pool();
2025-11-09T23:38:14.6584758Z      disable_caching(false); // Re-enable caching by default
2025-11-09T23:38:14.6585548Z -    // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-09T23:38:14.6586347Z +                            // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-09T23:38:14.6586697Z      #[cfg(feature = "benchmarking")]
2025-11-09T23:38:14.6587169Z      crate::transaction_hash::clear_sighash_templates();
2025-11-09T23:38:14.6587463Z  }
2025-11-09T23:38:14.6588394Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/types.rs:32:
2025-11-09T23:38:14.6588938Z  #[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize)]
2025-11-09T23:38:14.6589316Z  pub struct TransactionInput {
2025-11-09T23:38:14.6589893Z      pub prevout: OutPoint,      // Hot: 40 bytes (frequently accessed)
2025-11-09T23:38:14.6590521Z -    pub sequence: Natural,     // Hot: 8 bytes (frequently accessed)
2025-11-09T23:38:14.6591086Z +    pub sequence: Natural,      // Hot: 8 bytes (frequently accessed)
2025-11-09T23:38:14.6591765Z      pub script_sig: ByteString, // Cold: Vec (pointer, less frequently accessed)
2025-11-09T23:38:14.6592050Z  }
2025-11-09T23:38:14.6592326Z  
2025-11-09T23:38:14.7151731Z ##[error]Process completed with exit code 1.
