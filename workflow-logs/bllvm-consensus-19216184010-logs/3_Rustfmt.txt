2025-11-09T23:38:11.2862902Z Current runner version: '2.329.0'
2025-11-09T23:38:11.2871927Z Runner name: 'linode-runner-02'
2025-11-09T23:38:11.2873162Z Runner group name: 'default'
2025-11-09T23:38:11.2874628Z Machine name: 'localhost'
2025-11-09T23:38:11.2877772Z ##[group]GITHUB_TOKEN Permissions
2025-11-09T23:38:11.2880318Z Contents: read
2025-11-09T23:38:11.2880933Z Metadata: read
2025-11-09T23:38:11.2881601Z Packages: read
2025-11-09T23:38:11.2882149Z ##[endgroup]
2025-11-09T23:38:11.2884641Z Secret source: Actions
2025-11-09T23:38:11.2885387Z Prepare workflow directory
2025-11-09T23:38:11.3515658Z Prepare all required actions
2025-11-09T23:38:11.3562889Z Getting action download info
2025-11-09T23:38:11.6369819Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-11-09T23:38:12.0341329Z Download action repository 'dtolnay/rust-toolchain@master' (SHA:6d653acede28d24f02e3cd41383119e8b1b35921)
2025-11-09T23:38:12.4166436Z Complete job name: Rustfmt
2025-11-09T23:38:12.4825037Z A job started hook has been configured by the self-hosted runner administrator
2025-11-09T23:38:12.4997660Z ##[group]Run '/home/jswift/actions-runner-org2/cleanup-hooks/job-started.sh'
2025-11-09T23:38:12.5029406Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:12.5030682Z ##[endgroup]
2025-11-09T23:38:12.5236374Z Job started: Sun Nov  9 11:38:12 PM UTC 2025
2025-11-09T23:38:12.5254199Z Available disk space: 12G
2025-11-09T23:38:12.5296211Z Disk usage is 77% - no cleanup needed
2025-11-09T23:38:12.5599448Z ##[group]Run actions/checkout@v4
2025-11-09T23:38:12.5600204Z with:
2025-11-09T23:38:12.5600741Z   repository: BTCDecoded/bllvm-consensus
2025-11-09T23:38:12.5601793Z   token: ***
2025-11-09T23:38:12.5602311Z   ssh-strict: true
2025-11-09T23:38:12.5602855Z   ssh-user: git
2025-11-09T23:38:12.5603405Z   persist-credentials: true
2025-11-09T23:38:12.5604027Z   clean: true
2025-11-09T23:38:12.5604806Z   sparse-checkout-cone-mode: true
2025-11-09T23:38:12.5605522Z   fetch-depth: 1
2025-11-09T23:38:12.5606076Z   fetch-tags: false
2025-11-09T23:38:12.5606625Z   show-progress: true
2025-11-09T23:38:12.5607174Z   lfs: false
2025-11-09T23:38:12.5607666Z   submodules: false
2025-11-09T23:38:12.5608216Z   set-safe-directory: true
2025-11-09T23:38:12.5608902Z env:
2025-11-09T23:38:12.5609362Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:12.5609964Z ##[endgroup]
2025-11-09T23:38:12.6972736Z Syncing repository: BTCDecoded/bllvm-consensus
2025-11-09T23:38:12.6975444Z ##[group]Getting Git version info
2025-11-09T23:38:12.6976886Z Working directory is '/home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus'
2025-11-09T23:38:12.6978677Z [command]/usr/bin/git version
2025-11-09T23:38:12.6979333Z git version 2.43.0
2025-11-09T23:38:12.6990396Z ##[endgroup]
2025-11-09T23:38:12.7005262Z Copying '/home/jswift/.gitconfig' to '/home/jswift/actions-runner-org2/_work/_temp/06203bed-0c25-43e8-8f38-316041294d56/.gitconfig'
2025-11-09T23:38:12.7021022Z Temporarily overriding HOME='/home/jswift/actions-runner-org2/_work/_temp/06203bed-0c25-43e8-8f38-316041294d56' before making global git config changes
2025-11-09T23:38:12.7025292Z Adding repository directory to the temporary git global config as a safe directory
2025-11-09T23:38:12.7033618Z [command]/usr/bin/git config --global --add safe.directory /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus
2025-11-09T23:38:12.7083589Z [command]/usr/bin/git config --local --get remote.origin.url
2025-11-09T23:38:12.7112016Z https://github.com/BTCDecoded/bllvm-consensus
2025-11-09T23:38:12.7132695Z ##[group]Removing previously created refs, to avoid conflicts
2025-11-09T23:38:12.7139090Z [command]/usr/bin/git rev-parse --symbolic-full-name --verify --quiet HEAD
2025-11-09T23:38:12.7162822Z refs/heads/main
2025-11-09T23:38:12.7175700Z [command]/usr/bin/git checkout --detach
2025-11-09T23:38:12.7249630Z HEAD is now at ad63429 fix: Add missing crypto module declaration in lib.rs
2025-11-09T23:38:12.7304201Z [command]/usr/bin/git branch --delete --force main
2025-11-09T23:38:12.7339396Z Deleted branch main (was ad63429).
2025-11-09T23:38:12.7390506Z ##[endgroup]
2025-11-09T23:38:12.7392607Z [command]/usr/bin/git submodule status
2025-11-09T23:38:12.7675059Z ##[group]Cleaning the repository
2025-11-09T23:38:12.7682084Z [command]/usr/bin/git clean -ffdx
2025-11-09T23:38:12.7759597Z [command]/usr/bin/git reset --hard HEAD
2025-11-09T23:38:12.7853771Z HEAD is now at ad63429 fix: Add missing crypto module declaration in lib.rs
2025-11-09T23:38:12.7864619Z ##[endgroup]
2025-11-09T23:38:12.7866219Z ##[group]Disabling automatic garbage collection
2025-11-09T23:38:12.7868502Z [command]/usr/bin/git config --local gc.auto 0
2025-11-09T23:38:12.7902718Z ##[endgroup]
2025-11-09T23:38:12.7903622Z ##[group]Setting up auth
2025-11-09T23:38:12.7911496Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-11-09T23:38:12.7952439Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-11-09T23:38:12.8235493Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-11-09T23:38:12.8276721Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-11-09T23:38:12.8555163Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2025-11-09T23:38:12.8605980Z ##[endgroup]
2025-11-09T23:38:12.8607001Z ##[group]Fetching the repository
2025-11-09T23:38:12.8619277Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +ad634294ea6b2675c39337ed5ca3858e564b2e37:refs/remotes/origin/main
2025-11-09T23:38:13.0662283Z ##[endgroup]
2025-11-09T23:38:13.0663520Z ##[group]Determining the checkout info
2025-11-09T23:38:13.0667250Z ##[endgroup]
2025-11-09T23:38:13.0668451Z [command]/usr/bin/git sparse-checkout disable
2025-11-09T23:38:13.0748762Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2025-11-09T23:38:13.0786532Z ##[group]Checking out the ref
2025-11-09T23:38:13.0792187Z [command]/usr/bin/git checkout --progress --force -B main refs/remotes/origin/main
2025-11-09T23:38:13.0869900Z Switched to a new branch 'main'
2025-11-09T23:38:13.0871249Z branch 'main' set up to track 'origin/main'.
2025-11-09T23:38:13.0880038Z ##[endgroup]
2025-11-09T23:38:13.0921907Z [command]/usr/bin/git log -1 --format=%H
2025-11-09T23:38:13.0951956Z ad634294ea6b2675c39337ed5ca3858e564b2e37
2025-11-09T23:38:13.1422490Z ##[group]Run dtolnay/rust-toolchain@master
2025-11-09T23:38:13.1423654Z with:
2025-11-09T23:38:13.1424626Z   toolchain: 1.88.0
2025-11-09T23:38:13.1425520Z   components: rustfmt
2025-11-09T23:38:13.1426526Z env:
2025-11-09T23:38:13.1429364Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.1430419Z ##[endgroup]
2025-11-09T23:38:13.1590707Z ##[group]Run : parse toolchain version
2025-11-09T23:38:13.1591869Z [36;1m: parse toolchain version[0m
2025-11-09T23:38:13.1592913Z [36;1mif [[ -z $toolchain ]]; then[0m
2025-11-09T23:38:13.1594814Z [36;1m  # GitHub does not enforce `required: true` inputs itself. https://github.com/actions/runner/issues/1070[0m
2025-11-09T23:38:13.1597155Z [36;1m  echo "'toolchain' is a required input" >&2[0m
2025-11-09T23:38:13.1598294Z [36;1m  exit 1[0m
2025-11-09T23:38:13.1599491Z [36;1melif [[ $toolchain =~ ^stable' '[0-9]+' '(year|month|week|day)s?' 'ago$ ]]; then[0m
2025-11-09T23:38:13.1600959Z [36;1m  if [[ Linux == macOS ]]; then[0m
2025-11-09T23:38:13.1602768Z [36;1m    echo "toolchain=1.$((($(date -v-$(sed 's/stable \([0-9]*\) \(.\).*/\1\2/' <<< $toolchain) +%s)/60/60/24-16569)/7/6))" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1604675Z [36;1m  else[0m
2025-11-09T23:38:13.1606127Z [36;1m    echo "toolchain=1.$((($(date --date "${toolchain#stable }" +%s)/60/60/24-16569)/7/6))" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1608010Z [36;1m  fi[0m
2025-11-09T23:38:13.1609120Z [36;1melif [[ $toolchain =~ ^stable' 'minus' '[0-9]+' 'releases?$ ]]; then[0m
2025-11-09T23:38:13.1611001Z [36;1m  echo "toolchain=1.$((($(date +%s)/60/60/24-16569)/7/6-${toolchain//[^0-9]/}))" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1612652Z [36;1melif [[ $toolchain =~ ^1\.[0-9]+$ ]]; then[0m
2025-11-09T23:38:13.1614784Z [36;1m  echo "toolchain=1.$((i=${toolchain#1.}, c=($(date +%s)/60/60/24-16569)/7/6, i+9*i*(10*i<=c)+90*i*(100*i<=c)))" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1617096Z [36;1melse[0m
2025-11-09T23:38:13.1618053Z [36;1m  echo "toolchain=$toolchain" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1619196Z [36;1mfi[0m
2025-11-09T23:38:13.1647924Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.1649154Z env:
2025-11-09T23:38:13.1649895Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.1650787Z   toolchain: 1.88.0
2025-11-09T23:38:13.1651584Z ##[endgroup]
2025-11-09T23:38:13.1817808Z ##[group]Run : construct rustup command line
2025-11-09T23:38:13.1818990Z [36;1m: construct rustup command line[0m
2025-11-09T23:38:13.1820565Z [36;1mecho "targets=$(for t in ${targets//,/ }; do echo -n ' --target' $t; done)" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1822882Z [36;1mecho "components=$(for c in ${components//,/ }; do echo -n ' --component' $c; done)" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1824785Z [36;1mecho "downgrade=" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.1855965Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.1858535Z env:
2025-11-09T23:38:13.1859271Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.1860172Z   targets: 
2025-11-09T23:38:13.1860938Z   components: rustfmt
2025-11-09T23:38:13.1861771Z ##[endgroup]
2025-11-09T23:38:13.2014118Z ##[group]Run : set $CARGO_HOME
2025-11-09T23:38:13.2015374Z [36;1m: set $CARGO_HOME[0m
2025-11-09T23:38:13.2016557Z [36;1mecho CARGO_HOME=${CARGO_HOME:-"$HOME/.cargo"} >> $GITHUB_ENV[0m
2025-11-09T23:38:13.2045470Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.2048344Z env:
2025-11-09T23:38:13.2049065Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.2049909Z ##[endgroup]
2025-11-09T23:38:13.2169703Z ##[group]Run : install rustup if needed
2025-11-09T23:38:13.2170771Z [36;1m: install rustup if needed[0m
2025-11-09T23:38:13.2171827Z [36;1mif ! command -v rustup &>/dev/null; then[0m
2025-11-09T23:38:13.2176355Z [36;1m  curl --proto '=https' --tlsv1.2 --retry 10 --retry-connrefused --location --silent --show-error --fail https://sh.rustup.rs | sh -s -- --default-toolchain none -y[0m
2025-11-09T23:38:13.2179230Z [36;1m  echo "$CARGO_HOME/bin" >> $GITHUB_PATH[0m
2025-11-09T23:38:13.2180297Z [36;1mfi[0m
2025-11-09T23:38:13.2208326Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.2209521Z env:
2025-11-09T23:38:13.2210384Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.2211712Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.2212659Z ##[endgroup]
2025-11-09T23:38:13.2793616Z info: downloading installer
2025-11-09T23:38:13.4687969Z warn: It looks like you have an existing rustup settings file at:
2025-11-09T23:38:13.4690333Z warn: /home/jswift/.rustup/settings.toml
2025-11-09T23:38:13.4692523Z warn: Rustup will install the default toolchain as specified in the settings file,
2025-11-09T23:38:13.4695812Z warn: instead of the one inferred from the default host triple.
2025-11-09T23:38:13.4992127Z info: profile set to 'default'
2025-11-09T23:38:13.4993700Z 
2025-11-09T23:38:13.4995180Z info: default host triple is x86_64-unknown-linux-gnu
2025-11-09T23:38:13.4998178Z info: skipping toolchain installation
2025-11-09T23:38:13.4999876Z 
2025-11-09T23:38:13.5000771Z Rust is installed now. Great!
2025-11-09T23:38:13.5002166Z 
2025-11-09T23:38:13.5003345Z To get started you may need to restart your current shell.
2025-11-09T23:38:13.5005911Z This would reload your PATH environment variable to include
2025-11-09T23:38:13.5008073Z Cargo's bin directory ($HOME/.cargo/bin).
2025-11-09T23:38:13.5009504Z 
2025-11-09T23:38:13.5010297Z To configure your current shell, you need to source
2025-11-09T23:38:13.5012410Z the corresponding env file under $HOME/.cargo.
2025-11-09T23:38:13.5013932Z 
2025-11-09T23:38:13.5015315Z This is usually done by running one of the following (note the leading DOT):
2025-11-09T23:38:13.5019960Z . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
2025-11-09T23:38:13.5022054Z source "$HOME/.cargo/env.fish"  # For fish
2025-11-09T23:38:13.5023957Z source $"($nu.home-path)/.cargo/env.nu"  # For nushell
2025-11-09T23:38:13.5181090Z ##[group]Run rustup toolchain install 1.88.0 --component rustfmt --profile minimal --no-self-update
2025-11-09T23:38:13.5183369Z [36;1mrustup toolchain install 1.88.0 --component rustfmt --profile minimal --no-self-update[0m
2025-11-09T23:38:13.5222728Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.5224613Z env:
2025-11-09T23:38:13.5225614Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.5228298Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.5229218Z ##[endgroup]
2025-11-09T23:38:13.6174051Z info: syncing channel updates for '1.88.0-x86_64-unknown-linux-gnu'
2025-11-09T23:38:13.7443367Z info: latest update on 2025-06-26, rust version 1.88.0 (6b00bc388 2025-06-23)
2025-11-09T23:38:13.7803690Z info: component 'rustfmt' for target 'x86_64-unknown-linux-gnu' is up to date
2025-11-09T23:38:13.7842650Z 
2025-11-09T23:38:13.7971107Z   1.88.0-x86_64-unknown-linux-gnu unchanged - rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-09T23:38:13.7973065Z 
2025-11-09T23:38:13.8061340Z ##[group]Run rustup default 1.88.0
2025-11-09T23:38:13.8062339Z [36;1mrustup default 1.88.0[0m
2025-11-09T23:38:13.8097471Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.8098611Z env:
2025-11-09T23:38:13.8099285Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.8100133Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.8101007Z ##[endgroup]
2025-11-09T23:38:13.8241670Z info: using existing install for '1.88.0-x86_64-unknown-linux-gnu'
2025-11-09T23:38:13.8639104Z info: default toolchain set to '1.88.0-x86_64-unknown-linux-gnu'
2025-11-09T23:38:13.8640393Z 
2025-11-09T23:38:13.8766720Z   1.88.0-x86_64-unknown-linux-gnu unchanged - rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-09T23:38:13.8771645Z info: note that the toolchain '1.88.0-x86_64-unknown-linux-gnu' is currently in use (overridden by '/home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/rust-toolchain.toml')
2025-11-09T23:38:13.8774967Z 
2025-11-09T23:38:13.8852516Z ##[group]Run : create cachekey
2025-11-09T23:38:13.8853671Z [36;1m: create cachekey[0m
2025-11-09T23:38:13.8855632Z [36;1mDATE=$(rustc +1.88.0 --version --verbose | sed -ne 's/^commit-date: \(20[0-9][0-9]\)-\([01][0-9]\)-\([0-3][0-9]\)$/\1\2\3/p')[0m
2025-11-09T23:38:13.8858980Z [36;1mHASH=$(rustc +1.88.0 --version --verbose | sed -ne 's/^commit-hash: //p')[0m
2025-11-09T23:38:13.8860601Z [36;1mecho "cachekey=$(echo $DATE$HASH | head -c12)" >> $GITHUB_OUTPUT[0m
2025-11-09T23:38:13.8891264Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.8892403Z env:
2025-11-09T23:38:13.8893076Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.8893913Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.8895068Z ##[endgroup]
2025-11-09T23:38:13.9508930Z ##[group]Run : disable incremental compilation
2025-11-09T23:38:13.9512043Z [36;1m: disable incremental compilation[0m
2025-11-09T23:38:13.9532197Z [36;1mif [ -z "${CARGO_INCREMENTAL+set}" ]; then[0m
2025-11-09T23:38:13.9534226Z [36;1m  echo CARGO_INCREMENTAL=0 >> $GITHUB_ENV[0m
2025-11-09T23:38:13.9536430Z [36;1mfi[0m
2025-11-09T23:38:13.9570536Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.9571688Z env:
2025-11-09T23:38:13.9572359Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.9573209Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.9574072Z ##[endgroup]
2025-11-09T23:38:13.9683627Z ##[group]Run : enable colors in Cargo output
2025-11-09T23:38:13.9685225Z [36;1m: enable colors in Cargo output[0m
2025-11-09T23:38:13.9686305Z [36;1mif [ -z "${CARGO_TERM_COLOR+set}" ]; then[0m
2025-11-09T23:38:13.9687447Z [36;1m  echo CARGO_TERM_COLOR=always >> $GITHUB_ENV[0m
2025-11-09T23:38:13.9688454Z [36;1mfi[0m
2025-11-09T23:38:13.9716288Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.9718873Z env:
2025-11-09T23:38:13.9719529Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.9720368Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.9721264Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:13.9722016Z ##[endgroup]
2025-11-09T23:38:13.9835537Z ##[group]Run : enable Cargo sparse registry
2025-11-09T23:38:13.9836629Z [36;1m: enable Cargo sparse registry[0m
2025-11-09T23:38:13.9837878Z [36;1m# implemented in 1.66, stabilized in 1.68, made default in 1.70[0m
2025-11-09T23:38:13.9840413Z [36;1mif [ -z "${CARGO_REGISTRIES_CRATES_IO_PROTOCOL+set}" -o -f "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol ]; then[0m
2025-11-09T23:38:13.9843021Z [36;1m  if rustc +1.88.0 --version --verbose | grep -q '^release: 1\.6[89]\.'; then[0m
2025-11-09T23:38:13.9845563Z [36;1m    touch "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol || true[0m
2025-11-09T23:38:13.9849251Z [36;1m    echo CARGO_REGISTRIES_CRATES_IO_PROTOCOL=sparse >> $GITHUB_ENV[0m
2025-11-09T23:38:13.9850868Z [36;1m  elif rustc +1.88.0 --version --verbose | grep -q '^release: 1\.6[67]\.'; then[0m
2025-11-09T23:38:13.9852999Z [36;1m    touch "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol || true[0m
2025-11-09T23:38:13.9855263Z [36;1m    echo CARGO_REGISTRIES_CRATES_IO_PROTOCOL=git >> $GITHUB_ENV[0m
2025-11-09T23:38:13.9856466Z [36;1m  fi[0m
2025-11-09T23:38:13.9858911Z [36;1mfi[0m
2025-11-09T23:38:13.9885763Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:13.9886876Z env:
2025-11-09T23:38:13.9887551Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:13.9888406Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:13.9889301Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:13.9890054Z ##[endgroup]
2025-11-09T23:38:14.0415604Z ##[group]Run : work around spurious network errors in curl 8.0
2025-11-09T23:38:14.0416964Z [36;1m: work around spurious network errors in curl 8.0[0m
2025-11-09T23:38:14.0418746Z [36;1m# https://rust-lang.zulipchat.com/#narrow/stream/246057-t-cargo/topic/timeout.20investigation[0m
2025-11-09T23:38:14.0420743Z [36;1mif rustc +1.88.0 --version --verbose | grep -q '^release: 1\.7[01]\.'; then[0m
2025-11-09T23:38:14.0422476Z [36;1m  echo CARGO_HTTP_MULTIPLEXING=false >> $GITHUB_ENV[0m
2025-11-09T23:38:14.0423572Z [36;1mfi[0m
2025-11-09T23:38:14.0455864Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:14.0456987Z env:
2025-11-09T23:38:14.0457660Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:14.0458502Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:14.0459417Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:14.0461926Z ##[endgroup]
2025-11-09T23:38:14.0769747Z ##[group]Run rustc +1.88.0 --version --verbose
2025-11-09T23:38:14.0770851Z [36;1mrustc +1.88.0 --version --verbose[0m
2025-11-09T23:38:14.0802233Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:14.0803354Z env:
2025-11-09T23:38:14.0804027Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:14.0805174Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:14.0806077Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:14.0806837Z ##[endgroup]
2025-11-09T23:38:14.1035367Z rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-09T23:38:14.1038786Z binary: rustc
2025-11-09T23:38:14.1040306Z commit-hash: 6b00bc3880198600130e1cf62b8f8a93494488cc
2025-11-09T23:38:14.1042345Z commit-date: 2025-06-23
2025-11-09T23:38:14.1043787Z host: x86_64-unknown-linux-gnu
2025-11-09T23:38:14.1045341Z release: 1.88.0
2025-11-09T23:38:14.1046557Z LLVM version: 20.1.5
2025-11-09T23:38:14.1156936Z ##[group]Run cargo fmt -- --check
2025-11-09T23:38:14.1158153Z [36;1mcargo fmt -- --check[0m
2025-11-09T23:38:14.1192830Z shell: /usr/bin/bash -e {0}
2025-11-09T23:38:14.1193690Z env:
2025-11-09T23:38:14.1194590Z   CARGO_TERM_COLOR: always
2025-11-09T23:38:14.1195493Z   CARGO_HOME: /home/jswift/.cargo
2025-11-09T23:38:14.1196404Z   CARGO_INCREMENTAL: 0
2025-11-09T23:38:14.1198942Z ##[endgroup]
2025-11-09T23:38:14.3167812Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:4:
2025-11-09T23:38:14.3178116Z  use consensus_proof::block::connect_block;
2025-11-09T23:38:14.3180222Z  use consensus_proof::segwit::Witness;
2025-11-09T23:38:14.3181935Z  use consensus_proof::{
2025-11-09T23:38:14.3184597Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet,
2025-11-09T23:38:14.3188498Z +    Block, BlockHeader, OutPoint, Transaction, TransactionInput, TransactionOutput, UtxoSet,
2025-11-09T23:38:14.3191365Z  };
2025-11-09T23:38:14.3193204Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-09T23:38:14.3195631Z  
2025-11-09T23:38:14.3198567Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:23:
2025-11-09T23:38:14.3202100Z              sequence: 0xffffffff,
2025-11-09T23:38:14.3203620Z          }],
2025-11-09T23:38:14.3205064Z          outputs: vec![TransactionOutput {
2025-11-09T23:38:14.3206884Z -            value: 50_000_000_000, // 50 BTC
2025-11-09T23:38:14.3208580Z +            value: 50_000_000_000,     // 50 BTC
2025-11-09T23:38:14.3210350Z              script_pubkey: vec![0x51], // OP_1
2025-11-09T23:38:14.3211992Z          }],
2025-11-09T23:38:14.3213377Z          lock_time: 0,
2025-11-09T23:38:14.3216643Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:44:
2025-11-09T23:38:14.3220119Z              }],
2025-11-09T23:38:14.3221400Z              outputs: vec![
2025-11-09T23:38:14.3222900Z                  TransactionOutput {
2025-11-09T23:38:14.3224760Z -                    value: 10_000_000, // 0.1 BTC
2025-11-09T23:38:14.3226567Z +                    value: 10_000_000,             // 0.1 BTC
2025-11-09T23:38:14.3228545Z                      script_pubkey: vec![0x51; 25], // Longer script
2025-11-09T23:38:14.3230422Z                  },
2025-11-09T23:38:14.3231751Z                  TransactionOutput {
2025-11-09T23:38:14.3235345Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:113:
2025-11-09T23:38:14.3238952Z      benchmark_connect_block_realistic_1000tx
2025-11-09T23:38:14.3241237Z  );
2025-11-09T23:38:14.3242484Z  criterion_main!(benches);
2025-11-09T23:38:14.3243925Z -
2025-11-09T23:38:14.3245168Z  
2025-11-09T23:38:14.3330153Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:1:
2025-11-09T23:38:14.3333407Z +use bllvm_consensus::crypto::OptimizedSha256;
2025-11-09T23:38:14.3335610Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-09T23:38:14.3339118Z  use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3397599Z -use bllvm_consensus::crypto::OptimizedSha256;
2025-11-09T23:38:14.3398854Z  
2025-11-09T23:38:14.3399601Z  fn benchmark_sha256(c: &mut Criterion) {
2025-11-09T23:38:14.3400624Z      let data = vec![0u8; 1024];
2025-11-09T23:38:14.3402411Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:29:
2025-11-09T23:38:14.3404425Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.3405425Z  fn benchmark_sha_ni_single(c: &mut Criterion) {
2025-11-09T23:38:14.3406554Z      use bllvm_consensus::crypto::sha_ni;
2025-11-09T23:38:14.3407983Z -    
2025-11-09T23:38:14.3409119Z +
2025-11-09T23:38:14.3410347Z      if !sha_ni::is_sha_ni_available() {
2025-11-09T23:38:14.3412090Z          return; // Skip on CPUs without SHA-NI
2025-11-09T23:38:14.3413695Z      }
2025-11-09T23:38:14.3415756Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:36:
2025-11-09T23:38:14.3417567Z -    
2025-11-09T23:38:14.3418215Z +
2025-11-09T23:38:14.3418901Z      let data_32b = vec![0u8; 32];
2025-11-09T23:38:14.3419821Z      let data_64b = vec![0u8; 64];
2025-11-09T23:38:14.3420740Z      let data_1kb = vec![0u8; 1024];
2025-11-09T23:38:14.3422518Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:40:
2025-11-09T23:38:14.3424529Z -    
2025-11-09T23:38:14.3425314Z +
2025-11-09T23:38:14.3426069Z      // 32-byte input (typical transaction hash)
2025-11-09T23:38:14.3427142Z      c.bench_function("sha_ni_32b", |b| {
2025-11-09T23:38:14.3428795Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_32b))))
2025-11-09T23:38:14.3430828Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:44:
2025-11-09T23:38:14.3432665Z      });
2025-11-09T23:38:14.3433331Z -    
2025-11-09T23:38:14.3434187Z +
2025-11-09T23:38:14.3435359Z      c.bench_function("sha2_crate_32b", |b| {
2025-11-09T23:38:14.3436345Z          b.iter(|| {
2025-11-09T23:38:14.3437247Z              let hash = Sha256::digest(black_box(&data_32b));
2025-11-09T23:38:14.3439170Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:49:
2025-11-09T23:38:14.3440997Z              black_box(hash)
2025-11-09T23:38:14.3441813Z          })
2025-11-09T23:38:14.3442465Z      });
2025-11-09T23:38:14.3443102Z -    
2025-11-09T23:38:14.3443738Z +
2025-11-09T23:38:14.3447085Z      // 64-byte input (typical block header)
2025-11-09T23:38:14.3448172Z      c.bench_function("sha_ni_64b", |b| {
2025-11-09T23:38:14.3449339Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_64b))))
2025-11-09T23:38:14.3451367Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:56:
2025-11-09T23:38:14.3453187Z      });
2025-11-09T23:38:14.3453834Z -    
2025-11-09T23:38:14.3455041Z +
2025-11-09T23:38:14.3457691Z      c.bench_function("sha2_crate_64b", |b| {
2025-11-09T23:38:14.3458929Z          b.iter(|| {
2025-11-09T23:38:14.3460161Z              let hash = Sha256::digest(black_box(&data_64b));
2025-11-09T23:38:14.3462089Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:61:
2025-11-09T23:38:14.3463922Z              black_box(hash)
2025-11-09T23:38:14.3465120Z          })
2025-11-09T23:38:14.3465799Z      });
2025-11-09T23:38:14.3466436Z -    
2025-11-09T23:38:14.3467083Z +
2025-11-09T23:38:14.3467932Z      // 1KB input
2025-11-09T23:38:14.3468964Z      c.bench_function("sha_ni_1kb", |b| {
2025-11-09T23:38:14.3470150Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_1kb))))
2025-11-09T23:38:14.3472170Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:68:
2025-11-09T23:38:14.3473960Z      });
2025-11-09T23:38:14.3474827Z -    
2025-11-09T23:38:14.3475476Z +
2025-11-09T23:38:14.3476152Z      // Double SHA256 comparison
2025-11-09T23:38:14.3478853Z      c.bench_function("sha_ni_double_32b", |b| {
2025-11-09T23:38:14.3480072Z          b.iter(|| black_box(sha_ni::hash256(black_box(&data_32b))))
2025-11-09T23:38:14.3482078Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:73:
2025-11-09T23:38:14.3483860Z      });
2025-11-09T23:38:14.3484635Z -    
2025-11-09T23:38:14.3485289Z +
2025-11-09T23:38:14.3486060Z      c.bench_function("sha2_crate_double_32b", |b| {
2025-11-09T23:38:14.3487100Z          b.iter(|| {
2025-11-09T23:38:14.3487993Z              let hash1 = Sha256::digest(black_box(&data_32b));
2025-11-09T23:38:14.3491609Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:194:
2025-11-09T23:38:14.3493474Z  
2025-11-09T23:38:14.3494577Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3495781Z  fn benchmark_merkle_root_batching(c: &mut Criterion) {
2025-11-09T23:38:14.3497029Z -use bllvm_consensus::mining::calculate_merkle_root;
2025-11-09T23:38:14.3498614Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3500237Z +    use bllvm_consensus::mining::calculate_merkle_root;
2025-11-09T23:38:14.3501816Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3503240Z  
2025-11-09T23:38:14.3503932Z      let tx_counts = vec![10, 100, 1000];
2025-11-09T23:38:14.3505043Z  
2025-11-09T23:38:14.3506578Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:232:
2025-11-09T23:38:14.3509386Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3510467Z  fn benchmark_block_validation_tx_ids(c: &mut Criterion) {
2025-11-09T23:38:14.3511809Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-09T23:38:14.3513675Z -use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3515948Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3519044Z +    use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3520867Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-09T23:38:14.3522710Z  
2025-11-09T23:38:14.3523487Z      let tx_counts = vec![10, 100];
2025-11-09T23:38:14.3524641Z  
2025-11-09T23:38:14.3526198Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:539:
2025-11-09T23:38:14.3528027Z  );
2025-11-09T23:38:14.3530949Z  
2025-11-09T23:38:14.3531645Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.3533221Z -criterion_group!(benches, benchmark_sha256, benchmark_double_sha256, benchmark_sha_ni_single);
2025-11-09T23:38:14.3534939Z +criterion_group!(
2025-11-09T23:38:14.3535686Z +    benches,
2025-11-09T23:38:14.3536404Z +    benchmark_sha256,
2025-11-09T23:38:14.3537205Z +    benchmark_double_sha256,
2025-11-09T23:38:14.3538092Z +    benchmark_sha_ni_single
2025-11-09T23:38:14.3538903Z +);
2025-11-09T23:38:14.3539532Z  
2025-11-09T23:38:14.3540188Z  criterion_main!(benches);
2025-11-09T23:38:14.3540992Z  
2025-11-09T23:38:14.3542870Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:11:
2025-11-09T23:38:14.3545142Z  //!
2025-11-09T23:38:14.3546170Z  //! Run with: cargo bench --bench performance_focused --features production
2025-11-09T23:38:14.3548980Z  
2025-11-09T23:38:14.3550135Z -use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-09T23:38:14.3551587Z  use bllvm_consensus::{
2025-11-09T23:38:14.3553044Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet, UTXO,
2025-11-09T23:38:14.3554817Z -    block::connect_block,
2025-11-09T23:38:14.3555665Z -    segwit::Witness,
2025-11-09T23:38:14.3556894Z +    block::connect_block, segwit::Witness, Block, BlockHeader, OutPoint, Transaction,
2025-11-09T23:38:14.3558482Z +    TransactionInput, TransactionOutput, UtxoSet, UTXO,
2025-11-09T23:38:14.3559566Z  };
2025-11-09T23:38:14.3560694Z +use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-09T23:38:14.3562098Z  
2025-11-09T23:38:14.3563141Z  // ============================================================================
2025-11-09T23:38:14.3564719Z  // CRYPTOGRAPHIC OPERATIONS (SHA-NI + AVX2)
2025-11-09T23:38:14.3566717Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:23:
2025-11-09T23:38:14.3568639Z  // ============================================================================
2025-11-09T23:38:14.3569627Z  
2025-11-09T23:38:14.3570340Z  fn bench_hash_single(c: &mut Criterion) {
2025-11-09T23:38:14.3571687Z -    let data_32b = vec![0u8; 32];  // Transaction hash size
2025-11-09T23:38:14.3573027Z -    let data_64b = vec![0u8; 64];  // Block header size
2025-11-09T23:38:14.3574054Z -    
2025-11-09T23:38:14.3576805Z +    let data_32b = vec![0u8; 32]; // Transaction hash size
2025-11-09T23:38:14.3577997Z +    let data_64b = vec![0u8; 64]; // Block header size
2025-11-09T23:38:14.3578996Z +
2025-11-09T23:38:14.3579780Z      let mut group = c.benchmark_group("hash_single");
2025-11-09T23:38:14.3580800Z -    
2025-11-09T23:38:14.3581438Z +
2025-11-09T23:38:14.3582241Z      // Single SHA256 - 32 bytes (typical transaction hash)
2025-11-09T23:38:14.3583404Z      group.bench_function("sha256_32b", |b| {
2025-11-09T23:38:14.3584552Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3586377Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:36:
2025-11-09T23:38:14.3588968Z              black_box(hash)
2025-11-09T23:38:14.3589768Z          })
2025-11-09T23:38:14.3590431Z      });
2025-11-09T23:38:14.3591072Z -    
2025-11-09T23:38:14.3591718Z +
2025-11-09T23:38:14.3592444Z      // Double SHA256 - 32 bytes (Bitcoin standard)
2025-11-09T23:38:14.3593590Z      group.bench_function("double_sha256_32b", |b| {
2025-11-09T23:38:14.3594779Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3596584Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:46:
2025-11-09T23:38:14.3598446Z              black_box(hash2)
2025-11-09T23:38:14.3600755Z          })
2025-11-09T23:38:14.3601409Z      });
2025-11-09T23:38:14.3602051Z -    
2025-11-09T23:38:14.3602689Z +
2025-11-09T23:38:14.3603357Z      // Block header hash - 64 bytes
2025-11-09T23:38:14.3604507Z      group.bench_function("double_sha256_64b", |b| {
2025-11-09T23:38:14.3605609Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.3607414Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:56:
2025-11-09T23:38:14.3609551Z              black_box(hash2)
2025-11-09T23:38:14.3611207Z          })
2025-11-09T23:38:14.3611880Z      });
2025-11-09T23:38:14.3612516Z -    
2025-11-09T23:38:14.3613415Z +
2025-11-09T23:38:14.3614062Z      group.finish();
2025-11-09T23:38:14.3614925Z  }
2025-11-09T23:38:14.3615550Z  
2025-11-09T23:38:14.3617086Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:63:
2025-11-09T23:38:14.3618957Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.3619876Z  fn bench_hash_batch(c: &mut Criterion) {
2025-11-09T23:38:14.3621045Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-09T23:38:14.3622576Z -    
2025-11-09T23:38:14.3623229Z +
2025-11-09T23:38:14.3623896Z      let data = vec![0u8; 64];
2025-11-09T23:38:14.3625027Z      let mut group = c.benchmark_group("hash_batch");
2025-11-09T23:38:14.3626355Z -    
2025-11-09T23:38:14.3626987Z +
2025-11-09T23:38:14.3627696Z      // Batch sizes that matter in real blocks
2025-11-09T23:38:14.3628716Z      for size in [8, 16, 32, 64, 128].iter() {
2025-11-09T23:38:14.3631926Z          let inputs: Vec<&[u8]> = vec![data.as_slice(); *size];
2025-11-09T23:38:14.3633907Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:73:
2025-11-09T23:38:14.3635878Z -        
2025-11-09T23:38:14.3637049Z -        group.bench_with_input(BenchmarkId::new("avx2_double_sha256", size), size, |b, _| {
2025-11-09T23:38:14.3639159Z -            b.iter(|| {
2025-11-09T23:38:14.3640310Z -                black_box(simd_vectorization::batch_double_sha256(black_box(&inputs)))
2025-11-09T23:38:14.3641889Z -            })
2025-11-09T23:38:14.3642591Z -        });
2025-11-09T23:38:14.3643257Z +
2025-11-09T23:38:14.3643932Z +        group.bench_with_input(
2025-11-09T23:38:14.3645044Z +            BenchmarkId::new("avx2_double_sha256", size),
2025-11-09T23:38:14.3646067Z +            size,
2025-11-09T23:38:14.3646769Z +            |b, _| {
2025-11-09T23:38:14.3648200Z +                b.iter(|| black_box(simd_vectorization::batch_double_sha256(black_box(&inputs))))
2025-11-09T23:38:14.3649766Z +            },
2025-11-09T23:38:14.3650487Z +        );
2025-11-09T23:38:14.3651166Z      }
2025-11-09T23:38:14.3651820Z -    
2025-11-09T23:38:14.3652481Z +
2025-11-09T23:38:14.3653152Z      group.finish();
2025-11-09T23:38:14.3653961Z  }
2025-11-09T23:38:14.3654740Z  
2025-11-09T23:38:14.3656337Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:100:
2025-11-09T23:38:14.3658239Z              sequence: 0xffffffff,
2025-11-09T23:38:14.3659132Z          }],
2025-11-09T23:38:14.3659913Z          outputs: vec![TransactionOutput {
2025-11-09T23:38:14.3660927Z -            value: 1_000_000, // 0.01 BTC
2025-11-09T23:38:14.3661920Z +            value: 1_000_000,          // 0.01 BTC
2025-11-09T23:38:14.3662960Z              script_pubkey: vec![0x51], // OP_1
2025-11-09T23:38:14.3663933Z          }],
2025-11-09T23:38:14.3664839Z          lock_time: 0,
2025-11-09T23:38:14.3666560Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:109:
2025-11-09T23:38:14.3668418Z  
2025-11-09T23:38:14.3669209Z  fn bench_transaction_basics(c: &mut Criterion) {
2025-11-09T23:38:14.3670400Z      let tx = create_simple_transaction();
2025-11-09T23:38:14.3671365Z -    
2025-11-09T23:38:14.3672036Z +
2025-11-09T23:38:14.3672839Z      let mut group = c.benchmark_group("transaction");
2025-11-09T23:38:14.3673894Z -    
2025-11-09T23:38:14.3674674Z +
2025-11-09T23:38:14.3675593Z      // Transaction serialization (needed for tx ID calculation)
2025-11-09T23:38:14.3678201Z      group.bench_function("serialize", |b| {
2025-11-09T23:38:14.3679593Z          use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.3681834Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:118:
2025-11-09T23:38:14.3683706Z -        b.iter(|| {
2025-11-09T23:38:14.3684760Z -            black_box(serialize_transaction(black_box(&tx)))
2025-11-09T23:38:14.3685850Z -        })
2025-11-09T23:38:14.3686768Z +        b.iter(|| black_box(serialize_transaction(black_box(&tx))))
2025-11-09T23:38:14.3687908Z      });
2025-11-09T23:38:14.3688583Z -    
2025-11-09T23:38:14.3689241Z +
2025-11-09T23:38:14.3690108Z      // Transaction ID calculation (SHA256D of serialized tx)
2025-11-09T23:38:14.3691336Z      group.bench_function("calculate_id", |b| {
2025-11-09T23:38:14.3692477Z          use bllvm_consensus::block::calculate_tx_id;
2025-11-09T23:38:14.3694548Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:126:
2025-11-09T23:38:14.3696425Z -        b.iter(|| {
2025-11-09T23:38:14.3698810Z -            black_box(calculate_tx_id(black_box(&tx)))
2025-11-09T23:38:14.3699827Z -        })
2025-11-09T23:38:14.3700675Z +        b.iter(|| black_box(calculate_tx_id(black_box(&tx))))
2025-11-09T23:38:14.3701758Z      });
2025-11-09T23:38:14.3702424Z -    
2025-11-09T23:38:14.3703085Z +
2025-11-09T23:38:14.3703759Z      group.finish();
2025-11-09T23:38:14.3704636Z  }
2025-11-09T23:38:14.3705287Z  
2025-11-09T23:38:14.3706879Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:153:
2025-11-09T23:38:14.3708799Z                  script_pubkey: vec![0x51],
2025-11-09T23:38:14.3709751Z              }],
2025-11-09T23:38:14.3710491Z              lock_time: 0,
2025-11-09T23:38:14.3711309Z -        }
2025-11-09T23:38:14.3711990Z +        },
2025-11-09T23:38:14.3712877Z      ];
2025-11-09T23:38:14.3713543Z -    
2025-11-09T23:38:14.3714202Z +
2025-11-09T23:38:14.3715061Z      // Regular transactions
2025-11-09T23:38:14.3715943Z      for i in 0..num_txs {
2025-11-09T23:38:14.3716841Z          transactions.push(Transaction {
2025-11-09T23:38:14.3718737Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:181:
2025-11-09T23:38:14.3720821Z              lock_time: 0,
2025-11-09T23:38:14.3721772Z          });
2025-11-09T23:38:14.3722468Z      }
2025-11-09T23:38:14.3723121Z -    
2025-11-09T23:38:14.3723792Z +
2025-11-09T23:38:14.3724574Z      Block {
2025-11-09T23:38:14.3725329Z          header: BlockHeader {
2025-11-09T23:38:14.3726211Z              version: 1,
2025-11-09T23:38:14.3727939Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:198:
2025-11-09T23:38:14.3730390Z  fn bench_block_validation(c: &mut Criterion) {
2025-11-09T23:38:14.3731609Z      let mut group = c.benchmark_group("block_validation");
2025-11-09T23:38:14.3732987Z      group.sample_size(10); // Fewer samples for longer benchmarks
2025-11-09T23:38:14.3734157Z -    
2025-11-09T23:38:14.3735104Z +
2025-11-09T23:38:14.3736162Z      // Small block (10 txs) - typical for quick blocks
2025-11-09T23:38:14.3737329Z      let block_10 = create_realistic_block(10);
2025-11-09T23:38:14.3739252Z      let witnesses_10: Vec<Witness> = block_10.transactions.iter().map(|_| Vec::new()).collect();
2025-11-09T23:38:14.3741905Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:205:
2025-11-09T23:38:14.3743771Z -    
2025-11-09T23:38:14.3744573Z +
2025-11-09T23:38:14.3745305Z      group.bench_function("10_txs", |b| {
2025-11-09T23:38:14.3746288Z          b.iter(|| {
2025-11-09T23:38:14.3748875Z              let utxo_set = UtxoSet::new();
2025-11-09T23:38:14.3750752Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:215:
2025-11-09T23:38:14.3752605Z              );
2025-11-09T23:38:14.3753314Z          })
2025-11-09T23:38:14.3753999Z      });
2025-11-09T23:38:14.3754839Z -    
2025-11-09T23:38:14.3755502Z +
2025-11-09T23:38:14.3756295Z      // Medium block (100 txs) - typical average block
2025-11-09T23:38:14.3759227Z      let block_100 = create_realistic_block(100);
2025-11-09T23:38:14.3760842Z      let witnesses_100: Vec<Witness> = block_100.transactions.iter().map(|_| Vec::new()).collect();
2025-11-09T23:38:14.3763483Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:222:
2025-11-09T23:38:14.3765497Z -    
2025-11-09T23:38:14.3766166Z +
2025-11-09T23:38:14.3766902Z      group.bench_function("100_txs", |b| {
2025-11-09T23:38:14.3767884Z          b.iter(|| {
2025-11-09T23:38:14.3768716Z              let utxo_set = UtxoSet::new();
2025-11-09T23:38:14.3771825Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:232:
2025-11-09T23:38:14.3773680Z              );
2025-11-09T23:38:14.3774547Z          })
2025-11-09T23:38:14.3775227Z      });
2025-11-09T23:38:14.3775891Z -    
2025-11-09T23:38:14.3776545Z +
2025-11-09T23:38:14.3777217Z      group.finish();
2025-11-09T23:38:14.3779439Z  }
2025-11-09T23:38:14.3780095Z  
2025-11-09T23:38:14.3781685Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:242:
2025-11-09T23:38:14.3783559Z  
2025-11-09T23:38:14.3784868Z  fn bench_utxo_operations(c: &mut Criterion) {
2025-11-09T23:38:14.3785960Z      use std::collections::HashMap;
2025-11-09T23:38:14.3786870Z -    
2025-11-09T23:38:14.3787531Z +
2025-11-09T23:38:14.3788298Z      let mut utxo_set: UtxoSet = HashMap::new();
2025-11-09T23:38:14.3789355Z      let outpoint = OutPoint {
2025-11-09T23:38:14.3790241Z          hash: [1; 32],
2025-11-09T23:38:14.3791948Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:253:
2025-11-09T23:38:14.3793861Z          script_pubkey: vec![0x51],
2025-11-09T23:38:14.3794914Z          height: 0,
2025-11-09T23:38:14.3795657Z      };
2025-11-09T23:38:14.3796319Z -    
2025-11-09T23:38:14.3796979Z +
2025-11-09T23:38:14.3797739Z      let mut group = c.benchmark_group("utxo");
2025-11-09T23:38:14.3798731Z -    
2025-11-09T23:38:14.3799390Z +
2025-11-09T23:38:14.3800278Z      // Insert UTXO
2025-11-09T23:38:14.3801235Z      group.bench_function("insert", |b| {
2025-11-09T23:38:14.3802209Z          b.iter(|| {
2025-11-09T23:38:14.3804160Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:264:
2025-11-09T23:38:14.3806273Z              black_box(set)
2025-11-09T23:38:14.3807086Z          })
2025-11-09T23:38:14.3807764Z      });
2025-11-09T23:38:14.3808422Z -    
2025-11-09T23:38:14.3809079Z +
2025-11-09T23:38:14.3809739Z      // Lookup UTXO
2025-11-09T23:38:14.3810631Z      utxo_set.insert(outpoint.clone(), utxo.clone());
2025-11-09T23:38:14.3811752Z      group.bench_function("get", |b| {
2025-11-09T23:38:14.3813804Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:271:
2025-11-09T23:38:14.3815819Z -        b.iter(|| {
2025-11-09T23:38:14.3816733Z -            black_box(utxo_set.get(black_box(&outpoint)))
2025-11-09T23:38:14.3817797Z -        })
2025-11-09T23:38:14.3818711Z +        b.iter(|| black_box(utxo_set.get(black_box(&outpoint))))
2025-11-09T23:38:14.3819835Z      });
2025-11-09T23:38:14.3820491Z -    
2025-11-09T23:38:14.3821156Z +
2025-11-09T23:38:14.3821808Z      // Remove UTXO
2025-11-09T23:38:14.3823961Z      group.bench_function("remove", |b| {
2025-11-09T23:38:14.3825094Z          b.iter(|| {
2025-11-09T23:38:14.3826777Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:280:
2025-11-09T23:38:14.3828768Z              black_box(set.remove(black_box(&outpoint)))
2025-11-09T23:38:14.3829804Z          })
2025-11-09T23:38:14.3832018Z      });
2025-11-09T23:38:14.3832705Z -    
2025-11-09T23:38:14.3833367Z +
2025-11-09T23:38:14.3834043Z      group.finish();
2025-11-09T23:38:14.3834982Z  }
2025-11-09T23:38:14.3835633Z  
2025-11-09T23:38:14.3837237Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:318:
2025-11-09T23:38:14.3839117Z      block_benches,
2025-11-09T23:38:14.3839890Z      utxo_benches
2025-11-09T23:38:14.3840608Z  );
2025-11-09T23:38:14.3841262Z -
2025-11-09T23:38:14.3841906Z  
2025-11-09T23:38:14.3843595Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/examples/cpu_features.rs:3:
2025-11-09T23:38:14.3845784Z      {
2025-11-09T23:38:14.3846557Z          println!("CPU Feature Detection:");
2025-11-09T23:38:14.3849484Z          println!("  AVX2: {}", std::arch::is_x86_feature_detected!("avx2"));
2025-11-09T23:38:14.3851253Z -        println!("  SSE4.1: {}", std::arch::is_x86_feature_detected!("sse4.1"));
2025-11-09T23:38:14.3852519Z +        println!(
2025-11-09T23:38:14.3853286Z +            "  SSE4.1: {}",
2025-11-09T23:38:14.3854259Z +            std::arch::is_x86_feature_detected!("sse4.1")
2025-11-09T23:38:14.3855452Z +        );
2025-11-09T23:38:14.3856425Z          println!("  SHA-NI: {}", std::arch::is_x86_feature_detected!("sha"));
2025-11-09T23:38:14.3859686Z          println!("  AVX: {}", std::arch::is_x86_feature_detected!("avx"));
2025-11-09T23:38:14.3860865Z      }
2025-11-09T23:38:14.4585649Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:58:
2025-11-09T23:38:14.4588825Z              return override_val;
2025-11-09T23:38:14.4590381Z          }
2025-11-09T23:38:14.4591637Z      }
2025-11-09T23:38:14.4592784Z -    
2025-11-09T23:38:14.4593918Z +
2025-11-09T23:38:14.4595791Z      // Load from environment variable (supports config files via std::env)
2025-11-09T23:38:14.4597616Z      // Default to 0 (validate all blocks) for maximum safety
2025-11-09T23:38:14.4598973Z      std::env::var("ASSUME_VALID_HEIGHT")
2025-11-09T23:38:14.4601474Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:199:
2025-11-09T23:38:14.4603379Z              .collect();
2025-11-09T23:38:14.4604169Z  
2025-11-09T23:38:14.4605476Z          // Batch UTXO lookup for all transactions (single pass through HashMap)
2025-11-09T23:38:14.4608053Z -        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> = 
2025-11-09T23:38:14.4610144Z +        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> =
2025-11-09T23:38:14.4611622Z              std::collections::HashMap::with_capacity(all_prevouts.len());
2025-11-09T23:38:14.4613070Z          for prevout in &all_prevouts {
2025-11-09T23:38:14.4614174Z              if let Some(utxo) = utxo_set.get(prevout) {
2025-11-09T23:38:14.4630601Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:297:
2025-11-09T23:38:14.4632507Z                          let input_utxos: Vec<(usize, Option<&ByteString>)> = {
2025-11-09T23:38:14.4633865Z                              let mut result = Vec::with_capacity(tx.inputs.len());
2025-11-09T23:38:14.4637402Z                              for (j, input) in tx.inputs.iter().enumerate() {
2025-11-09T23:38:14.4638921Z -                                result.push((j, utxo_set.get(&input.prevout).map(|u| &u.script_pubkey)));
2025-11-09T23:38:14.4640284Z +                                result.push((
2025-11-09T23:38:14.4641281Z +                                    j,
2025-11-09T23:38:14.4642425Z +                                    utxo_set.get(&input.prevout).map(|u| &u.script_pubkey),
2025-11-09T23:38:14.4643581Z +                                ));
2025-11-09T23:38:14.4644700Z                              }
2025-11-09T23:38:14.4645563Z                              result
2025-11-09T23:38:14.4646439Z                          };
2025-11-09T23:38:14.4647878Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:365:
2025-11-09T23:38:14.4650352Z  
2025-11-09T23:38:14.4651030Z                  if !script_valid {
2025-11-09T23:38:14.4651936Z                      return Ok((
2025-11-09T23:38:14.4652897Z -                        ValidationResult::Invalid(format!(
2025-11-09T23:38:14.4654029Z -                            "Invalid script at transaction {i}"
2025-11-09T23:38:14.4655621Z -                        )),
2025-11-09T23:38:14.4656905Z +                        ValidationResult::Invalid(format!("Invalid script at transaction {i}")),
2025-11-09T23:38:14.4659763Z                          utxo_set,
2025-11-09T23:38:14.4660635Z                      ));
2025-11-09T23:38:14.4661410Z                  }
2025-11-09T23:38:14.4662773Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:374:
2025-11-09T23:38:14.4664461Z  
2025-11-09T23:38:14.4665270Z                  // Use checked arithmetic to prevent fee overflow
2025-11-09T23:38:14.4666517Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-09T23:38:14.4668186Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-09T23:38:14.4671360Z +                    ConsensusError::BlockValidation(format!(
2025-11-09T23:38:14.4672547Z +                        "Total fees overflow at transaction {i}"
2025-11-09T23:38:14.4673606Z +                    ))
2025-11-09T23:38:14.4674486Z                  })?;
2025-11-09T23:38:14.4675228Z              }
2025-11-09T23:38:14.4676097Z          }
2025-11-09T23:38:14.4677414Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:426:
2025-11-09T23:38:14.4681159Z                          .map_err(|e| ConsensusError::TransactionValidation(e.to_string()))?;
2025-11-09T23:38:14.4682411Z  
2025-11-09T23:38:14.4683316Z                      let fee = total_input.checked_sub(total_output).ok_or_else(|| {
2025-11-09T23:38:14.4685174Z -                        ConsensusError::TransactionValidation("Fee calculation underflow".to_string())
2025-11-09T23:38:14.4686752Z +                        ConsensusError::TransactionValidation(
2025-11-09T23:38:14.4687886Z +                            "Fee calculation underflow".to_string(),
2025-11-09T23:38:14.4688913Z +                        )
2025-11-09T23:38:14.4689742Z                      })?;
2025-11-09T23:38:14.4690514Z  
2025-11-09T23:38:14.4691401Z                      if fee < 0 {
2025-11-09T23:38:14.4693033Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:441:
2025-11-09T23:38:14.4694701Z  
2025-11-09T23:38:14.4695550Z                  if !matches!(input_valid, ValidationResult::Valid) {
2025-11-09T23:38:14.4696650Z                      return Ok((
2025-11-09T23:38:14.4697967Z -                        ValidationResult::Invalid(format!("Invalid transaction inputs at index {i}")),
2025-11-09T23:38:14.4699466Z +                        ValidationResult::Invalid(format!(
2025-11-09T23:38:14.4700579Z +                            "Invalid transaction inputs at index {i}"
2025-11-09T23:38:14.4701607Z +                        )),
2025-11-09T23:38:14.4702424Z                          utxo_set,
2025-11-09T23:38:14.4703272Z                      ));
2025-11-09T23:38:14.4704026Z                  }
2025-11-09T23:38:14.4705510Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:495:
2025-11-09T23:38:14.4707066Z  
2025-11-09T23:38:14.4707848Z                  // Use checked arithmetic to prevent fee overflow
2025-11-09T23:38:14.4709099Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-09T23:38:14.4710749Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-09T23:38:14.4712323Z +                    ConsensusError::BlockValidation(format!(
2025-11-09T23:38:14.4713622Z +                        "Total fees overflow at transaction {i}"
2025-11-09T23:38:14.4714741Z +                    ))
2025-11-09T23:38:14.4715489Z                  })?;
2025-11-09T23:38:14.4716215Z              }
2025-11-09T23:38:14.4716904Z          }
2025-11-09T23:38:14.4719673Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:779:
2025-11-09T23:38:14.4721574Z      // Estimate: current size + new outputs - spent inputs (for non-coinbase)
2025-11-09T23:38:14.4722891Z      #[cfg(feature = "production")]
2025-11-09T23:38:14.4723788Z      {
2025-11-09T23:38:14.4724627Z -        let estimated_new_size = utxo_set.len()
2025-11-09T23:38:14.4725679Z +        let estimated_new_size = utxo_set
2025-11-09T23:38:14.4726610Z +            .len()
2025-11-09T23:38:14.4727414Z              .saturating_add(tx.outputs.len())
2025-11-09T23:38:14.4728668Z              .saturating_sub(if is_coinbase(tx) { 0 } else { tx.inputs.len() });
2025-11-09T23:38:14.4731430Z          if estimated_new_size > utxo_set.capacity() {
2025-11-09T23:38:14.4733078Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:896:
2025-11-09T23:38:14.4734982Z  /// is the transaction in Bitcoin wire format.
2025-11-09T23:38:14.4736558Z  ///
2025-11-09T23:38:14.4738384Z  /// For batch operations, use serialize_transaction + batch_double_sha256 instead.
2025-11-09T23:38:14.4740851Z -/// 
2025-11-09T23:38:14.4741925Z +///
2025-11-09T23:38:14.4744026Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-09T23:38:14.4746589Z  /// for 2-3x faster transaction ID calculation.
2025-11-09T23:38:14.4748940Z  #[inline(always)]
2025-11-09T23:38:14.4750311Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:903:
2025-11-09T23:38:14.4751996Z  pub fn calculate_tx_id(tx: &Transaction) -> Hash {
2025-11-09T23:38:14.4753694Z -    use crate::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.4755146Z      use crate::crypto::OptimizedSha256;
2025-11-09T23:38:14.4758154Z +    use crate::serialization::transaction::serialize_transaction;
2025-11-09T23:38:14.4759409Z  
2025-11-09T23:38:14.4760171Z      // Serialize transaction to Bitcoin wire format
2025-11-09T23:38:14.4761279Z      let serialized = serialize_transaction(tx);
2025-11-09T23:38:14.4763146Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:8:
2025-11-09T23:38:14.4765435Z  //! - Batch (8+ items): Uses AVX2 8-way parallel processing
2025-11-09T23:38:14.4766944Z  //! - Expected: 4-8x speedup for batch operations on AVX2-capable CPUs
2025-11-09T23:38:14.4768125Z  
2025-11-09T23:38:14.4768871Z -use sha2::{Digest, Sha256};
2025-11-09T23:38:14.4770157Z  use crate::crypto::sha256_avx2;
2025-11-09T23:38:14.4771054Z +use sha2::{Digest, Sha256};
2025-11-09T23:38:14.4771870Z  
2025-11-09T23:38:14.4772660Z  /// Batch SHA256 using AVX2 8-way parallel processing
2025-11-09T23:38:14.4773692Z  ///
2025-11-09T23:38:14.4777756Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:46:
2025-11-09T23:38:14.4779470Z      }
2025-11-09T23:38:14.4780108Z  
2025-11-09T23:38:14.4780910Z      let mut results = Vec::with_capacity(inputs.len());
2025-11-09T23:38:14.4781936Z -    
2025-11-09T23:38:14.4782579Z +
2025-11-09T23:38:14.4783280Z      // Process in chunks of 8 using AVX2
2025-11-09T23:38:14.4784401Z      let chunks = inputs.chunks_exact(8);
2025-11-09T23:38:14.4785444Z      let remainder = chunks.remainder();
2025-11-09T23:38:14.4789144Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:55:
2025-11-09T23:38:14.4790904Z      for chunk in chunks {
2025-11-09T23:38:14.4791786Z          // Convert chunk to array of 8 references
2025-11-09T23:38:14.4792796Z          let chunk_array: [&[u8]; 8] = [
2025-11-09T23:38:14.4793783Z -            chunk[0], chunk[1], chunk[2], chunk[3],
2025-11-09T23:38:14.4796650Z -            chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-09T23:38:14.4797948Z +            chunk[0], chunk[1], chunk[2], chunk[3], chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-09T23:38:14.4799188Z          ];
2025-11-09T23:38:14.4799853Z -        
2025-11-09T23:38:14.4800507Z +
2025-11-09T23:38:14.4801233Z          // Use AVX2 8-way parallel double SHA256
2025-11-09T23:38:14.4802475Z          // Note: sha256_8way_avx2 expects 64-byte inputs (one SHA256 block)
2025-11-09T23:38:14.4804448Z          // For non-64-byte inputs, it will fall back to sequential processing
2025-11-09T23:38:14.4808751Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:93:
2025-11-09T23:38:14.4810454Z          })
2025-11-09T23:38:14.4811136Z          .collect()
2025-11-09T23:38:14.4811834Z  }
2025-11-09T23:38:14.4812462Z -
2025-11-09T23:38:14.4813342Z  
2025-11-09T23:38:14.4815024Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:99:
2025-11-09T23:38:14.4816762Z  
2025-11-09T23:38:14.4817403Z      #[test]
2025-11-09T23:38:14.4818109Z      fn test_hash_eq_random() {
2025-11-09T23:38:14.4819377Z -        let hash1: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32];
2025-11-09T23:38:14.4821140Z -        let hash2: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33];
2025-11-09T23:38:14.4822473Z -        
2025-11-09T23:38:14.4823181Z +        let hash1: Hash = [
2025-11-09T23:38:14.4824161Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-09T23:38:14.4825407Z +            25, 26, 27, 28, 29, 30, 31, 32,
2025-11-09T23:38:14.4826297Z +        ];
2025-11-09T23:38:14.4826999Z +        let hash2: Hash = [
2025-11-09T23:38:14.4827979Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-09T23:38:14.4830511Z +            25, 26, 27, 28, 29, 30, 31, 33,
2025-11-09T23:38:14.4831400Z +        ];
2025-11-09T23:38:14.4832044Z +
2025-11-09T23:38:14.4832761Z          // Should match standard comparison
2025-11-09T23:38:14.4834054Z          assert_eq!(hash_eq(&hash1, &hash1), hash1 == hash1);
2025-11-09T23:38:14.4835399Z          assert_eq!(hash_eq(&hash1, &hash2), hash1 == hash2);
2025-11-09T23:38:14.4839022Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:108:
2025-11-09T23:38:14.4840934Z      }
2025-11-09T23:38:14.4841572Z  }
2025-11-09T23:38:14.4842201Z -
2025-11-09T23:38:14.4842835Z  
2025-11-09T23:38:14.4844227Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:49:
2025-11-09T23:38:14.4846025Z          Ok(a + b)
2025-11-09T23:38:14.4846730Z      } else {
2025-11-09T23:38:14.4847778Z          // Mixed signs: use checked arithmetic (overflow not possible, but safer)
2025-11-09T23:38:14.4849091Z -        a.checked_add(b).ok_or_else(|| {
2025-11-09T23:38:14.4850475Z -            ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-09T23:38:14.4851820Z -        })
2025-11-09T23:38:14.4852525Z +        a.checked_add(b)
2025-11-09T23:38:14.4853861Z +            .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-09T23:38:14.4856174Z      }
2025-11-09T23:38:14.4858847Z  }
2025-11-09T23:38:14.4859904Z  
2025-11-09T23:38:14.4862384Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:58:
2025-11-09T23:38:14.4867571Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.4869317Z  pub fn safe_add(a: i64, b: i64) -> Result<i64> {
2025-11-09T23:38:14.4871425Z      // Always use checked arithmetic in non-production builds
2025-11-09T23:38:14.4873515Z -    a.checked_add(b).ok_or_else(|| {
2025-11-09T23:38:14.4876452Z -        ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-09T23:38:14.4877817Z -    })
2025-11-09T23:38:14.4878486Z +    a.checked_add(b)
2025-11-09T23:38:14.4879782Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-09T23:38:14.4881222Z  }
2025-11-09T23:38:14.4881852Z  
2025-11-09T23:38:14.4882607Z  /// Fast-path subtraction with overflow checking
2025-11-09T23:38:14.4886385Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:98:
2025-11-09T23:38:14.4888126Z  #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.4889149Z  pub fn safe_sub(a: i64, b: i64) -> Result<i64> {
2025-11-09T23:38:14.4890343Z      // Always use checked arithmetic in non-production builds
2025-11-09T23:38:14.4891499Z -    a.checked_sub(b).ok_or_else(|| {
2025-11-09T23:38:14.4892866Z -        ConsensusError::TransactionValidation("Arithmetic underflow".to_string())
2025-11-09T23:38:14.4894215Z -    })
2025-11-09T23:38:14.4895188Z +    a.checked_sub(b)
2025-11-09T23:38:14.4896518Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic underflow".to_string()))
2025-11-09T23:38:14.4899270Z  }
2025-11-09T23:38:14.4899892Z  
2025-11-09T23:38:14.4900526Z  #[cfg(test)]
2025-11-09T23:38:14.4901963Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:129:
2025-11-09T23:38:14.4903703Z          assert!(safe_sub(i64::MIN, 1).is_err());
2025-11-09T23:38:14.4904762Z      }
2025-11-09T23:38:14.4905401Z  }
2025-11-09T23:38:14.4906044Z -
2025-11-09T23:38:14.4906675Z  
2025-11-09T23:38:14.4908023Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:71:
2025-11-09T23:38:14.4910903Z      }
2025-11-09T23:38:14.4911546Z  
2025-11-09T23:38:14.4912336Z      /// Hash data using the best available implementation
2025-11-09T23:38:14.4913676Z -    /// 
2025-11-09T23:38:14.4914832Z +    ///
2025-11-09T23:38:14.4915997Z      /// Priority:
2025-11-09T23:38:14.4919470Z      /// 1. SHA-NI (Intel SHA Extensions) - 10-15x faster for single hashes
2025-11-09T23:38:14.4920993Z      /// 2. sha2 crate with asm - baseline fallback
2025-11-09T23:38:14.4922682Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:78:
2025-11-09T23:38:14.4924419Z -    /// 
2025-11-09T23:38:14.4925164Z +    ///
2025-11-09T23:38:14.4926104Z      /// For batch operations, see batch_sha256 in optimizations module.
2025-11-09T23:38:14.4927605Z      pub fn hash(&self, data: &[u8]) -> [u8; 32] {
2025-11-09T23:38:14.4928770Z          #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.4930368Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:85:
2025-11-09T23:38:14.4932049Z                  return sha_ni::sha256(data);
2025-11-09T23:38:14.4932964Z              }
2025-11-09T23:38:14.4933649Z          }
2025-11-09T23:38:14.4934470Z -        
2025-11-09T23:38:14.4935255Z +
2025-11-09T23:38:14.4936014Z          // Fallback: sha2 crate with asm optimizations
2025-11-09T23:38:14.4938947Z          let mut hasher = Sha256::new();
2025-11-09T23:38:14.4939894Z          hasher.update(data);
2025-11-09T23:38:14.4941427Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:96:
2025-11-09T23:38:14.4943028Z      }
2025-11-09T23:38:14.4943664Z  
2025-11-09T23:38:14.4944559Z      /// Compute double SHA256 (SHA256(SHA256(data)))
2025-11-09T23:38:14.4945541Z -    /// 
2025-11-09T23:38:14.4946191Z +    ///
2025-11-09T23:38:14.4947126Z      /// Uses SHA-NI if available for optimal single-hash performance.
2025-11-09T23:38:14.4948404Z      pub fn hash256(&self, data: &[u8]) -> [u8; 32] {
2025-11-09T23:38:14.4949430Z          #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.4951041Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:105:
2025-11-09T23:38:14.4952725Z                  return sha_ni::hash256(data);
2025-11-09T23:38:14.4953648Z              }
2025-11-09T23:38:14.4954438Z          }
2025-11-09T23:38:14.4955086Z -        
2025-11-09T23:38:14.4955730Z +
2025-11-09T23:38:14.4956413Z          let first = self.hash(data);
2025-11-09T23:38:14.4957335Z          self.hash(&first)
2025-11-09T23:38:14.4958115Z      }
2025-11-09T23:38:14.4962207Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:17:
2025-11-09T23:38:14.4963985Z  struct AlignedInitialHash([u32; 8]);
2025-11-09T23:38:14.4965020Z  
2025-11-09T23:38:14.4965952Z  static INITIAL_HASH: AlignedInitialHash = AlignedInitialHash([
2025-11-09T23:38:14.4967252Z -    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a,
2025-11-09T23:38:14.4970285Z -    0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-09T23:38:14.4972015Z +    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-09T23:38:14.4973494Z  ]);
2025-11-09T23:38:14.4974119Z  
2025-11-09T23:38:14.4974942Z  // SHA256 K constants
2025-11-09T23:38:14.4976767Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:27:
2025-11-09T23:38:14.4978563Z  struct AlignedKArray([u32; 64]);
2025-11-09T23:38:14.4979432Z  
2025-11-09T23:38:14.4980203Z  static K_ARRAY: AlignedKArray = AlignedKArray([
2025-11-09T23:38:14.4981323Z -    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,
2025-11-09T23:38:14.4982428Z -    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.4983539Z -    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,
2025-11-09T23:38:14.4984763Z -    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.4985900Z -    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,
2025-11-09T23:38:14.4987012Z -    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.4988162Z -    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-09T23:38:14.4989264Z -    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.4991459Z -    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,
2025-11-09T23:38:14.4992549Z -    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.4993638Z -    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,
2025-11-09T23:38:14.4995278Z -    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.4996371Z -    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,
2025-11-09T23:38:14.4997467Z -    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.4998561Z -    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,
2025-11-09T23:38:14.4999869Z -    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.5001576Z +    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.5003603Z +    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.5005790Z +    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.5009415Z +    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.5011436Z +    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.5013707Z +    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.5015935Z +    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.5019293Z +    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.5020766Z  ]);
2025-11-09T23:38:14.5021399Z  
2025-11-09T23:38:14.5022100Z  /// Helper functions for AVX2 operations
2025-11-09T23:38:14.5023851Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:64:
2025-11-09T23:38:14.5025935Z      pub unsafe fn add3(x: __m256i, y: __m256i, z: __m256i) -> __m256i {
2025-11-09T23:38:14.5027100Z          add(add(x, y), z)
2025-11-09T23:38:14.5027884Z      }
2025-11-09T23:38:14.5028517Z -    
2025-11-09T23:38:14.5029148Z +
2025-11-09T23:38:14.5029790Z      #[inline(always)]
2025-11-09T23:38:14.5030857Z      pub unsafe fn add4(x: __m256i, y: __m256i, z: __m256i, w: __m256i) -> __m256i {
2025-11-09T23:38:14.5032209Z          // Core: Add(x, y, z, w) = Add(Add(x, y), Add(z, w))
2025-11-09T23:38:14.5034029Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:71:
2025-11-09T23:38:14.5035903Z          add(add(x, y), add(z, w))
2025-11-09T23:38:14.5038468Z      }
2025-11-09T23:38:14.5039110Z -    
2025-11-09T23:38:14.5039745Z +
2025-11-09T23:38:14.5040395Z      #[inline(always)]
2025-11-09T23:38:14.5041540Z      pub unsafe fn add5(x: __m256i, y: __m256i, z: __m256i, w: __m256i, v: __m256i) -> __m256i {
2025-11-09T23:38:14.5042993Z          // Core: Add(x, y, z, w, v) = Add(Add(x, y, z), Add(w, v))
2025-11-09T23:38:14.5044972Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:171:
2025-11-09T23:38:14.5049127Z  /// One round of SHA-256
2025-11-09T23:38:14.5049971Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.5050826Z  macro_rules! round {
2025-11-09T23:38:14.5051928Z -    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {
2025-11-09T23:38:14.5053173Z -        {
2025-11-09T23:38:14.5053882Z -            use helpers::*;
2025-11-09T23:38:14.5055171Z -            // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-09T23:38:14.5056748Z -            let t1 = add(add($h, helpers::sigma1($e)), add(helpers::ch($e, $f, $g), $k));
2025-11-09T23:38:14.5058192Z -            let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-09T23:38:14.5059330Z -            $d = add($d, t1);
2025-11-09T23:38:14.5060180Z -            $h = add(t1, t2);
2025-11-09T23:38:14.5060990Z -        }
2025-11-09T23:38:14.5061642Z -    };
2025-11-09T23:38:14.5062635Z +    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {{
2025-11-09T23:38:14.5064422Z +        use helpers::*;
2025-11-09T23:38:14.5065559Z +        // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-09T23:38:14.5066816Z +        let t1 = add(
2025-11-09T23:38:14.5067619Z +            add($h, helpers::sigma1($e)),
2025-11-09T23:38:14.5068601Z +            add(helpers::ch($e, $f, $g), $k),
2025-11-09T23:38:14.5069529Z +        );
2025-11-09T23:38:14.5070571Z +        let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-09T23:38:14.5071812Z +        $d = add($d, t1);
2025-11-09T23:38:14.5072616Z +        $h = add(t1, t2);
2025-11-09T23:38:14.5073447Z +    }};
2025-11-09T23:38:14.5074083Z  }
2025-11-09T23:38:14.5075028Z  
2025-11-09T23:38:14.5075847Z  /// Read 8 32-bit words from 8 different 64-byte blocks
2025-11-09T23:38:14.5077709Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:190:
2025-11-09T23:38:14.5079465Z      let mut words = [0u32; 8];
2025-11-09T23:38:14.5080306Z      for i in 0..8 {
2025-11-09T23:38:14.5081082Z          let pos = (i * 64) + offset;
2025-11-09T23:38:14.5082019Z -        words[i] = u32::from_le_bytes([
2025-11-09T23:38:14.5082966Z -            input[pos],
2025-11-09T23:38:14.5083774Z -            input[pos + 1],
2025-11-09T23:38:14.5087018Z -            input[pos + 2],
2025-11-09T23:38:14.5087884Z -            input[pos + 3],
2025-11-09T23:38:14.5088721Z -        ]);
2025-11-09T23:38:14.5089891Z +        words[i] = u32::from_le_bytes([input[pos], input[pos + 1], input[pos + 2], input[pos + 3]]);
2025-11-09T23:38:14.5091261Z      }
2025-11-09T23:38:14.5091913Z -    
2025-11-09T23:38:14.5092545Z +
2025-11-09T23:38:14.5093480Z      // _mm256_set_epi32 places first argument at index 7, last at index 0
2025-11-09T23:38:14.5095365Z      // Core: ReadLE32(chunk + 0) is first arg -> index 7, ReadLE32(chunk + 64) is second arg -> index 6, etc.
2025-11-09T23:38:14.5098769Z      // So words[0] (chunk + 0) should be first arg -> index 7
2025-11-09T23:38:14.5100615Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:205:
2025-11-09T23:38:14.5102613Z      // So chunk 0 goes to index 7, chunk 1 (chunk + 64) goes to index 6, etc.
2025-11-09T23:38:14.5104480Z      // This means words[0] -> index 7, words[1] -> index 6, ..., words[7] -> index 0
2025-11-09T23:38:14.5105803Z      let ret = _mm256_set_epi32(
2025-11-09T23:38:14.5107161Z -        words[0] as i32,  // chunk + 0 -> index 7 (first arg)
2025-11-09T23:38:14.5108397Z -        words[1] as i32,  // chunk + 64 -> index 6 (second arg)
2025-11-09T23:38:14.5109535Z -        words[2] as i32,  // chunk + 128 -> index 5
2025-11-09T23:38:14.5110738Z -        words[3] as i32,  // chunk + 192 -> index 4
2025-11-09T23:38:14.5111808Z -        words[4] as i32,  // chunk + 256 -> index 3
2025-11-09T23:38:14.5113062Z -        words[5] as i32,  // chunk + 320 -> index 2
2025-11-09T23:38:14.5114105Z -        words[6] as i32,  // chunk + 384 -> index 1
2025-11-09T23:38:14.5117643Z -        words[7] as i32,  // chunk + 448 -> index 0 (last arg)
2025-11-09T23:38:14.5118843Z +        words[0] as i32, // chunk + 0 -> index 7 (first arg)
2025-11-09T23:38:14.5120037Z +        words[1] as i32, // chunk + 64 -> index 6 (second arg)
2025-11-09T23:38:14.5121149Z +        words[2] as i32, // chunk + 128 -> index 5
2025-11-09T23:38:14.5122569Z +        words[3] as i32, // chunk + 192 -> index 4
2025-11-09T23:38:14.5123643Z +        words[4] as i32, // chunk + 256 -> index 3
2025-11-09T23:38:14.5124841Z +        words[5] as i32, // chunk + 320 -> index 2
2025-11-09T23:38:14.5125882Z +        words[6] as i32, // chunk + 384 -> index 1
2025-11-09T23:38:14.5126981Z +        words[7] as i32, // chunk + 448 -> index 0 (last arg)
2025-11-09T23:38:14.5139209Z      );
2025-11-09T23:38:14.5141508Z -    
2025-11-09T23:38:14.5142160Z +
2025-11-09T23:38:14.5143161Z      // Byte swap within each 32-bit word using shuffle (matching Core exactly)
2025-11-09T23:38:14.5144752Z      // SHA256 operates on big-endian 32-bit words internally
2025-11-09T23:38:14.5146042Z      // We read little-endian, so we need to byte-swap each word
2025-11-09T23:38:14.5147978Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:221:
2025-11-09T23:38:14.5149966Z      // The shuffle mask 0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203
2025-11-09T23:38:14.5151459Z      // reverses bytes within each 32-bit word
2025-11-09T23:38:14.5152554Z -    // 
2025-11-09T23:38:14.5153206Z +    //
2025-11-09T23:38:14.5156311Z      // Note: _mm256_shuffle_epi8 operates on 8-bit elements across the entire vector
2025-11-09T23:38:14.5157879Z      // The mask pattern is designed to swap bytes within each word
2025-11-09T23:38:14.5159068Z      let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.5160814Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:227:
2025-11-09T23:38:14.5162644Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5163754Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5165285Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.5166625Z +        0x00010203,
2025-11-09T23:38:14.5167346Z      );
2025-11-09T23:38:14.5168062Z      _mm256_shuffle_epi8(ret, shuffle_mask)
2025-11-09T23:38:14.5168976Z  }
2025-11-09T23:38:14.5170462Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:236:
2025-11-09T23:38:14.5172552Z      // Core's Write8 does: byte-swap with shuffle, then WriteLE32 to each position
2025-11-09T23:38:14.5173955Z      // Byte swap within each 32-bit word using shuffle
2025-11-09T23:38:14.5175142Z      let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.5176167Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5177271Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.5178691Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.5180036Z +        0x00010203,
2025-11-09T23:38:14.5180756Z      );
2025-11-09T23:38:14.5181498Z      let v = _mm256_shuffle_epi8(v, shuffle_mask);
2025-11-09T23:38:14.5182468Z -    
2025-11-09T23:38:14.5183107Z +
2025-11-09T23:38:14.5184019Z      // Extract and write to 8 different positions (Core's WriteLE32)
2025-11-09T23:38:14.5185717Z      // Unroll loop because _mm256_extract_epi32 requires compile-time constant index
2025-11-09T23:38:14.5187159Z      let word0 = _mm256_extract_epi32(v, 7) as u32;
2025-11-09T23:38:14.5189022Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:264:
2025-11-09T23:38:14.5191008Z  /// Transform 8 double SHA256 blocks in parallel (SHA256D)
2025-11-09T23:38:14.5192216Z  /// Input: 512 bytes (8 * 64-byte blocks, contiguous)
2025-11-09T23:38:14.5193358Z  /// Output: 256 bytes (8 * 32-byte hashes, contiguous)
2025-11-09T23:38:14.5194545Z -/// 
2025-11-09T23:38:14.5195199Z +///
2025-11-09T23:38:14.5196252Z  /// This performs double SHA256 (SHA256(SHA256(input))) on 8 blocks in parallel.
2025-11-09T23:38:14.5197582Z  #[cfg(target_arch = "x86_64")]
2025-11-09T23:38:14.5198693Z  unsafe fn transform_8way(out: &mut [u8], input: &[u8]) {
2025-11-09T23:38:14.5200589Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:271:
2025-11-09T23:38:14.5202359Z      use helpers::*;
2025-11-09T23:38:14.5203098Z -    
2025-11-09T23:38:14.5203732Z +
2025-11-09T23:38:14.5205159Z      // Initialize state with initial hash values (host byte order, matching Core)
2025-11-09T23:38:14.5208304Z      let mut a = _mm256_set1_epi32(INITIAL_HASH.0[0] as i32);
2025-11-09T23:38:14.5209510Z      let mut b = _mm256_set1_epi32(INITIAL_HASH.0[1] as i32);
2025-11-09T23:38:14.5211373Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:279:
2025-11-09T23:38:14.5213439Z      let mut f = _mm256_set1_epi32(INITIAL_HASH.0[5] as i32);
2025-11-09T23:38:14.5214829Z      let mut g = _mm256_set1_epi32(INITIAL_HASH.0[6] as i32);
2025-11-09T23:38:14.5216040Z      let mut h = _mm256_set1_epi32(INITIAL_HASH.0[7] as i32);
2025-11-09T23:38:14.5217074Z -    
2025-11-09T23:38:14.5217710Z +
2025-11-09T23:38:14.5218394Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5219208Z      {
2025-11-09T23:38:14.5220196Z          let a_init = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5222136Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:312:
2025-11-09T23:38:14.5223854Z      {
2025-11-09T23:38:14.5224751Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5225886Z          let w0_val_7 = _mm256_extract_epi32(w0, 7) as u32;
2025-11-09T23:38:14.5227501Z -        println!("DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}", w0_val, w0_val_7);
2025-11-09T23:38:14.5229001Z +        println!(
2025-11-09T23:38:14.5230074Z +            "DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}",
2025-11-09T23:38:14.5231354Z +            w0_val, w0_val_7
2025-11-09T23:38:14.5232170Z +        );
2025-11-09T23:38:14.5232875Z          if w0_val == 0 && w0_val_7 == 0 {
2025-11-09T23:38:14.5233995Z              println!("DEBUG: w0 is zero (expected for zero input)");
2025-11-09T23:38:14.5235235Z          }
2025-11-09T23:38:14.5236722Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:322:
2025-11-09T23:38:14.5238431Z      {
2025-11-09T23:38:14.5239240Z          let a_after_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5240467Z          let h_after_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5241964Z -        println!("DEBUG After round 0: a=0x{:08x}, h=0x{:08x}", a_after_round0, h_after_round0);
2025-11-09T23:38:14.5243295Z +        println!(
2025-11-09T23:38:14.5244115Z +            "DEBUG After round 0: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5245294Z +            a_after_round0, h_after_round0
2025-11-09T23:38:14.5246204Z +        );
2025-11-09T23:38:14.5246852Z      }
2025-11-09T23:38:14.5249377Z      w1 = read8(input, 4);
2025-11-09T23:38:14.5250331Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-09T23:38:14.5252481Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:330:
2025-11-09T23:38:14.5254219Z      {
2025-11-09T23:38:14.5255179Z          let a_after_round1 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5256401Z          let h_after_round1 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5259517Z -        println!("DEBUG After round 1: a=0x{:08x}, h=0x{:08x}", a_after_round1, h_after_round1);
2025-11-09T23:38:14.5260853Z +        println!(
2025-11-09T23:38:14.5262082Z +            "DEBUG After round 1: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5263142Z +            a_after_round1, h_after_round1
2025-11-09T23:38:14.5264062Z +        );
2025-11-09T23:38:14.5264853Z      }
2025-11-09T23:38:14.5265525Z      w2 = read8(input, 8);
2025-11-09T23:38:14.5266488Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-09T23:38:14.5268343Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:349:
2025-11-09T23:38:14.5270254Z          let a_after_round7 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5271485Z          let b_after_round7 = _mm256_extract_epi32(b, 0) as u32;
2025-11-09T23:38:14.5272705Z          let h_after_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5274947Z -        println!("DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}", a_after_round7, b_after_round7, h_after_round7);
2025-11-09T23:38:14.5276469Z +        println!(
2025-11-09T23:38:14.5279186Z +            "DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5280390Z +            a_after_round7, b_after_round7, h_after_round7
2025-11-09T23:38:14.5281386Z +        );
2025-11-09T23:38:14.5282039Z      }
2025-11-09T23:38:14.5282713Z      w8 = read8(input, 32);
2025-11-09T23:38:14.5283659Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[8]), w8));
2025-11-09T23:38:14.5285625Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:371:
2025-11-09T23:38:14.5289272Z      {
2025-11-09T23:38:14.5290114Z          let a_after_round15 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5291488Z          let h_after_round15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5292993Z -        println!("DEBUG After round 15: a=0x{:08x}, h=0x{:08x}", a_after_round15, h_after_round15);
2025-11-09T23:38:14.5294901Z +        println!(
2025-11-09T23:38:14.5295750Z +            "DEBUG After round 15: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5296813Z +            a_after_round15, h_after_round15
2025-11-09T23:38:14.5299119Z +        );
2025-11-09T23:38:14.5299761Z      }
2025-11-09T23:38:14.5300394Z  
2025-11-09T23:38:14.5301076Z      // Rounds 16-63: Message schedule
2025-11-09T23:38:14.5303128Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:382:
2025-11-09T23:38:14.5305099Z          let w14_val = _mm256_extract_epi32(w14, 0) as u32;
2025-11-09T23:38:14.5306238Z          let w9_val = _mm256_extract_epi32(w9, 0) as u32;
2025-11-09T23:38:14.5309101Z          let w1_val = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5310824Z -        println!("DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}", w0_before, w14_val, w9_val, w1_val);
2025-11-09T23:38:14.5312400Z +        println!(
2025-11-09T23:38:14.5313675Z +            "DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5315122Z +            w0_before, w14_val, w9_val, w1_val
2025-11-09T23:38:14.5316048Z +        );
2025-11-09T23:38:14.5316700Z      }
2025-11-09T23:38:14.5319564Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5321549Z +    helpers::inc4(
2025-11-09T23:38:14.5322271Z +        &mut w0,
2025-11-09T23:38:14.5323018Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5323909Z +        w9,
2025-11-09T23:38:14.5324749Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5325608Z +    );
2025-11-09T23:38:14.5326295Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5329006Z      {
2025-11-09T23:38:14.5329802Z          let w0_after_inc = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5331684Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:405:
2025-11-09T23:38:14.5333777Z                   a_after_round16, b_after_round16, c_after_round16, d_after_round16,
2025-11-09T23:38:14.5335393Z                   e_after_round16, f_after_round16, g_after_round16, h_after_round16);
2025-11-09T23:38:14.5338682Z      }
2025-11-09T23:38:14.5339755Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5341104Z +    helpers::inc4(
2025-11-09T23:38:14.5341806Z +        &mut w1,
2025-11-09T23:38:14.5342548Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5343431Z +        w10,
2025-11-09T23:38:14.5344946Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5345843Z +    );
2025-11-09T23:38:14.5348303Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[17]), w1));
2025-11-09T23:38:14.5349765Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5351087Z +    helpers::inc4(
2025-11-09T23:38:14.5351803Z +        &mut w2,
2025-11-09T23:38:14.5352549Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5353413Z +        w11,
2025-11-09T23:38:14.5354138Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5355533Z +    );
2025-11-09T23:38:14.5356397Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-09T23:38:14.5357472Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5360188Z      {
2025-11-09T23:38:14.5361661Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:414:
2025-11-09T23:38:14.5363592Z          let a_after_round18 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5365265Z          println!("DEBUG After round 18: a=0x{:08x}", a_after_round18);
2025-11-09T23:38:14.5366398Z      }
2025-11-09T23:38:14.5367602Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5369971Z +    helpers::inc4(
2025-11-09T23:38:14.5370685Z +        &mut w3,
2025-11-09T23:38:14.5371411Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5372270Z +        w12,
2025-11-09T23:38:14.5372981Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5373842Z +    );
2025-11-09T23:38:14.5375176Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-09T23:38:14.5376647Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5379178Z +    helpers::inc4(
2025-11-09T23:38:14.5379884Z +        &mut w4,
2025-11-09T23:38:14.5380630Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5381486Z +        w13,
2025-11-09T23:38:14.5382203Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5383053Z +    );
2025-11-09T23:38:14.5383872Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-09T23:38:14.5385100Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5385911Z      {
2025-11-09T23:38:14.5387392Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:423:
2025-11-09T23:38:14.5390151Z          let a_after_round20 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5391594Z          println!("DEBUG After round 20: a=0x{:08x}", a_after_round20);
2025-11-09T23:38:14.5392925Z      }
2025-11-09T23:38:14.5393991Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5395453Z +    helpers::inc4(
2025-11-09T23:38:14.5396179Z +        &mut w5,
2025-11-09T23:38:14.5398682Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5399537Z +        w14,
2025-11-09T23:38:14.5400261Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5401111Z +    );
2025-11-09T23:38:14.5401925Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-09T23:38:14.5403364Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5406717Z +    helpers::inc4(
2025-11-09T23:38:14.5407502Z +        &mut w6,
2025-11-09T23:38:14.5408622Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5409505Z +        w15,
2025-11-09T23:38:14.5410231Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5411089Z +    );
2025-11-09T23:38:14.5411884Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-09T23:38:14.5413585Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5415039Z +    helpers::inc4(
2025-11-09T23:38:14.5415748Z +        &mut w7,
2025-11-09T23:38:14.5416478Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5417342Z +        w0,
2025-11-09T23:38:14.5418055Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5418914Z +    );
2025-11-09T23:38:14.5419704Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-09T23:38:14.5421149Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5422477Z +    helpers::inc4(
2025-11-09T23:38:14.5423184Z +        &mut w8,
2025-11-09T23:38:14.5423924Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5424912Z +        w1,
2025-11-09T23:38:14.5425632Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5428050Z +    );
2025-11-09T23:38:14.5428846Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[24]), w8));
2025-11-09T23:38:14.5430347Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5431680Z +    helpers::inc4(
2025-11-09T23:38:14.5432442Z +        &mut w9,
2025-11-09T23:38:14.5433224Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5434089Z +        w2,
2025-11-09T23:38:14.5434925Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5435798Z +    );
2025-11-09T23:38:14.5436990Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[25]), w9));
2025-11-09T23:38:14.5438632Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5439966Z +    helpers::inc4(
2025-11-09T23:38:14.5440674Z +        &mut w10,
2025-11-09T23:38:14.5441419Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5442283Z +        w3,
2025-11-09T23:38:14.5443002Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5444423Z +    );
2025-11-09T23:38:14.5445248Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[26]), w10));
2025-11-09T23:38:14.5446714Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5449267Z +    helpers::inc4(
2025-11-09T23:38:14.5449970Z +        &mut w11,
2025-11-09T23:38:14.5450719Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5451580Z +        w4,
2025-11-09T23:38:14.5452299Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5453161Z +    );
2025-11-09T23:38:14.5453973Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[27]), w11));
2025-11-09T23:38:14.5455644Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5458617Z +    helpers::inc4(
2025-11-09T23:38:14.5459326Z +        &mut w12,
2025-11-09T23:38:14.5460068Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5460940Z +        w5,
2025-11-09T23:38:14.5461895Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5462812Z +    );
2025-11-09T23:38:14.5463617Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[28]), w12));
2025-11-09T23:38:14.5465256Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5466606Z +    helpers::inc4(
2025-11-09T23:38:14.5467309Z +        &mut w13,
2025-11-09T23:38:14.5468051Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5468915Z +        w6,
2025-11-09T23:38:14.5469629Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5470490Z +    );
2025-11-09T23:38:14.5471299Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-09T23:38:14.5472840Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5474183Z +    helpers::inc4(
2025-11-09T23:38:14.5475017Z +        &mut w14,
2025-11-09T23:38:14.5475766Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5476625Z +        w7,
2025-11-09T23:38:14.5477333Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5478199Z +    );
2025-11-09T23:38:14.5481023Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-09T23:38:14.5482408Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5483523Z      {
2025-11-09T23:38:14.5485134Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:468:
2025-11-09T23:38:14.5487255Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5490084Z          let w11_val = _mm256_extract_epi32(w11, 0) as u32;
2025-11-09T23:38:14.5491218Z          let w6_val = _mm256_extract_epi32(w6, 0) as u32;
2025-11-09T23:38:14.5492836Z -        println!("DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}", w15_before, w13_val, w8_val, w0_val);
2025-11-09T23:38:14.5495110Z +        println!(
2025-11-09T23:38:14.5496147Z +            "DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}",
2025-11-09T23:38:14.5497432Z +            w15_before, w13_val, w8_val, w0_val
2025-11-09T23:38:14.5498352Z +        );
2025-11-09T23:38:14.5499565Z          println!("DEBUG w11: 0x{:08x}, w6: 0x{:08x}", w11_val, w6_val);
2025-11-09T23:38:14.5501063Z          let sigma1_w13 = _mm256_extract_epi32(helpers::sigma1_small(w13), 0) as u32;
2025-11-09T23:38:14.5502638Z          let sigma0_w0 = _mm256_extract_epi32(helpers::sigma0_small(w0), 0) as u32;
2025-11-09T23:38:14.5504836Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:475:
2025-11-09T23:38:14.5507269Z -        println!("DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}", sigma1_w13, sigma0_w0);
2025-11-09T23:38:14.5510648Z +        println!(
2025-11-09T23:38:14.5511618Z +            "DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}",
2025-11-09T23:38:14.5513068Z +            sigma1_w13, sigma0_w0
2025-11-09T23:38:14.5513935Z +        );
2025-11-09T23:38:14.5514703Z      }
2025-11-09T23:38:14.5515775Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5518727Z +    helpers::inc4(
2025-11-09T23:38:14.5519807Z +        &mut w15,
2025-11-09T23:38:14.5520564Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5521448Z +        w8,
2025-11-09T23:38:14.5522152Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5523242Z +    );
2025-11-09T23:38:14.5523987Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5524937Z      {
2025-11-09T23:38:14.5525731Z          let w15_after = _mm256_extract_epi32(w15, 0) as u32;
2025-11-09T23:38:14.5529449Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:497:
2025-11-09T23:38:14.5531469Z                   a_after_round31, b_after_round31, c_after_round31, d_after_round31,
2025-11-09T23:38:14.5532966Z                   e_after_round31, f_after_round31, g_after_round31, h_after_round31);
2025-11-09T23:38:14.5534164Z      }
2025-11-09T23:38:14.5535335Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5538489Z +    helpers::inc4(
2025-11-09T23:38:14.5539203Z +        &mut w0,
2025-11-09T23:38:14.5539938Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5540817Z +        w9,
2025-11-09T23:38:14.5541520Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5542373Z +    );
2025-11-09T23:38:14.5543161Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-09T23:38:14.5544732Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5546080Z +    helpers::inc4(
2025-11-09T23:38:14.5546800Z +        &mut w1,
2025-11-09T23:38:14.5549168Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5550086Z +        w10,
2025-11-09T23:38:14.5550807Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5551649Z +    );
2025-11-09T23:38:14.5552437Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-09T23:38:14.5553883Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5555365Z +    helpers::inc4(
2025-11-09T23:38:14.5556068Z +        &mut w2,
2025-11-09T23:38:14.5556812Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5557665Z +        w11,
2025-11-09T23:38:14.5558383Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5559234Z +    );
2025-11-09T23:38:14.5560028Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-09T23:38:14.5561460Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5562781Z +    helpers::inc4(
2025-11-09T23:38:14.5563496Z +        &mut w3,
2025-11-09T23:38:14.5564227Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5565207Z +        w12,
2025-11-09T23:38:14.5565920Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5568453Z +    );
2025-11-09T23:38:14.5569241Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-09T23:38:14.5570755Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5572085Z +    helpers::inc4(
2025-11-09T23:38:14.5572784Z +        &mut w4,
2025-11-09T23:38:14.5573519Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5574492Z +        w13,
2025-11-09T23:38:14.5575214Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5576058Z +    );
2025-11-09T23:38:14.5578366Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-09T23:38:14.5579803Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5581297Z +    helpers::inc4(
2025-11-09T23:38:14.5582135Z +        &mut w5,
2025-11-09T23:38:14.5583054Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5583916Z +        w14,
2025-11-09T23:38:14.5586630Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5587482Z +    );
2025-11-09T23:38:14.5588279Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-09T23:38:14.5589726Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5591049Z +    helpers::inc4(
2025-11-09T23:38:14.5591755Z +        &mut w6,
2025-11-09T23:38:14.5592496Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5593356Z +        w15,
2025-11-09T23:38:14.5594066Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5595050Z +    );
2025-11-09T23:38:14.5597965Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-09T23:38:14.5599450Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5600792Z +    helpers::inc4(
2025-11-09T23:38:14.5601515Z +        &mut w7,
2025-11-09T23:38:14.5602255Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5603125Z +        w0,
2025-11-09T23:38:14.5603831Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5607019Z +    );
2025-11-09T23:38:14.5607825Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-09T23:38:14.5609261Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5610588Z +    helpers::inc4(
2025-11-09T23:38:14.5611293Z +        &mut w8,
2025-11-09T23:38:14.5612032Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5613035Z +        w1,
2025-11-09T23:38:14.5613742Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5614775Z +    );
2025-11-09T23:38:14.5615558Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-09T23:38:14.5618537Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5619856Z +    helpers::inc4(
2025-11-09T23:38:14.5620580Z +        &mut w9,
2025-11-09T23:38:14.5621317Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5622165Z +        w2,
2025-11-09T23:38:14.5622877Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5623736Z +    );
2025-11-09T23:38:14.5624641Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-09T23:38:14.5626098Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5627439Z +    helpers::inc4(
2025-11-09T23:38:14.5628151Z +        &mut w10,
2025-11-09T23:38:14.5628893Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5629751Z +        w3,
2025-11-09T23:38:14.5630452Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5631321Z +    );
2025-11-09T23:38:14.5632113Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-09T23:38:14.5633580Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5635117Z +    helpers::inc4(
2025-11-09T23:38:14.5635829Z +        &mut w11,
2025-11-09T23:38:14.5636571Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5637424Z +        w4,
2025-11-09T23:38:14.5638134Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5647734Z +    );
2025-11-09T23:38:14.5648587Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-09T23:38:14.5650096Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5651451Z +    helpers::inc4(
2025-11-09T23:38:14.5652172Z +        &mut w12,
2025-11-09T23:38:14.5652918Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5653803Z +        w5,
2025-11-09T23:38:14.5654659Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5655541Z +    );
2025-11-09T23:38:14.5656339Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-09T23:38:14.5658026Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5659541Z +    helpers::inc4(
2025-11-09T23:38:14.5660251Z +        &mut w13,
2025-11-09T23:38:14.5660998Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5661875Z +        w6,
2025-11-09T23:38:14.5662592Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5663461Z +    );
2025-11-09T23:38:14.5664253Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-09T23:38:14.5665852Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5667210Z +    helpers::inc4(
2025-11-09T23:38:14.5667929Z +        &mut w14,
2025-11-09T23:38:14.5668670Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5669973Z +        w7,
2025-11-09T23:38:14.5670724Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5671596Z +    );
2025-11-09T23:38:14.5672392Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-09T23:38:14.5673860Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5676776Z +    helpers::inc4(
2025-11-09T23:38:14.5677494Z +        &mut w15,
2025-11-09T23:38:14.5678248Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5679111Z +        w8,
2025-11-09T23:38:14.5679835Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5680688Z +    );
2025-11-09T23:38:14.5681489Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-09T23:38:14.5682926Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.5684253Z +    helpers::inc4(
2025-11-09T23:38:14.5685080Z +        &mut w0,
2025-11-09T23:38:14.5685831Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.5686698Z +        w9,
2025-11-09T23:38:14.5689393Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.5690263Z +    );
2025-11-09T23:38:14.5691053Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-09T23:38:14.5692509Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.5693830Z +    helpers::inc4(
2025-11-09T23:38:14.5694745Z +        &mut w1,
2025-11-09T23:38:14.5695493Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.5696374Z +        w10,
2025-11-09T23:38:14.5697090Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.5697945Z +    );
2025-11-09T23:38:14.5700656Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-09T23:38:14.5702099Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.5703438Z +    helpers::inc4(
2025-11-09T23:38:14.5704141Z +        &mut w2,
2025-11-09T23:38:14.5705014Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.5705870Z +        w11,
2025-11-09T23:38:14.5706588Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.5707447Z +    );
2025-11-09T23:38:14.5708243Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-09T23:38:14.5709683Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.5711025Z +    helpers::inc4(
2025-11-09T23:38:14.5711747Z +        &mut w3,
2025-11-09T23:38:14.5712477Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.5713521Z +        w12,
2025-11-09T23:38:14.5714233Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.5715207Z +    );
2025-11-09T23:38:14.5717898Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-09T23:38:14.5719328Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.5720643Z +    helpers::inc4(
2025-11-09T23:38:14.5721351Z +        &mut w4,
2025-11-09T23:38:14.5722084Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.5722944Z +        w13,
2025-11-09T23:38:14.5723654Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.5726649Z +    );
2025-11-09T23:38:14.5727561Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-09T23:38:14.5729186Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.5730643Z +    helpers::inc4(
2025-11-09T23:38:14.5731347Z +        &mut w5,
2025-11-09T23:38:14.5732075Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.5732931Z +        w14,
2025-11-09T23:38:14.5733657Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.5734654Z +    );
2025-11-09T23:38:14.5735458Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-09T23:38:14.5738367Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.5739677Z +    helpers::inc4(
2025-11-09T23:38:14.5740387Z +        &mut w6,
2025-11-09T23:38:14.5741113Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.5741972Z +        w15,
2025-11-09T23:38:14.5742685Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.5743540Z +    );
2025-11-09T23:38:14.5744448Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-09T23:38:14.5745903Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.5749049Z +    helpers::inc4(
2025-11-09T23:38:14.5749748Z +        &mut w7,
2025-11-09T23:38:14.5750484Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.5751336Z +        w0,
2025-11-09T23:38:14.5752050Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.5752897Z +    );
2025-11-09T23:38:14.5753695Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-09T23:38:14.5755241Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.5756569Z +    helpers::inc4(
2025-11-09T23:38:14.5759089Z +        &mut w8,
2025-11-09T23:38:14.5759831Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.5760688Z +        w1,
2025-11-09T23:38:14.5761397Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.5762244Z +    );
2025-11-09T23:38:14.5763035Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-09T23:38:14.5764771Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.5766148Z +    helpers::inc4(
2025-11-09T23:38:14.5766856Z +        &mut w9,
2025-11-09T23:38:14.5767587Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.5768441Z +        w2,
2025-11-09T23:38:14.5769146Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.5770006Z +    );
2025-11-09T23:38:14.5770798Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-09T23:38:14.5772241Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.5773582Z +    helpers::inc4(
2025-11-09T23:38:14.5774474Z +        &mut w10,
2025-11-09T23:38:14.5775234Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.5776089Z +        w3,
2025-11-09T23:38:14.5776804Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.5777660Z +    );
2025-11-09T23:38:14.5778453Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-09T23:38:14.5779911Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.5781248Z +    helpers::inc4(
2025-11-09T23:38:14.5781956Z +        &mut w11,
2025-11-09T23:38:14.5782697Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.5783564Z +        w4,
2025-11-09T23:38:14.5784273Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.5785273Z +    );
2025-11-09T23:38:14.5786064Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-09T23:38:14.5787526Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.5788863Z +    helpers::inc4(
2025-11-09T23:38:14.5789573Z +        &mut w12,
2025-11-09T23:38:14.5790323Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.5791186Z +        w5,
2025-11-09T23:38:14.5791902Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.5792748Z +    );
2025-11-09T23:38:14.5793539Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-09T23:38:14.5795330Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.5796807Z +    helpers::inc4(
2025-11-09T23:38:14.5797516Z +        &mut w13,
2025-11-09T23:38:14.5798261Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.5799122Z +        w6,
2025-11-09T23:38:14.5799835Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.5800700Z +    );
2025-11-09T23:38:14.5801485Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-09T23:38:14.5802957Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.5804415Z +    helpers::inc4(
2025-11-09T23:38:14.5805128Z +        &mut w14,
2025-11-09T23:38:14.5805862Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.5808488Z +        w7,
2025-11-09T23:38:14.5809192Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.5810064Z +    );
2025-11-09T23:38:14.5810867Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[62]), w14));
2025-11-09T23:38:14.5812348Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.5813870Z +    helpers::inc4(
2025-11-09T23:38:14.5814863Z +        &mut w15,
2025-11-09T23:38:14.5815652Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.5818391Z +        w8,
2025-11-09T23:38:14.5819104Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.5819958Z +    );
2025-11-09T23:38:14.5820760Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[63]), w15));
2025-11-09T23:38:14.5821837Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5822657Z      {
2025-11-09T23:38:14.5824120Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:578:
2025-11-09T23:38:14.5826594Z          // First SHA256 of 64 zero bytes should produce: 0x42fda5f5 (little-endian of first word)
2025-11-09T23:38:14.5828163Z          // So a should be: 0x42fda5f5 - 0x6a09e667 = 0xd8f3bf8e
2025-11-09T23:38:14.5829637Z          println!("DEBUG Expected a after round 63: 0xd8f3bf8e (0x42fda5f5 - 0x6a09e667)");
2025-11-09T23:38:14.5832213Z -        println!("DEBUG Difference: 0x{:08x}", a_after_round63.wrapping_sub(0xd8f3bf8e));
2025-11-09T23:38:14.5833559Z +        println!(
2025-11-09T23:38:14.5834452Z +            "DEBUG Difference: 0x{:08x}",
2025-11-09T23:38:14.5835478Z +            a_after_round63.wrapping_sub(0xd8f3bf8e)
2025-11-09T23:38:14.5836433Z +        );
2025-11-09T23:38:14.5837073Z      }
2025-11-09T23:38:14.5837695Z  
2025-11-09T23:38:14.5840277Z      // Add initial hash values (Transform 1 complete)
2025-11-09T23:38:14.5842103Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:586:
2025-11-09T23:38:14.5843796Z      {
2025-11-09T23:38:14.5844684Z          let a_before = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5845804Z          let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5847437Z -        println!("DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}", a_before, h_before);
2025-11-09T23:38:14.5848966Z +        println!(
2025-11-09T23:38:14.5850018Z +            "DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5852553Z +            a_before, h_before
2025-11-09T23:38:14.5853359Z +        );
2025-11-09T23:38:14.5854269Z          println!("Expected SHA256(64 zeros) first word: 0xf5a5fd42");
2025-11-09T23:38:14.5855770Z      }
2025-11-09T23:38:14.5856477Z      a = add(a, k(INITIAL_HASH.0[0]));
2025-11-09T23:38:14.5860275Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:601:
2025-11-09T23:38:14.5861985Z      {
2025-11-09T23:38:14.5862752Z          let a_after = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5863877Z          let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5865824Z -        println!("DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}", a_after, h_after);
2025-11-09T23:38:14.5867342Z +        println!(
2025-11-09T23:38:14.5868514Z +            "DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5869764Z +            a_after, h_after
2025-11-09T23:38:14.5870567Z +        );
2025-11-09T23:38:14.5871451Z          println!("Expected: a=0xf5a5fd42 (from SHA256(64 zeros))");
2025-11-09T23:38:14.5872602Z      }
2025-11-09T23:38:14.5873227Z  
2025-11-09T23:38:14.5874804Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:610:
2025-11-09T23:38:14.5876512Z      {
2025-11-09T23:38:14.5878724Z          let a_before_t2 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5880033Z          let b_before_t2 = _mm256_extract_epi32(b, 0) as u32;
2025-11-09T23:38:14.5881591Z -        println!("DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}", a_before_t2, b_before_t2);
2025-11-09T23:38:14.5883038Z +        println!(
2025-11-09T23:38:14.5883972Z +            "DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}",
2025-11-09T23:38:14.5885614Z +            a_before_t2, b_before_t2
2025-11-09T23:38:14.5886484Z +        );
2025-11-09T23:38:14.5887177Z      }
2025-11-09T23:38:14.5887814Z      let t0 = a;
2025-11-09T23:38:14.5888510Z      let t1 = b;
2025-11-09T23:38:14.5891567Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:711:
2025-11-09T23:38:14.5893268Z      {
2025-11-09T23:38:14.5894074Z          let w0_combined = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5895587Z          let w1_combined = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5897232Z -        println!("DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}", w0_combined, w1_combined);
2025-11-09T23:38:14.5898744Z +        println!(
2025-11-09T23:38:14.5899761Z +            "DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5901001Z +            w0_combined, w1_combined
2025-11-09T23:38:14.5901872Z +        );
2025-11-09T23:38:14.5902524Z      }
2025-11-09T23:38:14.5903141Z  
2025-11-09T23:38:14.5903892Z      // Transform 3: Final SHA256 on the combined state
2025-11-09T23:38:14.5905828Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:730:
2025-11-09T23:38:14.5908905Z      {
2025-11-09T23:38:14.5909671Z          let w0_t3 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5910763Z          let w1_t3 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.5912111Z -        println!("DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}", w0_t3, w1_t3);
2025-11-09T23:38:14.5913520Z +        println!(
2025-11-09T23:38:14.5914495Z +            "DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.5915532Z +            w0_t3, w1_t3
2025-11-09T23:38:14.5916293Z +        );
2025-11-09T23:38:14.5916932Z      }
2025-11-09T23:38:14.5917729Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[0]), w0));
2025-11-09T23:38:14.5920763Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.5922420Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:737:
2025-11-09T23:38:14.5924123Z      {
2025-11-09T23:38:14.5925058Z          let a_after_t3_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.5926303Z          let h_after_t3_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5929468Z -        println!("DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)", a_after_t3_round0, h_after_t3_round0);
2025-11-09T23:38:14.5931162Z +        println!(
2025-11-09T23:38:14.5932281Z +            "DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)",
2025-11-09T23:38:14.5933670Z +            a_after_t3_round0, h_after_t3_round0
2025-11-09T23:38:14.5934769Z +        );
2025-11-09T23:38:14.5935420Z      }
2025-11-09T23:38:14.5936210Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-09T23:38:14.5937610Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-09T23:38:14.5939902Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:750:
2025-11-09T23:38:14.5941601Z      {
2025-11-09T23:38:14.5942386Z          // After round 7, the new a (for next round) is in h
2025-11-09T23:38:14.5943581Z          let h_after_t3_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5945216Z -        println!("DEBUG Transform 3 after round 7: h (new a)=0x{:08x}", h_after_t3_round7);
2025-11-09T23:38:14.5946556Z +        println!(
2025-11-09T23:38:14.5947433Z +            "DEBUG Transform 3 after round 7: h (new a)=0x{:08x}",
2025-11-09T23:38:14.5948517Z +            h_after_t3_round7
2025-11-09T23:38:14.5949312Z +        );
2025-11-09T23:38:14.5949949Z      }
2025-11-09T23:38:14.5950672Z      round!(a, b, c, d, e, f, g, h, k(0x5807aa98));
2025-11-09T23:38:14.5951718Z      round!(h, a, b, c, d, e, f, g, k(0x12835b01));
2025-11-09T23:38:14.5953491Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:778:
2025-11-09T23:38:14.5955451Z          let f_after_15 = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.5956589Z          let g_after_15 = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.5957724Z          let h_after_15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5959484Z -        println!("DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_after_15, b_after_15, c_after_15, d_after_15);
2025-11-09T23:38:14.5961555Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_after_15, f_after_15, g_after_15, h_after_15);
2025-11-09T23:38:14.5962877Z +        println!(
2025-11-09T23:38:14.5963968Z +            "DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.5965475Z +            a_after_15, b_after_15, c_after_15, d_after_15
2025-11-09T23:38:14.5966447Z +        );
2025-11-09T23:38:14.5967112Z +        println!(
2025-11-09T23:38:14.5967919Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5968993Z +            e_after_15, f_after_15, g_after_15, h_after_15
2025-11-09T23:38:14.5969963Z +        );
2025-11-09T23:38:14.5970980Z          println!("  Expected: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-09T23:38:14.5972252Z      }
2025-11-09T23:38:14.5972873Z  
2025-11-09T23:38:14.5974423Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:795:
2025-11-09T23:38:14.5976283Z          let f_before_16 = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.5977450Z          let g_before_16 = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.5978619Z          let h_before_16 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.5980443Z -        println!("DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_16, b_before_16, c_before_16, d_before_16);
2025-11-09T23:38:14.5982934Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_16, f_before_16, g_before_16, h_before_16);
2025-11-09T23:38:14.5984930Z -        println!("  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-09T23:38:14.5986345Z +        println!(
2025-11-09T23:38:14.5987448Z +            "DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.5988866Z +            a_before_16, b_before_16, c_before_16, d_before_16
2025-11-09T23:38:14.5989860Z +        );
2025-11-09T23:38:14.5990565Z +        println!(
2025-11-09T23:38:14.5991370Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.5992466Z +            e_before_16, f_before_16, g_before_16, h_before_16
2025-11-09T23:38:14.5993466Z +        );
2025-11-09T23:38:14.5994124Z +        println!(
2025-11-09T23:38:14.5995520Z +            "  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027"
2025-11-09T23:38:14.5996949Z +        );
2025-11-09T23:38:14.5997819Z          let w0_before_t3_round16 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.5999152Z          let w1_before_t3_round16 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.6000938Z -        println!("DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}", w0_before_t3_round16, w1_before_t3_round16);
2025-11-09T23:38:14.6002511Z +        println!(
2025-11-09T23:38:14.6003496Z +            "DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}",
2025-11-09T23:38:14.6005198Z +            w0_before_t3_round16, w1_before_t3_round16
2025-11-09T23:38:14.6006168Z +        );
2025-11-09T23:38:14.6006808Z      }
2025-11-09T23:38:14.6007733Z      // Save old values before round 16 - these will be needed in round 17
2025-11-09T23:38:14.6011132Z      // Round 16 modifies d and h, so we save c and d (which become $d and $e in round 17)
2025-11-09T23:38:14.6013596Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:818:
2025-11-09T23:38:14.6015508Z      {
2025-11-09T23:38:14.6016284Z          let w0_before = _mm256_extract_epi32(w0, 0) as u32;
2025-11-09T23:38:14.6017414Z          let w1_before = _mm256_extract_epi32(w1, 0) as u32;
2025-11-09T23:38:14.6020350Z -        println!("DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}", w0_before, w1_before);
2025-11-09T23:38:14.6021607Z +        println!(
2025-11-09T23:38:14.6022414Z +            "DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}",
2025-11-09T23:38:14.6023434Z +            w0_before, w1_before
2025-11-09T23:38:14.6024258Z +        );
2025-11-09T23:38:14.6025022Z      }
2025-11-09T23:38:14.6025816Z      helpers::inc(&mut w0, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6026862Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6030647Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:839:
2025-11-09T23:38:14.6032500Z          let g_after = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.6033643Z          println!("DEBUG T3 R17 after: g=0x{:08x}", g_after);
2025-11-09T23:38:14.6034776Z      }
2025-11-09T23:38:14.6035785Z -    helpers::inc3(&mut w2, helpers::sigma1_small(w0), helpers::sigma0_small(w3));
2025-11-09T23:38:14.6037061Z +    helpers::inc3(
2025-11-09T23:38:14.6037775Z +        &mut w2,
2025-11-09T23:38:14.6040498Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6041403Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6042250Z +    );
2025-11-09T23:38:14.6043021Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-09T23:38:14.6044524Z -    helpers::inc3(&mut w3, helpers::sigma1_small(w1), helpers::sigma0_small(w4));
2025-11-09T23:38:14.6045813Z +    helpers::inc3(
2025-11-09T23:38:14.6046514Z +        &mut w3,
2025-11-09T23:38:14.6047240Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6048146Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6049001Z +    );
2025-11-09T23:38:14.6049790Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-09T23:38:14.6051197Z -    helpers::inc3(&mut w4, helpers::sigma1_small(w2), helpers::sigma0_small(w5));
2025-11-09T23:38:14.6052468Z +    helpers::inc3(
2025-11-09T23:38:14.6053178Z +        &mut w4,
2025-11-09T23:38:14.6053515Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6053852Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6054140Z +    );
2025-11-09T23:38:14.6054702Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-09T23:38:14.6055355Z -    helpers::inc3(&mut w5, helpers::sigma1_small(w3), helpers::sigma0_small(w6));
2025-11-09T23:38:14.6055659Z +    helpers::inc3(
2025-11-09T23:38:14.6055949Z +        &mut w5,
2025-11-09T23:38:14.6056286Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6056618Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6058652Z +    );
2025-11-09T23:38:14.6059266Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-09T23:38:14.6060119Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), k(0x100), helpers::sigma0_small(w7));
2025-11-09T23:38:14.6060431Z +    helpers::inc4(
2025-11-09T23:38:14.6060714Z +        &mut w6,
2025-11-09T23:38:14.6061047Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6061333Z +        k(0x100),
2025-11-09T23:38:14.6061671Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6061948Z +    );
2025-11-09T23:38:14.6062388Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-09T23:38:14.6062973Z      helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, k(0x11002000));
2025-11-09T23:38:14.6063416Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-09T23:38:14.6064638Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:865:
2025-11-09T23:38:14.6065089Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-09T23:38:14.6065652Z      w14 = helpers::add3(helpers::sigma1_small(w12), w7, k(0x400022));
2025-11-09T23:38:14.6066108Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-09T23:38:14.6066848Z -    w15 = helpers::add4(k(0x100), helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.6067174Z +    w15 = helpers::add4(
2025-11-09T23:38:14.6069282Z +        k(0x100),
2025-11-09T23:38:14.6069615Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.6069904Z +        w8,
2025-11-09T23:38:14.6070235Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.6070514Z +    );
2025-11-09T23:38:14.6070961Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[31]), w15));
2025-11-09T23:38:14.6071240Z -    
2025-11-09T23:38:14.6071513Z +
2025-11-09T23:38:14.6072397Z      // Continue with standard message schedule for rounds 32-63 (matching Core Transform 3 pattern)
2025-11-09T23:38:14.6072728Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6073005Z      {
2025-11-09T23:38:14.6074125Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:874:
2025-11-09T23:38:14.6074687Z          let a_before_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6075190Z          println!("DEBUG T3 R32 before: a=0x{:08x}", a_before_32);
2025-11-09T23:38:14.6075467Z      }
2025-11-09T23:38:14.6076155Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6076468Z +    helpers::inc4(
2025-11-09T23:38:14.6076747Z +        &mut w0,
2025-11-09T23:38:14.6077079Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.6077373Z +        w9,
2025-11-09T23:38:14.6077699Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.6077977Z +    );
2025-11-09T23:38:14.6078412Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-09T23:38:14.6078745Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6079020Z      {
2025-11-09T23:38:14.6080132Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:881:
2025-11-09T23:38:14.6080575Z          let a_after_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6081040Z          println!("DEBUG T3 R32 after: a=0x{:08x}", a_after_32);
2025-11-09T23:38:14.6081489Z      }
2025-11-09T23:38:14.6082203Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.6082513Z +    helpers::inc4(
2025-11-09T23:38:14.6082798Z +        &mut w1,
2025-11-09T23:38:14.6083306Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.6083608Z +        w10,
2025-11-09T23:38:14.6083942Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.6084218Z +    );
2025-11-09T23:38:14.6086713Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-09T23:38:14.6087432Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.6087736Z +    helpers::inc4(
2025-11-09T23:38:14.6088016Z +        &mut w2,
2025-11-09T23:38:14.6088520Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6088925Z +        w11,
2025-11-09T23:38:14.6089258Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6089538Z +    );
2025-11-09T23:38:14.6089992Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-09T23:38:14.6090686Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.6090990Z +    helpers::inc4(
2025-11-09T23:38:14.6091278Z +        &mut w3,
2025-11-09T23:38:14.6091611Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6091905Z +        w12,
2025-11-09T23:38:14.6092237Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6092515Z +    );
2025-11-09T23:38:14.6092964Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-09T23:38:14.6093664Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.6093967Z +    helpers::inc4(
2025-11-09T23:38:14.6094258Z +        &mut w4,
2025-11-09T23:38:14.6094805Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6095098Z +        w13,
2025-11-09T23:38:14.6095432Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6095709Z +    );
2025-11-09T23:38:14.6098123Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-09T23:38:14.6098819Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.6099130Z +    helpers::inc4(
2025-11-09T23:38:14.6099414Z +        &mut w5,
2025-11-09T23:38:14.6099749Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6100033Z +        w14,
2025-11-09T23:38:14.6100357Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6100631Z +    );
2025-11-09T23:38:14.6101069Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-09T23:38:14.6101776Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.6102078Z +    helpers::inc4(
2025-11-09T23:38:14.6102356Z +        &mut w6,
2025-11-09T23:38:14.6102695Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6102982Z +        w15,
2025-11-09T23:38:14.6103319Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6103595Z +    );
2025-11-09T23:38:14.6104042Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-09T23:38:14.6107129Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.6107449Z +    helpers::inc4(
2025-11-09T23:38:14.6107735Z +        &mut w7,
2025-11-09T23:38:14.6108066Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.6108344Z +        w0,
2025-11-09T23:38:14.6108676Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.6108955Z +    );
2025-11-09T23:38:14.6109397Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-09T23:38:14.6110089Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.6110706Z +    helpers::inc4(
2025-11-09T23:38:14.6110995Z +        &mut w8,
2025-11-09T23:38:14.6111338Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.6111625Z +        w1,
2025-11-09T23:38:14.6112078Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.6112392Z +    );
2025-11-09T23:38:14.6113048Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-09T23:38:14.6121523Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6121863Z      {
2025-11-09T23:38:14.6123012Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:902:
2025-11-09T23:38:14.6123447Z          let a_after_40 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6123891Z          let h_after_40 = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6124687Z -        println!("DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}", a_after_40, h_after_40);
2025-11-09T23:38:14.6124994Z +        println!(
2025-11-09T23:38:14.6125401Z +            "DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.6125721Z +            a_after_40, h_after_40
2025-11-09T23:38:14.6126216Z +        );
2025-11-09T23:38:14.6126615Z      }
2025-11-09T23:38:14.6127341Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.6127648Z +    helpers::inc4(
2025-11-09T23:38:14.6127930Z +        &mut w9,
2025-11-09T23:38:14.6128269Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.6128551Z +        w2,
2025-11-09T23:38:14.6128888Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.6129164Z +    );
2025-11-09T23:38:14.6129615Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-09T23:38:14.6130320Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.6130626Z +    helpers::inc4(
2025-11-09T23:38:14.6130915Z +        &mut w10,
2025-11-09T23:38:14.6131249Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.6131530Z +        w3,
2025-11-09T23:38:14.6131864Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.6132141Z +    );
2025-11-09T23:38:14.6132603Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-09T23:38:14.6133333Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.6133650Z +    helpers::inc4(
2025-11-09T23:38:14.6133939Z +        &mut w11,
2025-11-09T23:38:14.6134410Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.6134702Z +        w4,
2025-11-09T23:38:14.6135038Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.6135313Z +    );
2025-11-09T23:38:14.6135762Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-09T23:38:14.6136488Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.6136793Z +    helpers::inc4(
2025-11-09T23:38:14.6137078Z +        &mut w12,
2025-11-09T23:38:14.6137418Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.6137700Z +        w5,
2025-11-09T23:38:14.6138037Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.6138313Z +    );
2025-11-09T23:38:14.6138778Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-09T23:38:14.6139494Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.6139800Z +    helpers::inc4(
2025-11-09T23:38:14.6140092Z +        &mut w13,
2025-11-09T23:38:14.6140424Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.6140709Z +        w6,
2025-11-09T23:38:14.6141040Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.6141323Z +    );
2025-11-09T23:38:14.6141769Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-09T23:38:14.6142492Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-09T23:38:14.6142801Z +    helpers::inc4(
2025-11-09T23:38:14.6143086Z +        &mut w14,
2025-11-09T23:38:14.6143422Z +        helpers::sigma1_small(w12),
2025-11-09T23:38:14.6143699Z +        w7,
2025-11-09T23:38:14.6144035Z +        helpers::sigma0_small(w15),
2025-11-09T23:38:14.6144441Z +    );
2025-11-09T23:38:14.6144892Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-09T23:38:14.6145611Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-09T23:38:14.6145913Z +    helpers::inc4(
2025-11-09T23:38:14.6146199Z +        &mut w15,
2025-11-09T23:38:14.6148296Z +        helpers::sigma1_small(w13),
2025-11-09T23:38:14.6148585Z +        w8,
2025-11-09T23:38:14.6148915Z +        helpers::sigma0_small(w0),
2025-11-09T23:38:14.6149189Z +    );
2025-11-09T23:38:14.6149641Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-09T23:38:14.6150331Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-09T23:38:14.6150633Z +    helpers::inc4(
2025-11-09T23:38:14.6150923Z +        &mut w0,
2025-11-09T23:38:14.6151259Z +        helpers::sigma1_small(w14),
2025-11-09T23:38:14.6151540Z +        w9,
2025-11-09T23:38:14.6151867Z +        helpers::sigma0_small(w1),
2025-11-09T23:38:14.6152306Z +    );
2025-11-09T23:38:14.6152873Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-09T23:38:14.6153211Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6153491Z      {
2025-11-09T23:38:14.6154728Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:924:
2025-11-09T23:38:14.6155154Z          let a_after_48 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6155628Z          println!("DEBUG T3 R48 after: a=0x{:08x}", a_after_48);
2025-11-09T23:38:14.6155916Z      }
2025-11-09T23:38:14.6156623Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-09T23:38:14.6158625Z +    helpers::inc4(
2025-11-09T23:38:14.6158916Z +        &mut w1,
2025-11-09T23:38:14.6159252Z +        helpers::sigma1_small(w15),
2025-11-09T23:38:14.6159532Z +        w10,
2025-11-09T23:38:14.6159860Z +        helpers::sigma0_small(w2),
2025-11-09T23:38:14.6160142Z +    );
2025-11-09T23:38:14.6160593Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-09T23:38:14.6161296Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-09T23:38:14.6161606Z +    helpers::inc4(
2025-11-09T23:38:14.6161890Z +        &mut w2,
2025-11-09T23:38:14.6162225Z +        helpers::sigma1_small(w0),
2025-11-09T23:38:14.6162506Z +        w11,
2025-11-09T23:38:14.6162841Z +        helpers::sigma0_small(w3),
2025-11-09T23:38:14.6163116Z +    );
2025-11-09T23:38:14.6163560Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-09T23:38:14.6164254Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-09T23:38:14.6164678Z +    helpers::inc4(
2025-11-09T23:38:14.6164963Z +        &mut w3,
2025-11-09T23:38:14.6165301Z +        helpers::sigma1_small(w1),
2025-11-09T23:38:14.6165580Z +        w12,
2025-11-09T23:38:14.6165908Z +        helpers::sigma0_small(w4),
2025-11-09T23:38:14.6166179Z +    );
2025-11-09T23:38:14.6166638Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-09T23:38:14.6167324Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-09T23:38:14.6167627Z +    helpers::inc4(
2025-11-09T23:38:14.6167917Z +        &mut w4,
2025-11-09T23:38:14.6168247Z +        helpers::sigma1_small(w2),
2025-11-09T23:38:14.6168530Z +        w13,
2025-11-09T23:38:14.6169300Z +        helpers::sigma0_small(w5),
2025-11-09T23:38:14.6169595Z +    );
2025-11-09T23:38:14.6170040Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-09T23:38:14.6170734Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-09T23:38:14.6171048Z +    helpers::inc4(
2025-11-09T23:38:14.6171327Z +        &mut w5,
2025-11-09T23:38:14.6171667Z +        helpers::sigma1_small(w3),
2025-11-09T23:38:14.6171949Z +        w14,
2025-11-09T23:38:14.6172284Z +        helpers::sigma0_small(w6),
2025-11-09T23:38:14.6172563Z +    );
2025-11-09T23:38:14.6173011Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-09T23:38:14.6173715Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-09T23:38:14.6174023Z +    helpers::inc4(
2025-11-09T23:38:14.6174492Z +        &mut w6,
2025-11-09T23:38:14.6174826Z +        helpers::sigma1_small(w4),
2025-11-09T23:38:14.6175116Z +        w15,
2025-11-09T23:38:14.6175447Z +        helpers::sigma0_small(w7),
2025-11-09T23:38:14.6175726Z +    );
2025-11-09T23:38:14.6176176Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-09T23:38:14.6176859Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-09T23:38:14.6177158Z +    helpers::inc4(
2025-11-09T23:38:14.6177439Z +        &mut w7,
2025-11-09T23:38:14.6177781Z +        helpers::sigma1_small(w5),
2025-11-09T23:38:14.6178058Z +        w0,
2025-11-09T23:38:14.6178383Z +        helpers::sigma0_small(w8),
2025-11-09T23:38:14.6178664Z +    );
2025-11-09T23:38:14.6179301Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-09T23:38:14.6180121Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-09T23:38:14.6180426Z +    helpers::inc4(
2025-11-09T23:38:14.6180722Z +        &mut w8,
2025-11-09T23:38:14.6181056Z +        helpers::sigma1_small(w6),
2025-11-09T23:38:14.6181334Z +        w1,
2025-11-09T23:38:14.6181676Z +        helpers::sigma0_small(w9),
2025-11-09T23:38:14.6181949Z +    );
2025-11-09T23:38:14.6182393Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-09T23:38:14.6182721Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6183005Z      {
2025-11-09T23:38:14.6184111Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:945:
2025-11-09T23:38:14.6184668Z          let a_after_56 = _mm256_extract_epi32(a, 0) as u32;
2025-11-09T23:38:14.6185146Z          println!("DEBUG T3 R56 after: a=0x{:08x}", a_after_56);
2025-11-09T23:38:14.6185429Z      }
2025-11-09T23:38:14.6186130Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-09T23:38:14.6186434Z +    helpers::inc4(
2025-11-09T23:38:14.6186715Z +        &mut w9,
2025-11-09T23:38:14.6187048Z +        helpers::sigma1_small(w7),
2025-11-09T23:38:14.6187327Z +        w2,
2025-11-09T23:38:14.6187664Z +        helpers::sigma0_small(w10),
2025-11-09T23:38:14.6187936Z +    );
2025-11-09T23:38:14.6188378Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-09T23:38:14.6189083Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-09T23:38:14.6189390Z +    helpers::inc4(
2025-11-09T23:38:14.6189674Z +        &mut w10,
2025-11-09T23:38:14.6190007Z +        helpers::sigma1_small(w8),
2025-11-09T23:38:14.6190297Z +        w3,
2025-11-09T23:38:14.6190630Z +        helpers::sigma0_small(w11),
2025-11-09T23:38:14.6190906Z +    );
2025-11-09T23:38:14.6191364Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-09T23:38:14.6192082Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-09T23:38:14.6192384Z +    helpers::inc4(
2025-11-09T23:38:14.6192667Z +        &mut w11,
2025-11-09T23:38:14.6193001Z +        helpers::sigma1_small(w9),
2025-11-09T23:38:14.6193280Z +        w4,
2025-11-09T23:38:14.6193619Z +        helpers::sigma0_small(w12),
2025-11-09T23:38:14.6193901Z +    );
2025-11-09T23:38:14.6194462Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-09T23:38:14.6195173Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-09T23:38:14.6195472Z +    helpers::inc4(
2025-11-09T23:38:14.6195766Z +        &mut w12,
2025-11-09T23:38:14.6196101Z +        helpers::sigma1_small(w10),
2025-11-09T23:38:14.6196378Z +        w5,
2025-11-09T23:38:14.6196711Z +        helpers::sigma0_small(w13),
2025-11-09T23:38:14.6196988Z +    );
2025-11-09T23:38:14.6197440Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-09T23:38:14.6198159Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-09T23:38:14.6198468Z +    helpers::inc4(
2025-11-09T23:38:14.6198751Z +        &mut w13,
2025-11-09T23:38:14.6199082Z +        helpers::sigma1_small(w11),
2025-11-09T23:38:14.6199370Z +        w6,
2025-11-09T23:38:14.6199703Z +        helpers::sigma0_small(w14),
2025-11-09T23:38:14.6199978Z +    );
2025-11-09T23:38:14.6200421Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-09T23:38:14.6201306Z      // Core Transform 3 rounds 62-63: Use Add with 5 args, w14/w15 NOT modified (different from Transform 1)
2025-11-09T23:38:14.6202267Z -    round!(c, d, e, f, g, h, a, b, helpers::add5(k(K_ARRAY.0[62]), w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15)));
2025-11-09T23:38:14.6203347Z -    round!(b, c, d, e, f, g, h, a, helpers::add5(k(K_ARRAY.0[63]), w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0)));
2025-11-09T23:38:14.6203756Z +    round!(
2025-11-09T23:38:14.6204037Z +        c,
2025-11-09T23:38:14.6204436Z +        d,
2025-11-09T23:38:14.6204727Z +        e,
2025-11-09T23:38:14.6205004Z +        f,
2025-11-09T23:38:14.6205289Z +        g,
2025-11-09T23:38:14.6205569Z +        h,
2025-11-09T23:38:14.6205857Z +        a,
2025-11-09T23:38:14.6206138Z +        b,
2025-11-09T23:38:14.6206451Z +        helpers::add5(
2025-11-09T23:38:14.6206770Z +            k(K_ARRAY.0[62]),
2025-11-09T23:38:14.6207052Z +            w14,
2025-11-09T23:38:14.6207399Z +            helpers::sigma1_small(w12),
2025-11-09T23:38:14.6207678Z +            w7,
2025-11-09T23:38:14.6208023Z +            helpers::sigma0_small(w15)
2025-11-09T23:38:14.6208299Z +        )
2025-11-09T23:38:14.6208577Z +    );
2025-11-09T23:38:14.6210760Z +    round!(
2025-11-09T23:38:14.6211040Z +        b,
2025-11-09T23:38:14.6211317Z +        c,
2025-11-09T23:38:14.6211591Z +        d,
2025-11-09T23:38:14.6211878Z +        e,
2025-11-09T23:38:14.6212166Z +        f,
2025-11-09T23:38:14.6212456Z +        g,
2025-11-09T23:38:14.6212889Z +        h,
2025-11-09T23:38:14.6213174Z +        a,
2025-11-09T23:38:14.6213678Z +        helpers::add5(
2025-11-09T23:38:14.6214180Z +            k(K_ARRAY.0[63]),
2025-11-09T23:38:14.6214609Z +            w15,
2025-11-09T23:38:14.6214962Z +            helpers::sigma1_small(w13),
2025-11-09T23:38:14.6215244Z +            w8,
2025-11-09T23:38:14.6215585Z +            helpers::sigma0_small(w0)
2025-11-09T23:38:14.6215872Z +        )
2025-11-09T23:38:14.6216154Z +    );
2025-11-09T23:38:14.6216429Z  
2025-11-09T23:38:14.6216816Z      // Add initial hash values and write output
2025-11-09T23:38:14.6217264Z      // Core: Add initial hash values before writing output
2025-11-09T23:38:14.6218381Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:976:
2025-11-09T23:38:14.6218852Z          let f_before_final = _mm256_extract_epi32(f, 0) as u32;
2025-11-09T23:38:14.6219322Z          let g_before_final = _mm256_extract_epi32(g, 0) as u32;
2025-11-09T23:38:14.6219790Z          let h_before_final = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6220998Z -        println!("DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_final, b_before_final, c_before_final, d_before_final);
2025-11-09T23:38:14.6221874Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_final, f_before_final, g_before_final, h_before_final);
2025-11-09T23:38:14.6222839Z -        println!("DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)", a_before_final);
2025-11-09T23:38:14.6223133Z +        println!(
2025-11-09T23:38:14.6223817Z +            "DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-09T23:38:14.6224478Z +            a_before_final, b_before_final, c_before_final, d_before_final
2025-11-09T23:38:14.6224767Z +        );
2025-11-09T23:38:14.6225079Z +        println!(
2025-11-09T23:38:14.6225471Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-09T23:38:14.6226007Z +            e_before_final, f_before_final, g_before_final, h_before_final
2025-11-09T23:38:14.6227945Z +        );
2025-11-09T23:38:14.6228234Z +        println!(
2025-11-09T23:38:14.6228971Z +            "DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)",
2025-11-09T23:38:14.6229280Z +            a_before_final
2025-11-09T23:38:14.6229562Z +        );
2025-11-09T23:38:14.6229838Z      }
2025-11-09T23:38:14.6230202Z      // Write8(out, 0, Add(a, K(0x6a09e667ul)));
2025-11-09T23:38:14.6230614Z      let a_final = add(a, k(INITIAL_HASH.0[0]));
2025-11-09T23:38:14.6231807Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:985:
2025-11-09T23:38:14.6232139Z      #[cfg(debug_assertions)]
2025-11-09T23:38:14.6232412Z      {
2025-11-09T23:38:14.6233056Z          let a_final_val = _mm256_extract_epi32(a_final, 0) as u32;
2025-11-09T23:38:14.6233919Z -        println!("DEBUG Transform 3 final a (after adding initial): 0x{:08x}", a_final_val);
2025-11-09T23:38:14.6234213Z +        println!(
2025-11-09T23:38:14.6234890Z +            "DEBUG Transform 3 final a (after adding initial): 0x{:08x}",
2025-11-09T23:38:14.6235196Z +            a_final_val
2025-11-09T23:38:14.6235474Z +        );
2025-11-09T23:38:14.6235750Z      }
2025-11-09T23:38:14.6236073Z      write8(out, 0, a_final);
2025-11-09T23:38:14.6236461Z      write8(out, 4, add(b, k(INITIAL_HASH.0[1])));
2025-11-09T23:38:14.6237621Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1015:
2025-11-09T23:38:14.6238219Z      // For inputs that aren't exactly 64 bytes, we need to handle padding
2025-11-09T23:38:14.6238713Z      // For now, use sha2 crate as fallback for non-64-byte inputs
2025-11-09T23:38:14.6239167Z      use bitcoin_hashes::{sha256d, Hash as BitcoinHash};
2025-11-09T23:38:14.6239464Z -    
2025-11-09T23:38:14.6239753Z +
2025-11-09T23:38:14.6240138Z      // Check if all inputs are exactly 64 bytes
2025-11-09T23:38:14.6240673Z      let all_64_bytes = inputs.iter().all(|input| input.len() == 64);
2025-11-09T23:38:14.6240959Z -    
2025-11-09T23:38:14.6241236Z +
2025-11-09T23:38:14.6241533Z      if !all_64_bytes {
2025-11-09T23:38:14.6241963Z          // Fallback to sha2 crate for non-64-byte inputs
2025-11-09T23:38:14.6242302Z          let mut results = [[0u8; 32]; 8];
2025-11-09T23:38:14.6243630Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1028:
2025-11-09T23:38:14.6243922Z          }
2025-11-09T23:38:14.6244235Z          return results;
2025-11-09T23:38:14.6244636Z      }
2025-11-09T23:38:14.6244915Z -    
2025-11-09T23:38:14.6245198Z +
2025-11-09T23:38:14.6245618Z      // Pack 8 inputs into contiguous 512-byte buffer
2025-11-09T23:38:14.6245951Z      let mut input_buf = [0u8; 512];
2025-11-09T23:38:14.6246347Z      for (i, input) in inputs.iter().enumerate() {
2025-11-09T23:38:14.6248563Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1035:
2025-11-09T23:38:14.6249025Z          input_buf[i * 64..(i + 1) * 64].copy_from_slice(input);
2025-11-09T23:38:14.6249304Z      }
2025-11-09T23:38:14.6249586Z -    
2025-11-09T23:38:14.6249859Z +
2025-11-09T23:38:14.6250190Z      // Transform (double SHA256)
2025-11-09T23:38:14.6250929Z      let mut output_buf = [0u8; 256];
2025-11-09T23:38:14.6251340Z      transform_8way(&mut output_buf, &input_buf);
2025-11-09T23:38:14.6252452Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1041:
2025-11-09T23:38:14.6252730Z -    
2025-11-09T23:38:14.6253015Z +
2025-11-09T23:38:14.6253309Z      // Unpack results
2025-11-09T23:38:14.6253644Z      let mut results = [[0u8; 32]; 8];
2025-11-09T23:38:14.6253946Z      for i in 0..8 {
2025-11-09T23:38:14.6255287Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1045:
2025-11-09T23:38:14.6255825Z          results[i].copy_from_slice(&output_buf[i * 32..(i + 1) * 32]);
2025-11-09T23:38:14.6256110Z      }
2025-11-09T23:38:14.6256395Z -    
2025-11-09T23:38:14.6256669Z +
2025-11-09T23:38:14.6258769Z      results
2025-11-09T23:38:14.6259054Z  }
2025-11-09T23:38:14.6259329Z  
2025-11-09T23:38:14.6260434Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1085:
2025-11-09T23:38:14.6260750Z          input_buf[1] = 0x45;
2025-11-09T23:38:14.6261068Z          input_buf[2] = 0x23;
2025-11-09T23:38:14.6261382Z          input_buf[3] = 0x01;
2025-11-09T23:38:14.6261660Z -        
2025-11-09T23:38:14.6261938Z +
2025-11-09T23:38:14.6262220Z          unsafe {
2025-11-09T23:38:14.6262542Z              // Read from offset 0
2025-11-09T23:38:14.6262882Z              let v = read8(&input_buf, 0);
2025-11-09T23:38:14.6264170Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1092:
2025-11-09T23:38:14.6264710Z -            
2025-11-09T23:38:14.6264986Z +
2025-11-09T23:38:14.6265329Z              // Extract the first word
2025-11-09T23:38:14.6265757Z              // After _mm256_set_epi32(words[7], ..., words[0]):
2025-11-09T23:38:14.6266127Z              // - Index 0 = words[0] (block 0)
2025-11-09T23:38:14.6267241Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1096:
2025-11-09T23:38:14.6267590Z              // - Index 7 = words[7] (block 7)
2025-11-09T23:38:14.6267962Z              // So we extract from index 0 for block 0
2025-11-09T23:38:14.6268368Z              let word0 = _mm256_extract_epi32(v, 0) as u32;
2025-11-09T23:38:14.6268654Z -            
2025-11-09T23:38:14.6268926Z +
2025-11-09T23:38:14.6269278Z              println!("Read8 shuffle test:");
2025-11-09T23:38:14.6269781Z              println!("  Input: 0x01234567 (LE bytes: [67, 45, 23, 01])");
2025-11-09T23:38:14.6270175Z              println!("  Output word0: 0x{:08x}", word0);
2025-11-09T23:38:14.6271293Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1103:
2025-11-09T23:38:14.6271995Z              println!("  Expected: 0x01234567 (if no swap) or 0x67452301 (if byte-reversed)");
2025-11-09T23:38:14.6272617Z              println!("  Or maybe: 0x23014567 or something else depending on shuffle");
2025-11-09T23:38:14.6272897Z -            
2025-11-09T23:38:14.6273174Z +
2025-11-09T23:38:14.6273547Z              // Also check what the shuffle mask does
2025-11-09T23:38:14.6273940Z              let test_word = _mm256_set1_epi32(0x01234567);
2025-11-09T23:38:14.6274426Z              let shuffle_mask = _mm256_set_epi32(
2025-11-09T23:38:14.6275543Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1109:
2025-11-09T23:38:14.6275959Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.6276360Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-09T23:38:14.6278839Z +                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-09T23:38:14.6279142Z +                0x00010203,
2025-11-09T23:38:14.6279421Z              );
2025-11-09T23:38:14.6279958Z              let shuffled = _mm256_shuffle_epi8(test_word, shuffle_mask);
2025-11-09T23:38:14.6280488Z              let shuffled_word = _mm256_extract_epi32(shuffled, 0) as u32;
2025-11-09T23:38:14.6281598Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1134:
2025-11-09T23:38:14.6281932Z              let mut f = k(0x9b05688c);
2025-11-09T23:38:14.6282259Z              let mut g = k(0x1f83d9ab);
2025-11-09T23:38:14.6282588Z              let mut h = k(0x5be0cd19);
2025-11-09T23:38:14.6282872Z -            
2025-11-09T23:38:14.6283149Z +
2025-11-09T23:38:14.6283579Z              let d_before = _mm256_extract_epi32(d, 0) as u32;
2025-11-09T23:38:14.6284008Z              let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6284408Z -            
2025-11-09T23:38:14.6284681Z +
2025-11-09T23:38:14.6285000Z              // Call round macro
2025-11-09T23:38:14.6285390Z              round!(a, b, c, d, e, f, g, h, k(0x428a2f98));
2025-11-09T23:38:14.6285676Z -            
2025-11-09T23:38:14.6285947Z +
2025-11-09T23:38:14.6286360Z              let d_after = _mm256_extract_epi32(d, 0) as u32;
2025-11-09T23:38:14.6288390Z              let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-09T23:38:14.6288671Z -            
2025-11-09T23:38:14.6288945Z +
2025-11-09T23:38:14.6289394Z              println!("Round macro state modification test:");
2025-11-09T23:38:14.6290114Z -            println!("  d before: 0x{:08x}, after: 0x{:08x} (should be different)", d_before, d_after);
2025-11-09T23:38:14.6290995Z -            println!("  h before: 0x{:08x}, after: 0x{:08x} (should be different)", h_before, h_after);
2025-11-09T23:38:14.6291391Z -            
2025-11-09T23:38:14.6291695Z +            println!(
2025-11-09T23:38:14.6292188Z +                "  d before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-09T23:38:14.6292509Z +                d_before, d_after
2025-11-09T23:38:14.6292795Z +            );
2025-11-09T23:38:14.6293097Z +            println!(
2025-11-09T23:38:14.6293581Z +                "  h before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-09T23:38:14.6293900Z +                h_before, h_after
2025-11-09T23:38:14.6294187Z +            );
2025-11-09T23:38:14.6294582Z +
2025-11-09T23:38:14.6294915Z              if d_before == d_after {
2025-11-09T23:38:14.6295314Z                  println!("  ERROR: d was not modified!");
2025-11-09T23:38:14.6295593Z              }
2025-11-09T23:38:14.6296722Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1168:
2025-11-09T23:38:14.6297098Z          // Test with 8 identical 64-byte inputs
2025-11-09T23:38:14.6297429Z          let test_data = [0u8; 64];
2025-11-09T23:38:14.6297750Z          let inputs: [&[u8]; 8] = [
2025-11-09T23:38:14.6298176Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6298600Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6299291Z +            &test_data, &test_data, &test_data, &test_data, &test_data, &test_data, &test_data,
2025-11-09T23:38:14.6299634Z +            &test_data,
2025-11-09T23:38:14.6299917Z          ];
2025-11-09T23:38:14.6300193Z  
2025-11-09T23:38:14.6300475Z          unsafe {
2025-11-09T23:38:14.6301593Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1176:
2025-11-09T23:38:14.6302009Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-09T23:38:14.6302286Z -            
2025-11-09T23:38:14.6302591Z +
2025-11-09T23:38:14.6303172Z              // Compute expected result using bitcoin_hashes (double SHA256)
2025-11-09T23:38:14.6303898Z              // bitcoin_hashes::sha256d is the standard Bitcoin double SHA256 implementation
2025-11-09T23:38:14.6304400Z              let mut engine = sha256d::Hash::engine();
2025-11-09T23:38:14.6305520Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1181:
2025-11-09T23:38:14.6305862Z              engine.input(&test_data);
2025-11-09T23:38:14.6306306Z              let expected = sha256d::Hash::from_engine(engine);
2025-11-09T23:38:14.6306708Z              let expected_bytes = expected.into_inner();
2025-11-09T23:38:14.6306996Z -            
2025-11-09T23:38:14.6307272Z +
2025-11-09T23:38:14.6307792Z              // Debug: print first few bytes
2025-11-09T23:38:14.6308244Z              println!("Expected: {:?}", &expected_bytes[..8]);
2025-11-09T23:38:14.6308669Z              println!("Got:      {:?}", &avx2_results[0][..8]);
2025-11-09T23:38:14.6309798Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1188:
2025-11-09T23:38:14.6310099Z -            
2025-11-09T23:38:14.6310373Z +
2025-11-09T23:38:14.6310796Z              // All 8 results should be identical (same input)
2025-11-09T23:38:14.6311241Z              for (i, result) in avx2_results.iter().enumerate() {
2025-11-09T23:38:14.6311605Z                  if result != &expected_bytes {
2025-11-09T23:38:14.6312934Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1192:
2025-11-09T23:38:14.6313463Z -                    println!("Mismatch at index {}: expected {:?}, got {:?}", 
2025-11-09T23:38:14.6313858Z -                        i, &expected_bytes[..16], &result[..16]);
2025-11-09T23:38:14.6314168Z +                    println!(
2025-11-09T23:38:14.6314724Z +                        "Mismatch at index {}: expected {:?}, got {:?}",
2025-11-09T23:38:14.6315027Z +                        i,
2025-11-09T23:38:14.6315549Z +                        &expected_bytes[..16],
2025-11-09T23:38:14.6315881Z +                        &result[..16]
2025-11-09T23:38:14.6316279Z +                    );
2025-11-09T23:38:14.6316561Z                  }
2025-11-09T23:38:14.6316866Z                  assert_eq!(
2025-11-09T23:38:14.6317215Z                      result, &expected_bytes,
2025-11-09T23:38:14.6318336Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1215:
2025-11-09T23:38:14.6318662Z              input_data[i][0] = i as u8;
2025-11-09T23:38:14.6318940Z          }
2025-11-09T23:38:14.6319259Z          let inputs: [&[u8]; 8] = [
2025-11-09T23:38:14.6319793Z -            &input_data[0], &input_data[1], &input_data[2], &input_data[3],
2025-11-09T23:38:14.6320316Z -            &input_data[4], &input_data[5], &input_data[6], &input_data[7],
2025-11-09T23:38:14.6320625Z +            &input_data[0],
2025-11-09T23:38:14.6320938Z +            &input_data[1],
2025-11-09T23:38:14.6321325Z +            &input_data[2],
2025-11-09T23:38:14.6321639Z +            &input_data[3],
2025-11-09T23:38:14.6321958Z +            &input_data[4],
2025-11-09T23:38:14.6322271Z +            &input_data[5],
2025-11-09T23:38:14.6322573Z +            &input_data[6],
2025-11-09T23:38:14.6323476Z +            &input_data[7],
2025-11-09T23:38:14.6323772Z          ];
2025-11-09T23:38:14.6324044Z  
2025-11-09T23:38:14.6324455Z          unsafe {
2025-11-09T23:38:14.6325581Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1223:
2025-11-09T23:38:14.6325994Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-09T23:38:14.6326272Z -            
2025-11-09T23:38:14.6326547Z +
2025-11-09T23:38:14.6326954Z              // Compute expected results using sha2 crate
2025-11-09T23:38:14.6327376Z              for (i, input) in input_data.iter().enumerate() {
2025-11-09T23:38:14.6327774Z                  let mut engine = sha256d::Hash::engine();
2025-11-09T23:38:14.6328905Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1228:
2025-11-09T23:38:14.6329251Z                  engine.input(input);
2025-11-09T23:38:14.6329696Z                  let expected = sha256d::Hash::from_engine(engine);
2025-11-09T23:38:14.6330103Z                  let expected_bytes = expected.into_inner();
2025-11-09T23:38:14.6330392Z -                
2025-11-09T23:38:14.6330663Z +
2025-11-09T23:38:14.6330965Z                  assert_eq!(
2025-11-09T23:38:14.6331338Z                      &avx2_results[i], &expected_bytes,
2025-11-09T23:38:14.6331921Z                      "AVX2 result {} does not match expected double SHA256 for input {}",
2025-11-09T23:38:14.6332942Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:59:
2025-11-09T23:38:14.6333227Z  
2025-11-09T23:38:14.6333990Z      // SHA256 constants (first 32 bits of fractional parts of cube roots of first 64 primes)
2025-11-09T23:38:14.6334489Z      const K: [u32; 64] = [
2025-11-09T23:38:14.6335360Z -        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-09T23:38:14.6336235Z -        0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-09T23:38:14.6338573Z -        0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-09T23:38:14.6339423Z -        0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-09T23:38:14.6340488Z -        0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-09T23:38:14.6341342Z -        0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-09T23:38:14.6342200Z -        0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.6343234Z -        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-09T23:38:14.6344536Z +        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4,
2025-11-09T23:38:14.6345287Z +        0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe,
2025-11-09T23:38:14.6346026Z +        0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f,
2025-11-09T23:38:14.6346750Z +        0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-09T23:38:14.6348777Z +        0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc,
2025-11-09T23:38:14.6349492Z +        0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b,
2025-11-09T23:38:14.6350203Z +        0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116,
2025-11-09T23:38:14.6350936Z +        0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-09T23:38:14.6351664Z +        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7,
2025-11-09T23:38:14.6351961Z +        0xc67178f2,
2025-11-09T23:38:14.6352238Z      ];
2025-11-09T23:38:14.6352513Z  
2025-11-09T23:38:14.6352863Z      // Process input data with padding
2025-11-09T23:38:14.6353891Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:73:
2025-11-09T23:38:14.6354588Z      let mut padded = Vec::with_capacity(((data.len() + 9 + 63) / 64) * 64);
2025-11-09T23:38:14.6354950Z      padded.extend_from_slice(data);
2025-11-09T23:38:14.6355225Z -    
2025-11-09T23:38:14.6355497Z +
2025-11-09T23:38:14.6355971Z      // Add padding: 0x80 byte, then zeros, then 64-bit length
2025-11-09T23:38:14.6356296Z      padded.push(0x80);
2025-11-09T23:38:14.6356642Z      let bit_len = (data.len() as u64) * 8;
2025-11-09T23:38:14.6359129Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:102:
2025-11-09T23:38:14.6359464Z          let state1_save = state1;
2025-11-09T23:38:14.6359747Z  
2025-11-09T23:38:14.6360037Z          // Rounds 0-3
2025-11-09T23:38:14.6360750Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32));
2025-11-09T23:38:14.6361074Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6361431Z +            msg0,
2025-11-09T23:38:14.6361942Z +            _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32),
2025-11-09T23:38:14.6362233Z +        );
2025-11-09T23:38:14.6362676Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6363029Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6363475Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6364616Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:109:
2025-11-09T23:38:14.6364897Z  
2025-11-09T23:38:14.6365193Z          // Rounds 4-7
2025-11-09T23:38:14.6365919Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32));
2025-11-09T23:38:14.6366246Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6366529Z +            msg1,
2025-11-09T23:38:14.6367046Z +            _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32),
2025-11-09T23:38:14.6367330Z +        );
2025-11-09T23:38:14.6367773Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6368131Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6368568Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6369597Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:115:
2025-11-09T23:38:14.6369963Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6370242Z  
2025-11-09T23:38:14.6370541Z          // Rounds 8-11
2025-11-09T23:38:14.6371413Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32));
2025-11-09T23:38:14.6371887Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6372168Z +            msg2,
2025-11-09T23:38:14.6372683Z +            _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32),
2025-11-09T23:38:14.6372965Z +        );
2025-11-09T23:38:14.6373413Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6373764Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6374201Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6375352Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:122:
2025-11-09T23:38:14.6375713Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6375988Z  
2025-11-09T23:38:14.6376292Z          // Rounds 12-15
2025-11-09T23:38:14.6377013Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32));
2025-11-09T23:38:14.6377333Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6377619Z +            msg3,
2025-11-09T23:38:14.6378150Z +            _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32),
2025-11-09T23:38:14.6378431Z +        );
2025-11-09T23:38:14.6378871Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6379231Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6379561Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6380594Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:132:
2025-11-09T23:38:14.6380957Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6381228Z  
2025-11-09T23:38:14.6381525Z          // Rounds 16-19
2025-11-09T23:38:14.6382236Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32));
2025-11-09T23:38:14.6382557Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6382835Z +            msg0,
2025-11-09T23:38:14.6383359Z +            _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32),
2025-11-09T23:38:14.6383651Z +        );
2025-11-09T23:38:14.6384088Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6384558Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6384895Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6385931Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:142:
2025-11-09T23:38:14.6386287Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6386560Z  
2025-11-09T23:38:14.6388593Z          // Rounds 20-23
2025-11-09T23:38:14.6389323Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32));
2025-11-09T23:38:14.6389637Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6389961Z +            msg1,
2025-11-09T23:38:14.6390645Z +            _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32),
2025-11-09T23:38:14.6390927Z +        );
2025-11-09T23:38:14.6391373Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6391730Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6392065Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6393093Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:152:
2025-11-09T23:38:14.6393462Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6393738Z  
2025-11-09T23:38:14.6394038Z          // Rounds 24-27
2025-11-09T23:38:14.6394887Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32));
2025-11-09T23:38:14.6395197Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6395479Z +            msg2,
2025-11-09T23:38:14.6396003Z +            _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32),
2025-11-09T23:38:14.6396289Z +        );
2025-11-09T23:38:14.6396893Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6397369Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6397708Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6400116Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:162:
2025-11-09T23:38:14.6400476Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6400750Z  
2025-11-09T23:38:14.6401053Z          // Rounds 28-31
2025-11-09T23:38:14.6401778Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32));
2025-11-09T23:38:14.6402093Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6402383Z +            msg3,
2025-11-09T23:38:14.6402905Z +            _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32),
2025-11-09T23:38:14.6403182Z +        );
2025-11-09T23:38:14.6403629Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6403992Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6404449Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6405477Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:172:
2025-11-09T23:38:14.6405842Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6406116Z  
2025-11-09T23:38:14.6406417Z          // Rounds 32-35
2025-11-09T23:38:14.6408612Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32));
2025-11-09T23:38:14.6408924Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6409207Z +            msg0,
2025-11-09T23:38:14.6409736Z +            _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32),
2025-11-09T23:38:14.6410012Z +        );
2025-11-09T23:38:14.6410450Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6410805Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6411146Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6412173Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:182:
2025-11-09T23:38:14.6412538Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6412981Z  
2025-11-09T23:38:14.6413280Z          // Rounds 36-39
2025-11-09T23:38:14.6413992Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32));
2025-11-09T23:38:14.6414480Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6414774Z +            msg1,
2025-11-09T23:38:14.6415297Z +            _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32),
2025-11-09T23:38:14.6415573Z +        );
2025-11-09T23:38:14.6416017Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6416369Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6416699Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6417746Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:192:
2025-11-09T23:38:14.6418113Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-09T23:38:14.6418387Z  
2025-11-09T23:38:14.6418687Z          // Rounds 40-43
2025-11-09T23:38:14.6419416Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32));
2025-11-09T23:38:14.6419731Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6420013Z +            msg2,
2025-11-09T23:38:14.6420537Z +            _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32),
2025-11-09T23:38:14.6420813Z +        );
2025-11-09T23:38:14.6421259Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6421619Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6421963Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6423070Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:202:
2025-11-09T23:38:14.6423570Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-09T23:38:14.6423966Z  
2025-11-09T23:38:14.6424262Z          // Rounds 44-47
2025-11-09T23:38:14.6425110Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32));
2025-11-09T23:38:14.6425428Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6425707Z +            msg3,
2025-11-09T23:38:14.6426229Z +            _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32),
2025-11-09T23:38:14.6426504Z +        );
2025-11-09T23:38:14.6426952Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6427305Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-09T23:38:14.6427637Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-09T23:38:14.6428662Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:212:
2025-11-09T23:38:14.6429023Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-09T23:38:14.6429298Z  
2025-11-09T23:38:14.6429603Z          // Rounds 48-51
2025-11-09T23:38:14.6430337Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32));
2025-11-09T23:38:14.6430651Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6430931Z +            msg0,
2025-11-09T23:38:14.6431455Z +            _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32),
2025-11-09T23:38:14.6431731Z +        );
2025-11-09T23:38:14.6432179Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6432546Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-09T23:38:14.6432949Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-09T23:38:14.6434005Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:222:
2025-11-09T23:38:14.6434483Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-09T23:38:14.6435106Z  
2025-11-09T23:38:14.6435429Z          // Rounds 52-55
2025-11-09T23:38:14.6436172Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32));
2025-11-09T23:38:14.6436504Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6436782Z +            msg1,
2025-11-09T23:38:14.6437308Z +            _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32),
2025-11-09T23:38:14.6437593Z +        );
2025-11-09T23:38:14.6438040Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6438392Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-09T23:38:14.6438728Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-09T23:38:14.6439768Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:231:
2025-11-09T23:38:14.6440212Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6440492Z  
2025-11-09T23:38:14.6440799Z          // Rounds 56-59
2025-11-09T23:38:14.6441530Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32));
2025-11-09T23:38:14.6441843Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6442130Z +            msg2,
2025-11-09T23:38:14.6442656Z +            _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32),
2025-11-09T23:38:14.6442934Z +        );
2025-11-09T23:38:14.6443439Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6443802Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-09T23:38:14.6444137Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-09T23:38:14.6445290Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:240:
2025-11-09T23:38:14.6445742Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6446014Z  
2025-11-09T23:38:14.6446321Z          // Rounds 60-63
2025-11-09T23:38:14.6448477Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32));
2025-11-09T23:38:14.6448794Z +        msg = _mm_add_epi32(
2025-11-09T23:38:14.6449240Z +            msg3,
2025-11-09T23:38:14.6449889Z +            _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32),
2025-11-09T23:38:14.6450171Z +        );
2025-11-09T23:38:14.6450612Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-09T23:38:14.6450969Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-09T23:38:14.6451409Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-09T23:38:14.6452431Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:254:
2025-11-09T23:38:14.6452963Z      // state0 contains h0,h1,h4,h5 and state1 contains h2,h3,h6,h7
2025-11-09T23:38:14.6453337Z      // Need to reorder to h0,h1,h2,h3,h4,h5,h6,h7
2025-11-09T23:38:14.6453660Z      let mut result = [0u8; 32];
2025-11-09T23:38:14.6453939Z -    
2025-11-09T23:38:14.6454220Z +
2025-11-09T23:38:14.6454701Z      // Extract and byte-swap each 32-bit word
2025-11-09T23:38:14.6455206Z      let state0_swapped = _mm_shuffle_epi8(state0, shuf_mask);
2025-11-09T23:38:14.6455714Z      let state1_swapped = _mm_shuffle_epi8(state1, shuf_mask);
2025-11-09T23:38:14.6458379Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:261:
2025-11-09T23:38:14.6458658Z -    
2025-11-09T23:38:14.6458938Z +
2025-11-09T23:38:14.6459534Z      _mm_storeu_si128(result.as_mut_ptr() as *mut __m128i, state0_swapped);
2025-11-09T23:38:14.6460183Z      _mm_storeu_si128(result.as_mut_ptr().add(16) as *mut __m128i, state1_swapped);
2025-11-09T23:38:14.6460463Z  
2025-11-09T23:38:14.6461497Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:286:
2025-11-09T23:38:14.6461826Z              fallback_sha256(data)
2025-11-09T23:38:14.6462103Z          }
2025-11-09T23:38:14.6462385Z      }
2025-11-09T23:38:14.6462658Z -    
2025-11-09T23:38:14.6462931Z +
2025-11-09T23:38:14.6463260Z      #[cfg(not(target_arch = "x86_64"))]
2025-11-09T23:38:14.6463540Z      {
2025-11-09T23:38:14.6463863Z          fallback_sha256(data)
2025-11-09T23:38:14.6465653Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:316:
2025-11-09T23:38:14.6465997Z      fn test_sha256_empty() {
2025-11-09T23:38:14.6466304Z          let input = b"";
2025-11-09T23:38:14.6466625Z          let result = sha256(input);
2025-11-09T23:38:14.6466903Z -        
2025-11-09T23:38:14.6467179Z +
2025-11-09T23:38:14.6467990Z          // Expected SHA256(""): e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2025-11-09T23:38:14.6468297Z          let expected = [
2025-11-09T23:38:14.6469035Z -            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24,
2025-11-09T23:38:14.6469736Z -            0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55,
2025-11-09T23:38:14.6470358Z +            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f,
2025-11-09T23:38:14.6470985Z +            0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b,
2025-11-09T23:38:14.6471307Z +            0x78, 0x52, 0xb8, 0x55,
2025-11-09T23:38:14.6471583Z          ];
2025-11-09T23:38:14.6471860Z -        
2025-11-09T23:38:14.6472138Z +
2025-11-09T23:38:14.6472481Z          assert_eq!(result, expected);
2025-11-09T23:38:14.6472771Z      }
2025-11-09T23:38:14.6473058Z  
2025-11-09T23:38:14.6474085Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:330:
2025-11-09T23:38:14.6474547Z      fn test_sha256_hello_world() {
2025-11-09T23:38:14.6474878Z          let input = b"hello world";
2025-11-09T23:38:14.6475208Z          let result = sha256(input);
2025-11-09T23:38:14.6475486Z -        
2025-11-09T23:38:14.6475755Z +
2025-11-09T23:38:14.6476084Z          // Compare with sha2 crate
2025-11-09T23:38:14.6476419Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6476941Z          let expected = Sha256::digest(input);
2025-11-09T23:38:14.6478113Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:337:
2025-11-09T23:38:14.6478393Z -        
2025-11-09T23:38:14.6478666Z +
2025-11-09T23:38:14.6479031Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6479305Z      }
2025-11-09T23:38:14.6479592Z  
2025-11-09T23:38:14.6480953Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:343:
2025-11-09T23:38:14.6481292Z          // Test various input sizes
2025-11-09T23:38:14.6481618Z          let zeros_64 = vec![0u8; 64];
2025-11-09T23:38:14.6481949Z          let ff_128 = vec![0xffu8; 128];
2025-11-09T23:38:14.6482223Z -        
2025-11-09T23:38:14.6482490Z +
2025-11-09T23:38:14.6482832Z          let test_cases: Vec<&[u8]> = vec![
2025-11-09T23:38:14.6483139Z              b"" as &[u8],
2025-11-09T23:38:14.6483412Z              b"a",
2025-11-09T23:38:14.6484576Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:357:
2025-11-09T23:38:14.6484870Z  
2025-11-09T23:38:14.6485199Z          for input in test_cases {
2025-11-09T23:38:14.6485528Z              let result = sha256(input);
2025-11-09T23:38:14.6485808Z -            
2025-11-09T23:38:14.6486079Z +
2025-11-09T23:38:14.6486408Z              // Must match sha2 crate
2025-11-09T23:38:14.6486755Z              use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6487187Z              let expected = Sha256::digest(input);
2025-11-09T23:38:14.6488202Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:364:
2025-11-09T23:38:14.6488474Z -            
2025-11-09T23:38:14.6489168Z -            assert_eq!(&result[..], &expected[..], "Mismatch for input length {}", input.len());
2025-11-09T23:38:14.6489443Z +
2025-11-09T23:38:14.6489738Z +            assert_eq!(
2025-11-09T23:38:14.6490042Z +                &result[..],
2025-11-09T23:38:14.6490356Z +                &expected[..],
2025-11-09T23:38:14.6490710Z +                "Mismatch for input length {}",
2025-11-09T23:38:14.6491024Z +                input.len()
2025-11-09T23:38:14.6491307Z +            );
2025-11-09T23:38:14.6491582Z          }
2025-11-09T23:38:14.6491849Z      }
2025-11-09T23:38:14.6492123Z  
2025-11-09T23:38:14.6493149Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:370:
2025-11-09T23:38:14.6493473Z      fn test_double_sha256() {
2025-11-09T23:38:14.6493797Z          let input = b"hello world";
2025-11-09T23:38:14.6494136Z          let result = hash256(input);
2025-11-09T23:38:14.6494580Z -        
2025-11-09T23:38:14.6494914Z +
2025-11-09T23:38:14.6495349Z          // Manually compute double SHA256 with sha2 crate
2025-11-09T23:38:14.6495682Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6496021Z          let first = Sha256::digest(input);
2025-11-09T23:38:14.6497053Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:377:
2025-11-09T23:38:14.6497432Z          let expected = Sha256::digest(&first);
2025-11-09T23:38:14.6497988Z -        
2025-11-09T23:38:14.6498326Z +
2025-11-09T23:38:14.6498733Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6506505Z      }
2025-11-09T23:38:14.6506859Z  
2025-11-09T23:38:14.6507964Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:384:
2025-11-09T23:38:14.6508371Z          // Test with 64 zero bytes (same as AVX2 test)
2025-11-09T23:38:14.6508715Z          let input = vec![0u8; 64];
2025-11-09T23:38:14.6509064Z          let result = hash256(&input);
2025-11-09T23:38:14.6509351Z -        
2025-11-09T23:38:14.6509637Z +
2025-11-09T23:38:14.6509970Z          // Compare with sha2 crate
2025-11-09T23:38:14.6510323Z          use sha2::{Digest, Sha256};
2025-11-09T23:38:14.6510687Z          let first = Sha256::digest(&input);
2025-11-09T23:38:14.6511979Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:391:
2025-11-09T23:38:14.6512479Z          let expected = Sha256::digest(&first);
2025-11-09T23:38:14.6512969Z -        
2025-11-09T23:38:14.6513266Z +
2025-11-09T23:38:14.6513648Z          assert_eq!(&result[..], &expected[..]);
2025-11-09T23:38:14.6513931Z      }
2025-11-09T23:38:14.6514211Z  }
2025-11-09T23:38:14.6515448Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:396:
2025-11-09T23:38:14.6515734Z -
2025-11-09T23:38:14.6516008Z  
2025-11-09T23:38:14.6517120Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/simd_bytes.rs:99:
2025-11-09T23:38:14.6517446Z          assert_eq!(dst, src);
2025-11-09T23:38:14.6517726Z      }
2025-11-09T23:38:14.6518002Z  }
2025-11-09T23:38:14.6518290Z -
2025-11-09T23:38:14.6518564Z  
2025-11-09T23:38:14.6519619Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:47:
2025-11-09T23:38:14.6519952Z  pub mod transaction;
2025-11-09T23:38:14.6520295Z  pub mod transaction_hash;
2025-11-09T23:38:14.6520605Z  pub mod types;
2025-11-09T23:38:14.6521124Z +#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6521730Z +pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-09T23:38:14.6522071Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6522449Z  pub use script::batch_verify_signatures;
2025-11-09T23:38:14.6522961Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6523888Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:53:
2025-11-09T23:38:14.6524204Z  pub use script::{
2025-11-09T23:38:14.6525008Z -    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool,
2025-11-09T23:38:14.6525416Z -    disable_caching, reset_benchmarking_state,
2025-11-09T23:38:14.6526250Z +    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool, disable_caching,
2025-11-09T23:38:14.6526601Z +    reset_benchmarking_state,
2025-11-09T23:38:14.6526888Z  };
2025-11-09T23:38:14.6527408Z -#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6528010Z -pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-09T23:38:14.6528519Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-09T23:38:14.6528967Z  pub use transaction_hash::clear_sighash_templates;
2025-11-09T23:38:14.6529270Z  pub mod bip113;
2025-11-09T23:38:14.6530242Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mempool.rs:99:
2025-11-09T23:38:14.6530573Z                  .map(|(i, opt_utxo)| {
2025-11-09T23:38:14.6530938Z                      if let Some(utxo) = opt_utxo {
2025-11-09T23:38:14.6531300Z                          let input = &tx.inputs[*i];
2025-11-09T23:38:14.6531696Z -                        let witness: Option<&ByteString> =
2025-11-09T23:38:14.6532244Z -                            witnesses.and_then(|wits| wits.get(*i)).and_then(|wit| {
2025-11-09T23:38:14.6532592Z -                                wit.first()
2025-11-09T23:38:14.6532901Z -                            });
2025-11-09T23:38:14.6533330Z +                        let witness: Option<&ByteString> = witnesses
2025-11-09T23:38:14.6533705Z +                            .and_then(|wits| wits.get(*i))
2025-11-09T23:38:14.6534080Z +                            .and_then(|wit| wit.first());
2025-11-09T23:38:14.6534489Z  
2025-11-09T23:38:14.6535176Z                          verify_script(&input.script_sig, &utxo.script_pubkey, witness, flags)
2025-11-09T23:38:14.6535481Z                      } else {
2025-11-09T23:38:14.6536436Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mining.rs:440:
2025-11-09T23:38:14.6536726Z  }
2025-11-09T23:38:14.6537003Z  
2025-11-09T23:38:14.6537341Z  /// Simple SHA256 hash function
2025-11-09T23:38:14.6537622Z -/// 
2025-11-09T23:38:14.6537903Z +///
2025-11-09T23:38:14.6538935Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-09T23:38:14.6539491Z  /// for faster hashing in Merkle tree construction.
2025-11-09T23:38:14.6539802Z  #[inline(always)]
2025-11-09T23:38:14.6540864Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:239:
2025-11-09T23:38:14.6541545Z      /// - Small batches (< 4 items): Sequential (overhead not worth parallelization)
2025-11-09T23:38:14.6541983Z      /// - Medium batches (4-7 items): Chunked sequential
2025-11-09T23:38:14.6542891Z      /// - Large batches (≥8 items): Multi-core parallelization with Rayon
2025-11-09T23:38:14.6543182Z -    /// 
2025-11-09T23:38:14.6543473Z +    ///
2025-11-09T23:38:14.6543793Z      /// # Optimizations
2025-11-09T23:38:14.6544540Z      /// - Uses sha2 crate with "asm" feature for optimized assembly
2025-11-09T23:38:14.6545313Z      /// - For large batches, leverages Rayon for multi-core parallelization
2025-11-09T23:38:14.6546416Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:287:
2025-11-09T23:38:14.6548554Z                  return avx2_batch::batch_sha256_avx2(inputs);
2025-11-09T23:38:14.6548843Z              }
2025-11-09T23:38:14.6549126Z          }
2025-11-09T23:38:14.6549417Z -        
2025-11-09T23:38:14.6549700Z +
2025-11-09T23:38:14.6550162Z          // Fallback: Multi-core parallelization using Rayon
2025-11-09T23:38:14.6550598Z          // Rayon is enabled via the 'production' feature
2025-11-09T23:38:14.6551115Z          // This leverages multiple CPU cores for parallel hashing
2025-11-09T23:38:14.6552063Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:20:
2025-11-09T23:38:14.6552407Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6552756Z  use std::collections::VecDeque;
2025-11-09T23:38:14.6553094Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6553665Z -use std::sync::{OnceLock, RwLock, atomic::{AtomicBool, Ordering}};
2025-11-09T23:38:14.6553989Z +use std::sync::{
2025-11-09T23:38:14.6554506Z +    atomic::{AtomicBool, Ordering},
2025-11-09T23:38:14.6554819Z +    OnceLock, RwLock,
2025-11-09T23:38:14.6555105Z +};
2025-11-09T23:38:14.6555440Z  #[cfg(feature = "production")]
2025-11-09T23:38:14.6555759Z  use std::thread_local;
2025-11-09T23:38:14.6556039Z  
2025-11-09T23:38:14.6558778Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1044:
2025-11-09T23:38:14.6559280Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-09T23:38:14.6559897Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-09T23:38:14.6560263Z                          if tx.inputs.len() > 1 {
2025-11-09T23:38:14.6560972Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6561314Z +                            let sighashes =
2025-11-09T23:38:14.6561885Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6562251Z                              sighashes[input_index]
2025-11-09T23:38:14.6562561Z                          } else {
2025-11-09T23:38:14.6563087Z                              // Single input: use individual calculation (no overhead)
2025-11-09T23:38:14.6564066Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1051:
2025-11-09T23:38:14.6564962Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-09T23:38:14.6565353Z +                            calculate_transaction_sighash(
2025-11-09T23:38:14.6565674Z +                                tx,
2025-11-09T23:38:14.6566012Z +                                input_index,
2025-11-09T23:38:14.6566341Z +                                prevouts,
2025-11-09T23:38:14.6568430Z +                                SighashType::All,
2025-11-09T23:38:14.6568913Z +                            )?
2025-11-09T23:38:14.6569338Z                          }
2025-11-09T23:38:14.6569629Z                      }
2025-11-09T23:38:14.6570027Z                      #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.6571001Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1091:
2025-11-09T23:38:14.6571501Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-09T23:38:14.6572135Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-09T23:38:14.6572491Z                          if tx.inputs.len() > 1 {
2025-11-09T23:38:14.6573266Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6573617Z +                            let sighashes =
2025-11-09T23:38:14.6574177Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-09T23:38:14.6574747Z                              sighashes[input_index]
2025-11-09T23:38:14.6575084Z                          } else {
2025-11-09T23:38:14.6575608Z                              // Single input: use individual calculation (no overhead)
2025-11-09T23:38:14.6576579Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1098:
2025-11-09T23:38:14.6578694Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-09T23:38:14.6579084Z +                            calculate_transaction_sighash(
2025-11-09T23:38:14.6579396Z +                                tx,
2025-11-09T23:38:14.6579729Z +                                input_index,
2025-11-09T23:38:14.6580467Z +                                prevouts,
2025-11-09T23:38:14.6580836Z +                                SighashType::All,
2025-11-09T23:38:14.6581503Z +                            )?
2025-11-09T23:38:14.6581810Z                          }
2025-11-09T23:38:14.6582098Z                      }
2025-11-09T23:38:14.6582496Z                      #[cfg(not(feature = "production"))]
2025-11-09T23:38:14.6583489Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1474:
2025-11-09T23:38:14.6583813Z      clear_all_caches();
2025-11-09T23:38:14.6584126Z      clear_stack_pool();
2025-11-09T23:38:14.6584765Z      disable_caching(false); // Re-enable caching by default
2025-11-09T23:38:14.6585555Z -    // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-09T23:38:14.6586354Z +                            // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-09T23:38:14.6586702Z      #[cfg(feature = "benchmarking")]
2025-11-09T23:38:14.6587181Z      crate::transaction_hash::clear_sighash_templates();
2025-11-09T23:38:14.6587467Z  }
2025-11-09T23:38:14.6588399Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/types.rs:32:
2025-11-09T23:38:14.6588952Z  #[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize)]
2025-11-09T23:38:14.6589320Z  pub struct TransactionInput {
2025-11-09T23:38:14.6589898Z      pub prevout: OutPoint,      // Hot: 40 bytes (frequently accessed)
2025-11-09T23:38:14.6590527Z -    pub sequence: Natural,     // Hot: 8 bytes (frequently accessed)
2025-11-09T23:38:14.6591092Z +    pub sequence: Natural,      // Hot: 8 bytes (frequently accessed)
2025-11-09T23:38:14.6591771Z      pub script_sig: ByteString, // Cold: Vec (pointer, less frequently accessed)
2025-11-09T23:38:14.6592054Z  }
2025-11-09T23:38:14.6592330Z  
2025-11-09T23:38:14.7151777Z ##[error]Process completed with exit code 1.
2025-11-09T23:38:14.7351823Z Post job cleanup.
2025-11-09T23:38:14.8557572Z [command]/usr/bin/git version
2025-11-09T23:38:14.8605094Z git version 2.43.0
2025-11-09T23:38:14.8656292Z Copying '/home/jswift/.gitconfig' to '/home/jswift/actions-runner-org2/_work/_temp/3e2470ac-7cdd-4220-b534-dc9e338e4730/.gitconfig'
2025-11-09T23:38:14.8668182Z Temporarily overriding HOME='/home/jswift/actions-runner-org2/_work/_temp/3e2470ac-7cdd-4220-b534-dc9e338e4730' before making global git config changes
2025-11-09T23:38:14.8672046Z Adding repository directory to the temporary git global config as a safe directory
2025-11-09T23:38:14.8675670Z [command]/usr/bin/git config --global --add safe.directory /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus
2025-11-09T23:38:14.8720931Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-11-09T23:38:14.8767457Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-11-09T23:38:14.9051935Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-11-09T23:38:14.9076535Z http.https://github.com/.extraheader
2025-11-09T23:38:14.9093374Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2025-11-09T23:38:14.9135517Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-11-09T23:38:14.9571317Z A job completed hook has been configured by the self-hosted runner administrator
2025-11-09T23:38:14.9633768Z ##[group]Run '/home/jswift/actions-runner-org2/cleanup-hooks/job-completed.sh'
2025-11-09T23:38:14.9665534Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-09T23:38:14.9668449Z ##[endgroup]
2025-11-09T23:38:14.9753153Z Job completed: Sun Nov  9 11:38:14 PM UTC 2025
2025-11-09T23:38:14.9788547Z Available disk space: 12G
2025-11-09T23:38:14.9789535Z Cleaning up after job completion...
2025-11-09T23:38:15.0483005Z Cleanup completed. Available disk space: 12G
2025-11-09T23:38:15.0554633Z Cleaning up orphan processes
