2025-11-10T00:04:25.0520025Z Current runner version: '2.329.0'
2025-11-10T00:04:25.0531187Z Runner name: 'linode-runner-02'
2025-11-10T00:04:25.0532023Z Runner group name: 'default'
2025-11-10T00:04:25.0533019Z Machine name: 'localhost'
2025-11-10T00:04:25.0536419Z ##[group]GITHUB_TOKEN Permissions
2025-11-10T00:04:25.0538726Z Contents: read
2025-11-10T00:04:25.0539353Z Metadata: read
2025-11-10T00:04:25.0539962Z Packages: read
2025-11-10T00:04:25.0540584Z ##[endgroup]
2025-11-10T00:04:25.0542758Z Secret source: Actions
2025-11-10T00:04:25.0543555Z Prepare workflow directory
2025-11-10T00:04:25.1222629Z Prepare all required actions
2025-11-10T00:04:25.1272169Z Getting action download info
2025-11-10T00:04:25.4066053Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-11-10T00:04:25.8273592Z Download action repository 'dtolnay/rust-toolchain@master' (SHA:6d653acede28d24f02e3cd41383119e8b1b35921)
2025-11-10T00:04:26.2062720Z Complete job name: Rustfmt
2025-11-10T00:04:26.2717539Z A job started hook has been configured by the self-hosted runner administrator
2025-11-10T00:04:26.2885824Z ##[group]Run '/home/jswift/actions-runner-org2/cleanup-hooks/job-started.sh'
2025-11-10T00:04:26.2920094Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:26.2921111Z ##[endgroup]
2025-11-10T00:04:26.3102360Z Job started: Mon Nov 10 12:04:26 AM UTC 2025
2025-11-10T00:04:26.3122844Z Available disk space: 9.2G
2025-11-10T00:04:26.3162790Z WARNING: Disk usage is 82% - performing user-level cleanup
2025-11-10T00:04:26.3165444Z Cleaning old work directories (user-level cleanup)...
2025-11-10T00:04:26.4171413Z User-level cleanup completed. Disk usage: 82%
2025-11-10T00:04:26.4447621Z ##[group]Run actions/checkout@v4
2025-11-10T00:04:26.4448263Z with:
2025-11-10T00:04:26.4448724Z   repository: BTCDecoded/bllvm-consensus
2025-11-10T00:04:26.4449491Z   token: ***
2025-11-10T00:04:26.4449943Z   ssh-strict: true
2025-11-10T00:04:26.4450400Z   ssh-user: git
2025-11-10T00:04:26.4450859Z   persist-credentials: true
2025-11-10T00:04:26.4451392Z   clean: true
2025-11-10T00:04:26.4451850Z   sparse-checkout-cone-mode: true
2025-11-10T00:04:26.4452389Z   fetch-depth: 1
2025-11-10T00:04:26.4452847Z   fetch-tags: false
2025-11-10T00:04:26.4453299Z   show-progress: true
2025-11-10T00:04:26.4453770Z   lfs: false
2025-11-10T00:04:26.4454196Z   submodules: false
2025-11-10T00:04:26.4454824Z   set-safe-directory: true
2025-11-10T00:04:26.4455317Z env:
2025-11-10T00:04:26.4455747Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:26.4456235Z ##[endgroup]
2025-11-10T00:04:26.5841400Z Syncing repository: BTCDecoded/bllvm-consensus
2025-11-10T00:04:26.5845206Z ##[group]Getting Git version info
2025-11-10T00:04:26.5847480Z Working directory is '/home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus'
2025-11-10T00:04:26.5849708Z [command]/usr/bin/git version
2025-11-10T00:04:26.5850611Z git version 2.43.0
2025-11-10T00:04:26.5858728Z ##[endgroup]
2025-11-10T00:04:26.5879300Z Copying '/home/jswift/.gitconfig' to '/home/jswift/actions-runner-org2/_work/_temp/77ae0010-8ed8-47b9-a513-c0d82cd6f857/.gitconfig'
2025-11-10T00:04:26.5897154Z Temporarily overriding HOME='/home/jswift/actions-runner-org2/_work/_temp/77ae0010-8ed8-47b9-a513-c0d82cd6f857' before making global git config changes
2025-11-10T00:04:26.5900372Z Adding repository directory to the temporary git global config as a safe directory
2025-11-10T00:04:26.5916383Z [command]/usr/bin/git config --global --add safe.directory /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus
2025-11-10T00:04:26.5966153Z [command]/usr/bin/git config --local --get remote.origin.url
2025-11-10T00:04:26.5998365Z https://github.com/BTCDecoded/bllvm-consensus
2025-11-10T00:04:26.6021737Z ##[group]Removing previously created refs, to avoid conflicts
2025-11-10T00:04:26.6027407Z [command]/usr/bin/git rev-parse --symbolic-full-name --verify --quiet HEAD
2025-11-10T00:04:26.6056115Z refs/heads/main
2025-11-10T00:04:26.6069786Z [command]/usr/bin/git checkout --detach
2025-11-10T00:04:26.6712684Z HEAD is now at f1ff386 fix: Update test imports from consensus_proof to bllvm_consensus
2025-11-10T00:04:26.6771630Z [command]/usr/bin/git branch --delete --force main
2025-11-10T00:04:26.6804985Z Deleted branch main (was f1ff386).
2025-11-10T00:04:26.6848682Z ##[endgroup]
2025-11-10T00:04:26.6852698Z [command]/usr/bin/git submodule status
2025-11-10T00:04:26.7129141Z ##[group]Cleaning the repository
2025-11-10T00:04:26.7132461Z [command]/usr/bin/git clean -ffdx
2025-11-10T00:04:26.7209334Z [command]/usr/bin/git reset --hard HEAD
2025-11-10T00:04:26.7304206Z HEAD is now at f1ff386 fix: Update test imports from consensus_proof to bllvm_consensus
2025-11-10T00:04:26.7313255Z ##[endgroup]
2025-11-10T00:04:26.7315031Z ##[group]Disabling automatic garbage collection
2025-11-10T00:04:26.7319667Z [command]/usr/bin/git config --local gc.auto 0
2025-11-10T00:04:26.7360208Z ##[endgroup]
2025-11-10T00:04:26.7361645Z ##[group]Setting up auth
2025-11-10T00:04:26.7367212Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-11-10T00:04:26.7406857Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-11-10T00:04:26.7696104Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-11-10T00:04:26.7732325Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-11-10T00:04:26.8039720Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2025-11-10T00:04:26.8081943Z ##[endgroup]
2025-11-10T00:04:26.8083555Z ##[group]Fetching the repository
2025-11-10T00:04:26.8092469Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +f1ff38664dd5deaaa46fc9d342df1d4aa6559aca:refs/remotes/origin/main
2025-11-10T00:04:27.0654086Z ##[endgroup]
2025-11-10T00:04:27.0656613Z ##[group]Determining the checkout info
2025-11-10T00:04:27.0661405Z ##[endgroup]
2025-11-10T00:04:27.0662694Z [command]/usr/bin/git sparse-checkout disable
2025-11-10T00:04:27.0729667Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2025-11-10T00:04:27.0767862Z ##[group]Checking out the ref
2025-11-10T00:04:27.0771558Z [command]/usr/bin/git checkout --progress --force -B main refs/remotes/origin/main
2025-11-10T00:04:27.0860882Z Switched to a new branch 'main'
2025-11-10T00:04:27.0864219Z branch 'main' set up to track 'origin/main'.
2025-11-10T00:04:27.0871675Z ##[endgroup]
2025-11-10T00:04:27.0918892Z [command]/usr/bin/git log -1 --format=%H
2025-11-10T00:04:27.0951814Z f1ff38664dd5deaaa46fc9d342df1d4aa6559aca
2025-11-10T00:04:27.1505287Z ##[group]Run dtolnay/rust-toolchain@master
2025-11-10T00:04:27.1508363Z with:
2025-11-10T00:04:27.1509208Z   toolchain: 1.88.0
2025-11-10T00:04:27.1510612Z   components: rustfmt
2025-11-10T00:04:27.1511538Z env:
2025-11-10T00:04:27.1512388Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.1513419Z ##[endgroup]
2025-11-10T00:04:27.1680324Z ##[group]Run : parse toolchain version
2025-11-10T00:04:27.1682068Z [36;1m: parse toolchain version[0m
2025-11-10T00:04:27.1683207Z [36;1mif [[ -z $toolchain ]]; then[0m
2025-11-10T00:04:27.1685362Z [36;1m  # GitHub does not enforce `required: true` inputs itself. https://github.com/actions/runner/issues/1070[0m
2025-11-10T00:04:27.1687454Z [36;1m  echo "'toolchain' is a required input" >&2[0m
2025-11-10T00:04:27.1690096Z [36;1m  exit 1[0m
2025-11-10T00:04:27.1691394Z [36;1melif [[ $toolchain =~ ^stable' '[0-9]+' '(year|month|week|day)s?' 'ago$ ]]; then[0m
2025-11-10T00:04:27.1692969Z [36;1m  if [[ Linux == macOS ]]; then[0m
2025-11-10T00:04:27.1695066Z [36;1m    echo "toolchain=1.$((($(date -v-$(sed 's/stable \([0-9]*\) \(.\).*/\1\2/' <<< $toolchain) +%s)/60/60/24-16569)/7/6))" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1697210Z [36;1m  else[0m
2025-11-10T00:04:27.1699062Z [36;1m    echo "toolchain=1.$((($(date --date "${toolchain#stable }" +%s)/60/60/24-16569)/7/6))" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1700845Z [36;1m  fi[0m
2025-11-10T00:04:27.1702035Z [36;1melif [[ $toolchain =~ ^stable' 'minus' '[0-9]+' 'releases?$ ]]; then[0m
2025-11-10T00:04:27.1704198Z [36;1m  echo "toolchain=1.$((($(date +%s)/60/60/24-16569)/7/6-${toolchain//[^0-9]/}))" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1706135Z [36;1melif [[ $toolchain =~ ^1\.[0-9]+$ ]]; then[0m
2025-11-10T00:04:27.1709519Z [36;1m  echo "toolchain=1.$((i=${toolchain#1.}, c=($(date +%s)/60/60/24-16569)/7/6, i+9*i*(10*i<=c)+90*i*(100*i<=c)))" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1711405Z [36;1melse[0m
2025-11-10T00:04:27.1712417Z [36;1m  echo "toolchain=$toolchain" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1713639Z [36;1mfi[0m
2025-11-10T00:04:27.1746503Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.1747835Z env:
2025-11-10T00:04:27.1748621Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.1749573Z   toolchain: 1.88.0
2025-11-10T00:04:27.1750415Z ##[endgroup]
2025-11-10T00:04:27.1917678Z ##[group]Run : construct rustup command line
2025-11-10T00:04:27.1918991Z [36;1m: construct rustup command line[0m
2025-11-10T00:04:27.1920724Z [36;1mecho "targets=$(for t in ${targets//,/ }; do echo -n ' --target' $t; done)" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1923077Z [36;1mecho "components=$(for c in ${components//,/ }; do echo -n ' --component' $c; done)" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1925223Z [36;1mecho "downgrade=" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.1953327Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.1954939Z env:
2025-11-10T00:04:27.1955742Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.1956705Z   targets: 
2025-11-10T00:04:27.1957503Z   components: rustfmt
2025-11-10T00:04:27.1958379Z ##[endgroup]
2025-11-10T00:04:27.2113272Z ##[group]Run : set $CARGO_HOME
2025-11-10T00:04:27.2114539Z [36;1m: set $CARGO_HOME[0m
2025-11-10T00:04:27.2115868Z [36;1mecho CARGO_HOME=${CARGO_HOME:-"$HOME/.cargo"} >> $GITHUB_ENV[0m
2025-11-10T00:04:27.2143641Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.2145222Z env:
2025-11-10T00:04:27.2146011Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.2146936Z ##[endgroup]
2025-11-10T00:04:27.2306961Z ##[group]Run : install rustup if needed
2025-11-10T00:04:27.2310693Z [36;1m: install rustup if needed[0m
2025-11-10T00:04:27.2312719Z [36;1mif ! command -v rustup &>/dev/null; then[0m
2025-11-10T00:04:27.2319250Z [36;1m  curl --proto '=https' --tlsv1.2 --retry 10 --retry-connrefused --location --silent --show-error --fail https://sh.rustup.rs | sh -s -- --default-toolchain none -y[0m
2025-11-10T00:04:27.2324070Z [36;1m  echo "$CARGO_HOME/bin" >> $GITHUB_PATH[0m
2025-11-10T00:04:27.2328138Z [36;1mfi[0m
2025-11-10T00:04:27.2372563Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.2373880Z env:
2025-11-10T00:04:27.2374883Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.2377464Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:27.2378447Z ##[endgroup]
2025-11-10T00:04:27.2975241Z info: downloading installer
2025-11-10T00:04:27.5886326Z warn: It looks like you have an existing rustup settings file at:
2025-11-10T00:04:27.5888406Z warn: /home/jswift/.rustup/settings.toml
2025-11-10T00:04:27.5890624Z warn: Rustup will install the default toolchain as specified in the settings file,
2025-11-10T00:04:27.5893584Z warn: instead of the one inferred from the default host triple.
2025-11-10T00:04:27.6184935Z info: profile set to 'default'
2025-11-10T00:04:27.6186056Z 
2025-11-10T00:04:27.6186138Z 
2025-11-10T00:04:27.6186698Z Rust is installed now. Great!
2025-11-10T00:04:27.6189303Z 
2025-11-10T00:04:27.6189975Z To get started you may need to restart your current shell.
2025-11-10T00:04:27.6191579Z This would reload your PATH environment variable to include
2025-11-10T00:04:27.6193454Z Cargo's bin directory ($HOME/.cargo/bin).
2025-11-10T00:04:27.6194580Z 
2025-11-10T00:04:27.6195480Z To configure your current shell, you need to source
2025-11-10T00:04:27.6198855Z the corresponding env file under $HOME/.cargo.
2025-11-10T00:04:27.6199802Z 
2025-11-10T00:04:27.6200793Z This is usually done by running one of the following (note the leading DOT):
2025-11-10T00:04:27.6203103Z . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
2025-11-10T00:04:27.6204794Z source "$HOME/.cargo/env.fish"  # For fish
2025-11-10T00:04:27.6208002Z source $"($nu.home-path)/.cargo/env.nu"  # For nushell
2025-11-10T00:04:27.6209367Z info: default host triple is x86_64-unknown-linux-gnu
2025-11-10T00:04:27.6210616Z info: skipping toolchain installation
2025-11-10T00:04:27.6373389Z ##[group]Run rustup toolchain install 1.88.0 --component rustfmt --profile minimal --no-self-update
2025-11-10T00:04:27.6377853Z [36;1mrustup toolchain install 1.88.0 --component rustfmt --profile minimal --no-self-update[0m
2025-11-10T00:04:27.6422700Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.6423940Z env:
2025-11-10T00:04:27.6424963Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.6425902Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:27.6426857Z ##[endgroup]
2025-11-10T00:04:27.7357005Z info: syncing channel updates for '1.88.0-x86_64-unknown-linux-gnu'
2025-11-10T00:04:27.8032943Z info: latest update on 2025-06-26, rust version 1.88.0 (6b00bc388 2025-06-23)
2025-11-10T00:04:27.8356425Z info: component 'rustfmt' for target 'x86_64-unknown-linux-gnu' is up to date
2025-11-10T00:04:27.8380089Z 
2025-11-10T00:04:27.8521139Z   1.88.0-x86_64-unknown-linux-gnu unchanged - rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-10T00:04:27.8523493Z 
2025-11-10T00:04:27.8615313Z ##[group]Run rustup default 1.88.0
2025-11-10T00:04:27.8616392Z [36;1mrustup default 1.88.0[0m
2025-11-10T00:04:27.8653150Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.8654600Z env:
2025-11-10T00:04:27.8655349Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.8656259Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:27.8657190Z ##[endgroup]
2025-11-10T00:04:27.8792419Z info: using existing install for '1.88.0-x86_64-unknown-linux-gnu'
2025-11-10T00:04:27.9188372Z info: default toolchain set to '1.88.0-x86_64-unknown-linux-gnu'
2025-11-10T00:04:27.9190077Z 
2025-11-10T00:04:27.9311863Z   1.88.0-x86_64-unknown-linux-gnu unchanged - rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-10T00:04:27.9315611Z 
2025-11-10T00:04:27.9318076Z info: note that the toolchain '1.88.0-x86_64-unknown-linux-gnu' is currently in use (overridden by '/home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/rust-toolchain.toml')
2025-11-10T00:04:27.9403787Z ##[group]Run : create cachekey
2025-11-10T00:04:27.9405225Z [36;1m: create cachekey[0m
2025-11-10T00:04:27.9406919Z [36;1mDATE=$(rustc +1.88.0 --version --verbose | sed -ne 's/^commit-date: \(20[0-9][0-9]\)-\([01][0-9]\)-\([0-3][0-9]\)$/\1\2\3/p')[0m
2025-11-10T00:04:27.9410504Z [36;1mHASH=$(rustc +1.88.0 --version --verbose | sed -ne 's/^commit-hash: //p')[0m
2025-11-10T00:04:27.9412204Z [36;1mecho "cachekey=$(echo $DATE$HASH | head -c12)" >> $GITHUB_OUTPUT[0m
2025-11-10T00:04:27.9447650Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:27.9448839Z env:
2025-11-10T00:04:27.9449533Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:27.9450424Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:27.9451337Z ##[endgroup]
2025-11-10T00:04:28.0020563Z ##[group]Run : disable incremental compilation
2025-11-10T00:04:28.0021752Z [36;1m: disable incremental compilation[0m
2025-11-10T00:04:28.0022921Z [36;1mif [ -z "${CARGO_INCREMENTAL+set}" ]; then[0m
2025-11-10T00:04:28.0024110Z [36;1m  echo CARGO_INCREMENTAL=0 >> $GITHUB_ENV[0m
2025-11-10T00:04:28.0025547Z [36;1mfi[0m
2025-11-10T00:04:28.0079106Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:28.0080299Z env:
2025-11-10T00:04:28.0081791Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.0082723Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.0083708Z ##[endgroup]
2025-11-10T00:04:28.0211706Z ##[group]Run : enable colors in Cargo output
2025-11-10T00:04:28.0212833Z [36;1m: enable colors in Cargo output[0m
2025-11-10T00:04:28.0214595Z [36;1mif [ -z "${CARGO_TERM_COLOR+set}" ]; then[0m
2025-11-10T00:04:28.0215848Z [36;1m  echo CARGO_TERM_COLOR=always >> $GITHUB_ENV[0m
2025-11-10T00:04:28.0216917Z [36;1mfi[0m
2025-11-10T00:04:28.0248055Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:28.0249233Z env:
2025-11-10T00:04:28.0249947Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.0250838Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.0251786Z   CARGO_INCREMENTAL: 0
2025-11-10T00:04:28.0252583Z ##[endgroup]
2025-11-10T00:04:28.0384963Z ##[group]Run : enable Cargo sparse registry
2025-11-10T00:04:28.0387782Z [36;1m: enable Cargo sparse registry[0m
2025-11-10T00:04:28.0389105Z [36;1m# implemented in 1.66, stabilized in 1.68, made default in 1.70[0m
2025-11-10T00:04:28.0391839Z [36;1mif [ -z "${CARGO_REGISTRIES_CRATES_IO_PROTOCOL+set}" -o -f "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol ]; then[0m
2025-11-10T00:04:28.0394657Z [36;1m  if rustc +1.88.0 --version --verbose | grep -q '^release: 1\.6[89]\.'; then[0m
2025-11-10T00:04:28.0396874Z [36;1m    touch "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol || true[0m
2025-11-10T00:04:28.0399030Z [36;1m    echo CARGO_REGISTRIES_CRATES_IO_PROTOCOL=sparse >> $GITHUB_ENV[0m
2025-11-10T00:04:28.0400750Z [36;1m  elif rustc +1.88.0 --version --verbose | grep -q '^release: 1\.6[67]\.'; then[0m
2025-11-10T00:04:28.0402989Z [36;1m    touch "/home/jswift/actions-runner-org2/_work/_temp"/.implicit_cargo_registries_crates_io_protocol || true[0m
2025-11-10T00:04:28.0405768Z [36;1m    echo CARGO_REGISTRIES_CRATES_IO_PROTOCOL=git >> $GITHUB_ENV[0m
2025-11-10T00:04:28.0408269Z [36;1m  fi[0m
2025-11-10T00:04:28.0408980Z [36;1mfi[0m
2025-11-10T00:04:28.0443174Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:28.0444637Z env:
2025-11-10T00:04:28.0445439Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.0446358Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.0447300Z   CARGO_INCREMENTAL: 0
2025-11-10T00:04:28.0448102Z ##[endgroup]
2025-11-10T00:04:28.0978983Z ##[group]Run : work around spurious network errors in curl 8.0
2025-11-10T00:04:28.0980449Z [36;1m: work around spurious network errors in curl 8.0[0m
2025-11-10T00:04:28.0982576Z [36;1m# https://rust-lang.zulipchat.com/#narrow/stream/246057-t-cargo/topic/timeout.20investigation[0m
2025-11-10T00:04:28.0985002Z [36;1mif rustc +1.88.0 --version --verbose | grep -q '^release: 1\.7[01]\.'; then[0m
2025-11-10T00:04:28.0988763Z [36;1m  echo CARGO_HTTP_MULTIPLEXING=false >> $GITHUB_ENV[0m
2025-11-10T00:04:28.0990033Z [36;1mfi[0m
2025-11-10T00:04:28.1029642Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:28.1030857Z env:
2025-11-10T00:04:28.1031554Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.1032466Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.1033405Z   CARGO_INCREMENTAL: 0
2025-11-10T00:04:28.1034199Z ##[endgroup]
2025-11-10T00:04:28.1357902Z ##[group]Run rustc +1.88.0 --version --verbose
2025-11-10T00:04:28.1359063Z [36;1mrustc +1.88.0 --version --verbose[0m
2025-11-10T00:04:28.1392284Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:28.1393458Z env:
2025-11-10T00:04:28.1394167Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.1395328Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.1396273Z   CARGO_INCREMENTAL: 0
2025-11-10T00:04:28.1397066Z ##[endgroup]
2025-11-10T00:04:28.1653432Z rustc 1.88.0 (6b00bc388 2025-06-23)
2025-11-10T00:04:28.1655118Z binary: rustc
2025-11-10T00:04:28.1656152Z commit-hash: 6b00bc3880198600130e1cf62b8f8a93494488cc
2025-11-10T00:04:28.1659679Z commit-date: 2025-06-23
2025-11-10T00:04:28.1660891Z host: x86_64-unknown-linux-gnu
2025-11-10T00:04:28.1661790Z release: 1.88.0
2025-11-10T00:04:28.1662540Z LLVM version: 20.1.5
2025-11-10T00:04:28.1787125Z ##[group]Run cargo fmt -- --check
2025-11-10T00:04:28.1788268Z [36;1mcargo fmt -- --check[0m
2025-11-10T00:04:28.1825209Z shell: /usr/bin/bash -e {0}
2025-11-10T00:04:28.1826173Z env:
2025-11-10T00:04:28.1826975Z   CARGO_TERM_COLOR: always
2025-11-10T00:04:28.1827973Z   CARGO_HOME: /home/jswift/.cargo
2025-11-10T00:04:28.1830741Z   CARGO_INCREMENTAL: 0
2025-11-10T00:04:28.1831653Z ##[endgroup]
2025-11-10T00:04:28.4305950Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:4:
2025-11-10T00:04:28.4312852Z  use consensus_proof::block::connect_block;
2025-11-10T00:04:28.4314036Z  use consensus_proof::segwit::Witness;
2025-11-10T00:04:28.4315596Z  use consensus_proof::{
2025-11-10T00:04:28.4317045Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet,
2025-11-10T00:04:28.4319284Z +    Block, BlockHeader, OutPoint, Transaction, TransactionInput, TransactionOutput, UtxoSet,
2025-11-10T00:04:28.4320883Z  };
2025-11-10T00:04:28.4321932Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-10T00:04:28.4323290Z  
2025-11-10T00:04:28.4325189Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:23:
2025-11-10T00:04:28.4327215Z              sequence: 0xffffffff,
2025-11-10T00:04:28.4328119Z          }],
2025-11-10T00:04:28.4328897Z          outputs: vec![TransactionOutput {
2025-11-10T00:04:28.4329934Z -            value: 50_000_000_000, // 50 BTC
2025-11-10T00:04:28.4330960Z +            value: 50_000_000_000,     // 50 BTC
2025-11-10T00:04:28.4332018Z              script_pubkey: vec![0x51], // OP_1
2025-11-10T00:04:28.4332994Z          }],
2025-11-10T00:04:28.4333709Z          lock_time: 0,
2025-11-10T00:04:28.4335719Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:44:
2025-11-10T00:04:28.4337687Z              }],
2025-11-10T00:04:28.4338458Z              outputs: vec![
2025-11-10T00:04:28.4339366Z                  TransactionOutput {
2025-11-10T00:04:28.4340366Z -                    value: 10_000_000, // 0.1 BTC
2025-11-10T00:04:28.4341442Z +                    value: 10_000_000,             // 0.1 BTC
2025-11-10T00:04:28.4342609Z                      script_pubkey: vec![0x51; 25], // Longer script
2025-11-10T00:04:28.4343685Z                  },
2025-11-10T00:04:28.4408561Z                  TransactionOutput {
2025-11-10T00:04:28.4411775Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/block_validation_realistic.rs:113:
2025-11-10T00:04:28.4414027Z      benchmark_connect_block_realistic_1000tx
2025-11-10T00:04:28.4415438Z  );
2025-11-10T00:04:28.4416173Z  criterion_main!(benches);
2025-11-10T00:04:28.4418891Z -
2025-11-10T00:04:28.4419576Z  
2025-11-10T00:04:28.4437194Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:1:
2025-11-10T00:04:28.4439223Z +use bllvm_consensus::crypto::OptimizedSha256;
2025-11-10T00:04:28.4440645Z  use criterion::{black_box, criterion_group, criterion_main, Criterion};
2025-11-10T00:04:28.4441992Z  use sha2::{Digest, Sha256};
2025-11-10T00:04:28.4443007Z -use bllvm_consensus::crypto::OptimizedSha256;
2025-11-10T00:04:28.4444053Z  
2025-11-10T00:04:28.4445095Z  fn benchmark_sha256(c: &mut Criterion) {
2025-11-10T00:04:28.4446131Z      let data = vec![0u8; 1024];
2025-11-10T00:04:28.4447884Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:29:
2025-11-10T00:04:28.4449719Z  #[cfg(target_arch = "x86_64")]
2025-11-10T00:04:28.4450707Z  fn benchmark_sha_ni_single(c: &mut Criterion) {
2025-11-10T00:04:28.4451821Z      use bllvm_consensus::crypto::sha_ni;
2025-11-10T00:04:28.4452766Z -    
2025-11-10T00:04:28.4455856Z +
2025-11-10T00:04:28.4456604Z      if !sha_ni::is_sha_ni_available() {
2025-11-10T00:04:28.4457664Z          return; // Skip on CPUs without SHA-NI
2025-11-10T00:04:28.4458900Z      }
2025-11-10T00:04:28.4460549Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:36:
2025-11-10T00:04:28.4462342Z -    
2025-11-10T00:04:28.4462992Z +
2025-11-10T00:04:28.4463696Z      let data_32b = vec![0u8; 32];
2025-11-10T00:04:28.4464863Z      let data_64b = vec![0u8; 64];
2025-11-10T00:04:28.4467625Z      let data_1kb = vec![0u8; 1024];
2025-11-10T00:04:28.4469397Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:40:
2025-11-10T00:04:28.4471168Z -    
2025-11-10T00:04:28.4471812Z +
2025-11-10T00:04:28.4472572Z      // 32-byte input (typical transaction hash)
2025-11-10T00:04:28.4473647Z      c.bench_function("sha_ni_32b", |b| {
2025-11-10T00:04:28.4475210Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_32b))))
2025-11-10T00:04:28.4478804Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:44:
2025-11-10T00:04:28.4480597Z      });
2025-11-10T00:04:28.4481446Z -    
2025-11-10T00:04:28.4482101Z +
2025-11-10T00:04:28.4482854Z      c.bench_function("sha2_crate_32b", |b| {
2025-11-10T00:04:28.4483846Z          b.iter(|| {
2025-11-10T00:04:28.4485051Z              let hash = Sha256::digest(black_box(&data_32b));
2025-11-10T00:04:28.4486978Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:49:
2025-11-10T00:04:28.4488807Z              black_box(hash)
2025-11-10T00:04:28.4489643Z          })
2025-11-10T00:04:28.4490313Z      });
2025-11-10T00:04:28.4490961Z -    
2025-11-10T00:04:28.4491601Z +
2025-11-10T00:04:28.4492347Z      // 64-byte input (typical block header)
2025-11-10T00:04:28.4493380Z      c.bench_function("sha_ni_64b", |b| {
2025-11-10T00:04:28.4494755Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_64b))))
2025-11-10T00:04:28.4498650Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:56:
2025-11-10T00:04:28.4500863Z      });
2025-11-10T00:04:28.4501519Z -    
2025-11-10T00:04:28.4502176Z +
2025-11-10T00:04:28.4502931Z      c.bench_function("sha2_crate_64b", |b| {
2025-11-10T00:04:28.4503920Z          b.iter(|| {
2025-11-10T00:04:28.4505468Z              let hash = Sha256::digest(black_box(&data_64b));
2025-11-10T00:04:28.4509373Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:61:
2025-11-10T00:04:28.4511195Z              black_box(hash)
2025-11-10T00:04:28.4512215Z          })
2025-11-10T00:04:28.4512902Z      });
2025-11-10T00:04:28.4513553Z -    
2025-11-10T00:04:28.4514418Z +
2025-11-10T00:04:28.4515507Z      // 1KB input
2025-11-10T00:04:28.4518338Z      c.bench_function("sha_ni_1kb", |b| {
2025-11-10T00:04:28.4519946Z          b.iter(|| black_box(sha_ni::sha256(black_box(&data_1kb))))
2025-11-10T00:04:28.4521978Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:68:
2025-11-10T00:04:28.4524023Z      });
2025-11-10T00:04:28.4524982Z -    
2025-11-10T00:04:28.4525642Z +
2025-11-10T00:04:28.4526349Z      // Double SHA256 comparison
2025-11-10T00:04:28.4527367Z      c.bench_function("sha_ni_double_32b", |b| {
2025-11-10T00:04:28.4528638Z          b.iter(|| black_box(sha_ni::hash256(black_box(&data_32b))))
2025-11-10T00:04:28.4530672Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:73:
2025-11-10T00:04:28.4532448Z      });
2025-11-10T00:04:28.4533099Z -    
2025-11-10T00:04:28.4533747Z +
2025-11-10T00:04:28.4534899Z      c.bench_function("sha2_crate_double_32b", |b| {
2025-11-10T00:04:28.4537756Z          b.iter(|| {
2025-11-10T00:04:28.4538701Z              let hash1 = Sha256::digest(black_box(&data_32b));
2025-11-10T00:04:28.4540679Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:194:
2025-11-10T00:04:28.4542702Z  
2025-11-10T00:04:28.4543572Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.4544879Z  fn benchmark_merkle_root_batching(c: &mut Criterion) {
2025-11-10T00:04:28.4547773Z -use bllvm_consensus::mining::calculate_merkle_root;
2025-11-10T00:04:28.4549390Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-10T00:04:28.4551028Z +    use bllvm_consensus::mining::calculate_merkle_root;
2025-11-10T00:04:28.4553063Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-10T00:04:28.4556081Z  
2025-11-10T00:04:28.4556822Z      let tx_counts = vec![10, 100, 1000];
2025-11-10T00:04:28.4557751Z  
2025-11-10T00:04:28.4559879Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:232:
2025-11-10T00:04:28.4561777Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.4562897Z  fn benchmark_block_validation_tx_ids(c: &mut Criterion) {
2025-11-10T00:04:28.4564976Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-10T00:04:28.4567948Z -use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-10T00:04:28.4569812Z -use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-10T00:04:28.4571685Z +    use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-10T00:04:28.4573540Z +    use bllvm_consensus::{OutPoint, Transaction, TransactionInput, TransactionOutput};
2025-11-10T00:04:28.4575642Z  
2025-11-10T00:04:28.4576368Z      let tx_counts = vec![10, 100];
2025-11-10T00:04:28.4577263Z  
2025-11-10T00:04:28.4579096Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/hash_operations.rs:539:
2025-11-10T00:04:28.4581138Z  );
2025-11-10T00:04:28.4581947Z  
2025-11-10T00:04:28.4582677Z  #[cfg(not(feature = "production"))]
2025-11-10T00:04:28.4585015Z -criterion_group!(benches, benchmark_sha256, benchmark_double_sha256, benchmark_sha_ni_single);
2025-11-10T00:04:28.4586650Z +criterion_group!(
2025-11-10T00:04:28.4587802Z +    benches,
2025-11-10T00:04:28.4588919Z +    benchmark_sha256,
2025-11-10T00:04:28.4590161Z +    benchmark_double_sha256,
2025-11-10T00:04:28.4591666Z +    benchmark_sha_ni_single
2025-11-10T00:04:28.4592996Z +);
2025-11-10T00:04:28.4594040Z  
2025-11-10T00:04:28.4595458Z  criterion_main!(benches);
2025-11-10T00:04:28.4597019Z  
2025-11-10T00:04:28.4600154Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:11:
2025-11-10T00:04:28.4603151Z  //!
2025-11-10T00:04:28.4605220Z  //! Run with: cargo bench --bench performance_focused --features production
2025-11-10T00:04:28.4607369Z  
2025-11-10T00:04:28.4609259Z -use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-10T00:04:28.4611722Z  use bllvm_consensus::{
2025-11-10T00:04:28.4613293Z -    Block, BlockHeader, Transaction, TransactionInput, TransactionOutput, OutPoint, UtxoSet, UTXO,
2025-11-10T00:04:28.4615272Z -    block::connect_block,
2025-11-10T00:04:28.4616149Z -    segwit::Witness,
2025-11-10T00:04:28.4617429Z +    block::connect_block, segwit::Witness, Block, BlockHeader, OutPoint, Transaction,
2025-11-10T00:04:28.4619058Z +    TransactionInput, TransactionOutput, UtxoSet, UTXO,
2025-11-10T00:04:28.4620145Z  };
2025-11-10T00:04:28.4621325Z +use criterion::{black_box, criterion_group, criterion_main, BenchmarkId, Criterion};
2025-11-10T00:04:28.4622715Z  
2025-11-10T00:04:28.4623482Z  // ============================================================================
2025-11-10T00:04:28.4624822Z  // CRYPTOGRAPHIC OPERATIONS (SHA-NI + AVX2)
2025-11-10T00:04:28.4626794Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:23:
2025-11-10T00:04:28.4628730Z  // ============================================================================
2025-11-10T00:04:28.4629981Z  
2025-11-10T00:04:28.4630745Z  fn bench_hash_single(c: &mut Criterion) {
2025-11-10T00:04:28.4632035Z -    let data_32b = vec![0u8; 32];  // Transaction hash size
2025-11-10T00:04:28.4633294Z -    let data_64b = vec![0u8; 64];  // Block header size
2025-11-10T00:04:28.4634500Z -    
2025-11-10T00:04:28.4635437Z +    let data_32b = vec![0u8; 32]; // Transaction hash size
2025-11-10T00:04:28.4636647Z +    let data_64b = vec![0u8; 64]; // Block header size
2025-11-10T00:04:28.4637660Z +
2025-11-10T00:04:28.4638478Z      let mut group = c.benchmark_group("hash_single");
2025-11-10T00:04:28.4639513Z -    
2025-11-10T00:04:28.4640159Z +
2025-11-10T00:04:28.4641011Z      // Single SHA256 - 32 bytes (typical transaction hash)
2025-11-10T00:04:28.4642194Z      group.bench_function("sha256_32b", |b| {
2025-11-10T00:04:28.4643241Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.4645349Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:36:
2025-11-10T00:04:28.4647250Z              black_box(hash)
2025-11-10T00:04:28.4648090Z          })
2025-11-10T00:04:28.4648751Z      });
2025-11-10T00:04:28.4649413Z -    
2025-11-10T00:04:28.4650051Z +
2025-11-10T00:04:28.4650818Z      // Double SHA256 - 32 bytes (Bitcoin standard)
2025-11-10T00:04:28.4651978Z      group.bench_function("double_sha256_32b", |b| {
2025-11-10T00:04:28.4653332Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.4655530Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:46:
2025-11-10T00:04:28.4659802Z              black_box(hash2)
2025-11-10T00:04:28.4660780Z          })
2025-11-10T00:04:28.4661458Z      });
2025-11-10T00:04:28.4662227Z -    
2025-11-10T00:04:28.4662880Z +
2025-11-10T00:04:28.4663594Z      // Block header hash - 64 bytes
2025-11-10T00:04:28.4664906Z      group.bench_function("double_sha256_64b", |b| {
2025-11-10T00:04:28.4667754Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.4669675Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:56:
2025-11-10T00:04:28.4671559Z              black_box(hash2)
2025-11-10T00:04:28.4672392Z          })
2025-11-10T00:04:28.4673055Z      });
2025-11-10T00:04:28.4673703Z -    
2025-11-10T00:04:28.4674530Z +
2025-11-10T00:04:28.4675208Z      group.finish();
2025-11-10T00:04:28.4675944Z  }
2025-11-10T00:04:28.4676578Z  
2025-11-10T00:04:28.4678158Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:63:
2025-11-10T00:04:28.4680037Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.4681246Z  fn bench_hash_batch(c: &mut Criterion) {
2025-11-10T00:04:28.4682453Z      use bllvm_consensus::optimizations::simd_vectorization;
2025-11-10T00:04:28.4683556Z -    
2025-11-10T00:04:28.4684196Z +
2025-11-10T00:04:28.4685074Z      let data = vec![0u8; 64];
2025-11-10T00:04:28.4686082Z      let mut group = c.benchmark_group("hash_batch");
2025-11-10T00:04:28.4688404Z -    
2025-11-10T00:04:28.4689049Z +
2025-11-10T00:04:28.4689798Z      // Batch sizes that matter in real blocks
2025-11-10T00:04:28.4690847Z      for size in [8, 16, 32, 64, 128].iter() {
2025-11-10T00:04:28.4691976Z          let inputs: Vec<&[u8]> = vec![data.as_slice(); *size];
2025-11-10T00:04:28.4693992Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:73:
2025-11-10T00:04:28.4697870Z -        
2025-11-10T00:04:28.4699075Z -        group.bench_with_input(BenchmarkId::new("avx2_double_sha256", size), size, |b, _| {
2025-11-10T00:04:28.4700511Z -            b.iter(|| {
2025-11-10T00:04:28.4701710Z -                black_box(simd_vectorization::batch_double_sha256(black_box(&inputs)))
2025-11-10T00:04:28.4703011Z -            })
2025-11-10T00:04:28.4703714Z -        });
2025-11-10T00:04:28.4704637Z +
2025-11-10T00:04:28.4705371Z +        group.bench_with_input(
2025-11-10T00:04:28.4706416Z +            BenchmarkId::new("avx2_double_sha256", size),
2025-11-10T00:04:28.4707673Z +            size,
2025-11-10T00:04:28.4710209Z +            |b, _| {
2025-11-10T00:04:28.4711612Z +                b.iter(|| black_box(simd_vectorization::batch_double_sha256(black_box(&inputs))))
2025-11-10T00:04:28.4712985Z +            },
2025-11-10T00:04:28.4713676Z +        );
2025-11-10T00:04:28.4714589Z      }
2025-11-10T00:04:28.4715302Z -    
2025-11-10T00:04:28.4715949Z +
2025-11-10T00:04:28.4716602Z      group.finish();
2025-11-10T00:04:28.4719302Z  }
2025-11-10T00:04:28.4719928Z  
2025-11-10T00:04:28.4721524Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:100:
2025-11-10T00:04:28.4723411Z              sequence: 0xffffffff,
2025-11-10T00:04:28.4724417Z          }],
2025-11-10T00:04:28.4725201Z          outputs: vec![TransactionOutput {
2025-11-10T00:04:28.4726214Z -            value: 1_000_000, // 0.01 BTC
2025-11-10T00:04:28.4727204Z +            value: 1_000_000,          // 0.01 BTC
2025-11-10T00:04:28.4730109Z              script_pubkey: vec![0x51], // OP_1
2025-11-10T00:04:28.4731054Z          }],
2025-11-10T00:04:28.4731757Z          lock_time: 0,
2025-11-10T00:04:28.4733461Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:109:
2025-11-10T00:04:28.4735393Z  
2025-11-10T00:04:28.4736180Z  fn bench_transaction_basics(c: &mut Criterion) {
2025-11-10T00:04:28.4737717Z      let tx = create_simple_transaction();
2025-11-10T00:04:28.4738655Z -    
2025-11-10T00:04:28.4739477Z +
2025-11-10T00:04:28.4740407Z      let mut group = c.benchmark_group("transaction");
2025-11-10T00:04:28.4741442Z -    
2025-11-10T00:04:28.4742083Z +
2025-11-10T00:04:28.4743005Z      // Transaction serialization (needed for tx ID calculation)
2025-11-10T00:04:28.4744250Z      group.bench_function("serialize", |b| {
2025-11-10T00:04:28.4747625Z          use bllvm_consensus::serialization::transaction::serialize_transaction;
2025-11-10T00:04:28.4749884Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:118:
2025-11-10T00:04:28.4752069Z -        b.iter(|| {
2025-11-10T00:04:28.4753013Z -            black_box(serialize_transaction(black_box(&tx)))
2025-11-10T00:04:28.4754071Z -        })
2025-11-10T00:04:28.4756922Z +        b.iter(|| black_box(serialize_transaction(black_box(&tx))))
2025-11-10T00:04:28.4758035Z      });
2025-11-10T00:04:28.4758682Z -    
2025-11-10T00:04:28.4759320Z +
2025-11-10T00:04:28.4760527Z      // Transaction ID calculation (SHA256D of serialized tx)
2025-11-10T00:04:28.4762101Z      group.bench_function("calculate_id", |b| {
2025-11-10T00:04:28.4763292Z          use bllvm_consensus::block::calculate_tx_id;
2025-11-10T00:04:28.4766884Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:126:
2025-11-10T00:04:28.4768760Z -        b.iter(|| {
2025-11-10T00:04:28.4769645Z -            black_box(calculate_tx_id(black_box(&tx)))
2025-11-10T00:04:28.4770972Z -        })
2025-11-10T00:04:28.4771844Z +        b.iter(|| black_box(calculate_tx_id(black_box(&tx))))
2025-11-10T00:04:28.4772905Z      });
2025-11-10T00:04:28.4773564Z -    
2025-11-10T00:04:28.4774203Z +
2025-11-10T00:04:28.4775201Z      group.finish();
2025-11-10T00:04:28.4775955Z  }
2025-11-10T00:04:28.4776591Z  
2025-11-10T00:04:28.4778188Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:153:
2025-11-10T00:04:28.4781081Z                  script_pubkey: vec![0x51],
2025-11-10T00:04:28.4782017Z              }],
2025-11-10T00:04:28.4782746Z              lock_time: 0,
2025-11-10T00:04:28.4783540Z -        }
2025-11-10T00:04:28.4784200Z +        },
2025-11-10T00:04:28.4784994Z      ];
2025-11-10T00:04:28.4785628Z -    
2025-11-10T00:04:28.4788143Z +
2025-11-10T00:04:28.4788823Z      // Regular transactions
2025-11-10T00:04:28.4789688Z      for i in 0..num_txs {
2025-11-10T00:04:28.4790589Z          transactions.push(Transaction {
2025-11-10T00:04:28.4792706Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:181:
2025-11-10T00:04:28.4795002Z              lock_time: 0,
2025-11-10T00:04:28.4797576Z          });
2025-11-10T00:04:28.4798252Z      }
2025-11-10T00:04:28.4798889Z -    
2025-11-10T00:04:28.4799527Z +
2025-11-10T00:04:28.4800158Z      Block {
2025-11-10T00:04:28.4800890Z          header: BlockHeader {
2025-11-10T00:04:28.4801754Z              version: 1,
2025-11-10T00:04:28.4803491Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:198:
2025-11-10T00:04:28.4805613Z  fn bench_block_validation(c: &mut Criterion) {
2025-11-10T00:04:28.4806806Z      let mut group = c.benchmark_group("block_validation");
2025-11-10T00:04:28.4808161Z      group.sample_size(10); // Fewer samples for longer benchmarks
2025-11-10T00:04:28.4809305Z -    
2025-11-10T00:04:28.4809952Z +
2025-11-10T00:04:28.4810735Z      // Small block (10 txs) - typical for quick blocks
2025-11-10T00:04:28.4811908Z      let block_10 = create_realistic_block(10);
2025-11-10T00:04:28.4813513Z      let witnesses_10: Vec<Witness> = block_10.transactions.iter().map(|_| Vec::new()).collect();
2025-11-10T00:04:28.4816059Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:205:
2025-11-10T00:04:28.4817878Z -    
2025-11-10T00:04:28.4818520Z +
2025-11-10T00:04:28.4819241Z      group.bench_function("10_txs", |b| {
2025-11-10T00:04:28.4820188Z          b.iter(|| {
2025-11-10T00:04:28.4821008Z              let utxo_set = UtxoSet::new();
2025-11-10T00:04:28.4822910Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:215:
2025-11-10T00:04:28.4825165Z              );
2025-11-10T00:04:28.4827676Z          })
2025-11-10T00:04:28.4828612Z      });
2025-11-10T00:04:28.4829265Z -    
2025-11-10T00:04:28.4829907Z +
2025-11-10T00:04:28.4830713Z      // Medium block (100 txs) - typical average block
2025-11-10T00:04:28.4831887Z      let block_100 = create_realistic_block(100);
2025-11-10T00:04:28.4833546Z      let witnesses_100: Vec<Witness> = block_100.transactions.iter().map(|_| Vec::new()).collect();
2025-11-10T00:04:28.4836109Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:222:
2025-11-10T00:04:28.4839765Z -    
2025-11-10T00:04:28.4840405Z +
2025-11-10T00:04:28.4841137Z      group.bench_function("100_txs", |b| {
2025-11-10T00:04:28.4842098Z          b.iter(|| {
2025-11-10T00:04:28.4842925Z              let utxo_set = UtxoSet::new();
2025-11-10T00:04:28.4844930Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:232:
2025-11-10T00:04:28.4848318Z              );
2025-11-10T00:04:28.4849016Z          })
2025-11-10T00:04:28.4849672Z      });
2025-11-10T00:04:28.4850316Z -    
2025-11-10T00:04:28.4850946Z +
2025-11-10T00:04:28.4851614Z      group.finish();
2025-11-10T00:04:28.4852355Z  }
2025-11-10T00:04:28.4852985Z  
2025-11-10T00:04:28.4854856Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:242:
2025-11-10T00:04:28.4856707Z  
2025-11-10T00:04:28.4857484Z  fn bench_utxo_operations(c: &mut Criterion) {
2025-11-10T00:04:28.4860221Z      use std::collections::HashMap;
2025-11-10T00:04:28.4861108Z -    
2025-11-10T00:04:28.4861742Z +
2025-11-10T00:04:28.4862504Z      let mut utxo_set: UtxoSet = HashMap::new();
2025-11-10T00:04:28.4863547Z      let outpoint = OutPoint {
2025-11-10T00:04:28.4864531Z          hash: [1; 32],
2025-11-10T00:04:28.4866239Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:253:
2025-11-10T00:04:28.4868136Z          script_pubkey: vec![0x51],
2025-11-10T00:04:28.4869033Z          height: 0,
2025-11-10T00:04:28.4869740Z      };
2025-11-10T00:04:28.4870379Z -    
2025-11-10T00:04:28.4871015Z +
2025-11-10T00:04:28.4871998Z      let mut group = c.benchmark_group("utxo");
2025-11-10T00:04:28.4872975Z -    
2025-11-10T00:04:28.4875906Z +
2025-11-10T00:04:28.4876830Z      // Insert UTXO
2025-11-10T00:04:28.4877662Z      group.bench_function("insert", |b| {
2025-11-10T00:04:28.4878618Z          b.iter(|| {
2025-11-10T00:04:28.4880308Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:264:
2025-11-10T00:04:28.4882432Z              black_box(set)
2025-11-10T00:04:28.4883235Z          })
2025-11-10T00:04:28.4883897Z      });
2025-11-10T00:04:28.4884682Z -    
2025-11-10T00:04:28.4885330Z +
2025-11-10T00:04:28.4885965Z      // Lookup UTXO
2025-11-10T00:04:28.4888610Z      utxo_set.insert(outpoint.clone(), utxo.clone());
2025-11-10T00:04:28.4889777Z      group.bench_function("get", |b| {
2025-11-10T00:04:28.4891648Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:271:
2025-11-10T00:04:28.4893494Z -        b.iter(|| {
2025-11-10T00:04:28.4894700Z -            black_box(utxo_set.get(black_box(&outpoint)))
2025-11-10T00:04:28.4898033Z -        })
2025-11-10T00:04:28.4898967Z +        b.iter(|| black_box(utxo_set.get(black_box(&outpoint))))
2025-11-10T00:04:28.4900078Z      });
2025-11-10T00:04:28.4900718Z -    
2025-11-10T00:04:28.4901365Z +
2025-11-10T00:04:28.4902010Z      // Remove UTXO
2025-11-10T00:04:28.4902833Z      group.bench_function("remove", |b| {
2025-11-10T00:04:28.4903784Z          b.iter(|| {
2025-11-10T00:04:28.4905606Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:280:
2025-11-10T00:04:28.4907581Z              black_box(set.remove(black_box(&outpoint)))
2025-11-10T00:04:28.4908584Z          })
2025-11-10T00:04:28.4911206Z      });
2025-11-10T00:04:28.4911934Z -    
2025-11-10T00:04:28.4912574Z +
2025-11-10T00:04:28.4913226Z      group.finish();
2025-11-10T00:04:28.4913968Z  }
2025-11-10T00:04:28.4914720Z  
2025-11-10T00:04:28.4916334Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/benches/performance_focused.rs:318:
2025-11-10T00:04:28.4918177Z      block_benches,
2025-11-10T00:04:28.4918975Z      utxo_benches
2025-11-10T00:04:28.4919669Z  );
2025-11-10T00:04:28.4920297Z -
2025-11-10T00:04:28.4920922Z  
2025-11-10T00:04:28.4922390Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/examples/cpu_features.rs:3:
2025-11-10T00:04:28.4926196Z      {
2025-11-10T00:04:28.4926951Z          println!("CPU Feature Detection:");
2025-11-10T00:04:28.4928224Z          println!("  AVX2: {}", std::arch::is_x86_feature_detected!("avx2"));
2025-11-10T00:04:28.4929709Z -        println!("  SSE4.1: {}", std::arch::is_x86_feature_detected!("sse4.1"));
2025-11-10T00:04:28.4930941Z +        println!(
2025-11-10T00:04:28.4931767Z +            "  SSE4.1: {}",
2025-11-10T00:04:28.4932899Z +            std::arch::is_x86_feature_detected!("sse4.1")
2025-11-10T00:04:28.4933924Z +        );
2025-11-10T00:04:28.4936988Z          println!("  SHA-NI: {}", std::arch::is_x86_feature_detected!("sha"));
2025-11-10T00:04:28.4938461Z          println!("  AVX: {}", std::arch::is_x86_feature_detected!("avx"));
2025-11-10T00:04:28.4939783Z      }
2025-11-10T00:04:28.5641937Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:58:
2025-11-10T00:04:28.5644767Z              return override_val;
2025-11-10T00:04:28.5646039Z          }
2025-11-10T00:04:28.5646984Z      }
2025-11-10T00:04:28.5647917Z -    
2025-11-10T00:04:28.5648841Z +
2025-11-10T00:04:28.5650430Z      // Load from environment variable (supports config files via std::env)
2025-11-10T00:04:28.5652783Z      // Default to 0 (validate all blocks) for maximum safety
2025-11-10T00:04:28.5654092Z      std::env::var("ASSUME_VALID_HEIGHT")
2025-11-10T00:04:28.5656579Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:199:
2025-11-10T00:04:28.5658207Z              .collect();
2025-11-10T00:04:28.5659304Z  
2025-11-10T00:04:28.5660768Z          // Batch UTXO lookup for all transactions (single pass through HashMap)
2025-11-10T00:04:28.5662984Z -        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> = 
2025-11-10T00:04:28.5666418Z +        let mut utxo_cache: std::collections::HashMap<&OutPoint, &UTXO> =
2025-11-10T00:04:28.5667919Z              std::collections::HashMap::with_capacity(all_prevouts.len());
2025-11-10T00:04:28.5669175Z          for prevout in &all_prevouts {
2025-11-10T00:04:28.5670244Z              if let Some(utxo) = utxo_set.get(prevout) {
2025-11-10T00:04:28.5672386Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:297:
2025-11-10T00:04:28.5674532Z                          let input_utxos: Vec<(usize, Option<&ByteString>)> = {
2025-11-10T00:04:28.5675900Z                              let mut result = Vec::with_capacity(tx.inputs.len());
2025-11-10T00:04:28.5678464Z                              for (j, input) in tx.inputs.iter().enumerate() {
2025-11-10T00:04:28.5680735Z -                                result.push((j, utxo_set.get(&input.prevout).map(|u| &u.script_pubkey)));
2025-11-10T00:04:28.5682355Z +                                result.push((
2025-11-10T00:04:28.5683320Z +                                    j,
2025-11-10T00:04:28.5684596Z +                                    utxo_set.get(&input.prevout).map(|u| &u.script_pubkey),
2025-11-10T00:04:28.5685786Z +                                ));
2025-11-10T00:04:28.5686691Z                              }
2025-11-10T00:04:28.5687534Z                              result
2025-11-10T00:04:28.5688408Z                          };
2025-11-10T00:04:28.5689883Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:365:
2025-11-10T00:04:28.5691439Z  
2025-11-10T00:04:28.5692121Z                  if !script_valid {
2025-11-10T00:04:28.5693028Z                      return Ok((
2025-11-10T00:04:28.5694089Z -                        ValidationResult::Invalid(format!(
2025-11-10T00:04:28.5695531Z -                            "Invalid script at transaction {i}"
2025-11-10T00:04:28.5696585Z -                        )),
2025-11-10T00:04:28.5697863Z +                        ValidationResult::Invalid(format!("Invalid script at transaction {i}")),
2025-11-10T00:04:28.5699244Z                          utxo_set,
2025-11-10T00:04:28.5700113Z                      ));
2025-11-10T00:04:28.5700885Z                  }
2025-11-10T00:04:28.5702284Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:374:
2025-11-10T00:04:28.5703845Z  
2025-11-10T00:04:28.5704944Z                  // Use checked arithmetic to prevent fee overflow
2025-11-10T00:04:28.5707874Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-10T00:04:28.5709598Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-10T00:04:28.5711232Z +                    ConsensusError::BlockValidation(format!(
2025-11-10T00:04:28.5712418Z +                        "Total fees overflow at transaction {i}"
2025-11-10T00:04:28.5713464Z +                    ))
2025-11-10T00:04:28.5714211Z                  })?;
2025-11-10T00:04:28.5715075Z              }
2025-11-10T00:04:28.5715758Z          }
2025-11-10T00:04:28.5718291Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:426:
2025-11-10T00:04:28.5720488Z                          .map_err(|e| ConsensusError::TransactionValidation(e.to_string()))?;
2025-11-10T00:04:28.5721736Z  
2025-11-10T00:04:28.5722678Z                      let fee = total_input.checked_sub(total_output).ok_or_else(|| {
2025-11-10T00:04:28.5725030Z -                        ConsensusError::TransactionValidation("Fee calculation underflow".to_string())
2025-11-10T00:04:28.5728489Z +                        ConsensusError::TransactionValidation(
2025-11-10T00:04:28.5729670Z +                            "Fee calculation underflow".to_string(),
2025-11-10T00:04:28.5730941Z +                        )
2025-11-10T00:04:28.5731740Z                      })?;
2025-11-10T00:04:28.5732499Z  
2025-11-10T00:04:28.5733297Z                      if fee < 0 {
2025-11-10T00:04:28.5734967Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:441:
2025-11-10T00:04:28.5738039Z  
2025-11-10T00:04:28.5738886Z                  if !matches!(input_valid, ValidationResult::Valid) {
2025-11-10T00:04:28.5740406Z                      return Ok((
2025-11-10T00:04:28.5741772Z -                        ValidationResult::Invalid(format!("Invalid transaction inputs at index {i}")),
2025-11-10T00:04:28.5743314Z +                        ValidationResult::Invalid(format!(
2025-11-10T00:04:28.5744754Z +                            "Invalid transaction inputs at index {i}"
2025-11-10T00:04:28.5745833Z +                        )),
2025-11-10T00:04:28.5746670Z                          utxo_set,
2025-11-10T00:04:28.5747531Z                      ));
2025-11-10T00:04:28.5748317Z                  }
2025-11-10T00:04:28.5749708Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:495:
2025-11-10T00:04:28.5751267Z  
2025-11-10T00:04:28.5752071Z                  // Use checked arithmetic to prevent fee overflow
2025-11-10T00:04:28.5753359Z                  total_fees = total_fees.checked_add(fee).ok_or_else(|| {
2025-11-10T00:04:28.5755190Z -                    ConsensusError::BlockValidation(format!("Total fees overflow at transaction {i}"))
2025-11-10T00:04:28.5756808Z +                    ConsensusError::BlockValidation(format!(
2025-11-10T00:04:28.5757969Z +                        "Total fees overflow at transaction {i}"
2025-11-10T00:04:28.5758994Z +                    ))
2025-11-10T00:04:28.5759748Z                  })?;
2025-11-10T00:04:28.5760487Z              }
2025-11-10T00:04:28.5761174Z          }
2025-11-10T00:04:28.5762507Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:779:
2025-11-10T00:04:28.5764598Z      // Estimate: current size + new outputs - spent inputs (for non-coinbase)
2025-11-10T00:04:28.5765938Z      #[cfg(feature = "production")]
2025-11-10T00:04:28.5767188Z      {
2025-11-10T00:04:28.5767966Z -        let estimated_new_size = utxo_set.len()
2025-11-10T00:04:28.5769018Z +        let estimated_new_size = utxo_set
2025-11-10T00:04:28.5769954Z +            .len()
2025-11-10T00:04:28.5770761Z              .saturating_add(tx.outputs.len())
2025-11-10T00:04:28.5772363Z              .saturating_sub(if is_coinbase(tx) { 0 } else { tx.inputs.len() });
2025-11-10T00:04:28.5773745Z          if estimated_new_size > utxo_set.capacity() {
2025-11-10T00:04:28.5775578Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:896:
2025-11-10T00:04:28.5777275Z  /// is the transaction in Bitcoin wire format.
2025-11-10T00:04:28.5778891Z  ///
2025-11-10T00:04:28.5780644Z  /// For batch operations, use serialize_transaction + batch_double_sha256 instead.
2025-11-10T00:04:28.5783007Z -/// 
2025-11-10T00:04:28.5784127Z +///
2025-11-10T00:04:28.5786493Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-10T00:04:28.5789293Z  /// for 2-3x faster transaction ID calculation.
2025-11-10T00:04:28.5791058Z  #[inline(always)]
2025-11-10T00:04:28.5792527Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/block.rs:903:
2025-11-10T00:04:28.5794259Z  pub fn calculate_tx_id(tx: &Transaction) -> Hash {
2025-11-10T00:04:28.5796288Z -    use crate::serialization::transaction::serialize_transaction;
2025-11-10T00:04:28.5797578Z      use crate::crypto::OptimizedSha256;
2025-11-10T00:04:28.5800197Z +    use crate::serialization::transaction::serialize_transaction;
2025-11-10T00:04:28.5801352Z  
2025-11-10T00:04:28.5802137Z      // Serialize transaction to Bitcoin wire format
2025-11-10T00:04:28.5803267Z      let serialized = serialize_transaction(tx);
2025-11-10T00:04:28.5805656Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:8:
2025-11-10T00:04:28.5809126Z  //! - Batch (8+ items): Uses AVX2 8-way parallel processing
2025-11-10T00:04:28.5810866Z  //! - Expected: 4-8x speedup for batch operations on AVX2-capable CPUs
2025-11-10T00:04:28.5812295Z  
2025-11-10T00:04:28.5813004Z -use sha2::{Digest, Sha256};
2025-11-10T00:04:28.5813914Z  use crate::crypto::sha256_avx2;
2025-11-10T00:04:28.5814983Z +use sha2::{Digest, Sha256};
2025-11-10T00:04:28.5815806Z  
2025-11-10T00:04:28.5816623Z  /// Batch SHA256 using AVX2 8-way parallel processing
2025-11-10T00:04:28.5817653Z  ///
2025-11-10T00:04:28.5819827Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:46:
2025-11-10T00:04:28.5821572Z      }
2025-11-10T00:04:28.5822213Z  
2025-11-10T00:04:28.5823048Z      let mut results = Vec::with_capacity(inputs.len());
2025-11-10T00:04:28.5825934Z -    
2025-11-10T00:04:28.5826578Z +
2025-11-10T00:04:28.5827317Z      // Process in chunks of 8 using AVX2
2025-11-10T00:04:28.5828425Z      let chunks = inputs.chunks_exact(8);
2025-11-10T00:04:28.5829464Z      let remainder = chunks.remainder();
2025-11-10T00:04:28.5831260Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:55:
2025-11-10T00:04:28.5833018Z      for chunk in chunks {
2025-11-10T00:04:28.5833938Z          // Convert chunk to array of 8 references
2025-11-10T00:04:28.5837122Z          let chunk_array: [&[u8]; 8] = [
2025-11-10T00:04:28.5838136Z -            chunk[0], chunk[1], chunk[2], chunk[3],
2025-11-10T00:04:28.5839222Z -            chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-10T00:04:28.5840553Z +            chunk[0], chunk[1], chunk[2], chunk[3], chunk[4], chunk[5], chunk[6], chunk[7],
2025-11-10T00:04:28.5841805Z          ];
2025-11-10T00:04:28.5842469Z -        
2025-11-10T00:04:28.5843119Z +
2025-11-10T00:04:28.5845831Z          // Use AVX2 8-way parallel double SHA256
2025-11-10T00:04:28.5847124Z          // Note: sha256_8way_avx2 expects 64-byte inputs (one SHA256 block)
2025-11-10T00:04:28.5848658Z          // For non-64-byte inputs, it will fall back to sequential processing
2025-11-10T00:04:28.5850714Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/avx2_batch.rs:93:
2025-11-10T00:04:28.5852425Z          })
2025-11-10T00:04:28.5853112Z          .collect()
2025-11-10T00:04:28.5853960Z  }
2025-11-10T00:04:28.5854777Z -
2025-11-10T00:04:28.5855412Z  
2025-11-10T00:04:28.5858706Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:99:
2025-11-10T00:04:28.5860459Z  
2025-11-10T00:04:28.5861096Z      #[test]
2025-11-10T00:04:28.5861822Z      fn test_hash_eq_random() {
2025-11-10T00:04:28.5863148Z -        let hash1: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32];
2025-11-10T00:04:28.5866615Z -        let hash2: Hash = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33];
2025-11-10T00:04:28.5867982Z -        
2025-11-10T00:04:28.5868683Z +        let hash1: Hash = [
2025-11-10T00:04:28.5869708Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-10T00:04:28.5870839Z +            25, 26, 27, 28, 29, 30, 31, 32,
2025-11-10T00:04:28.5871738Z +        ];
2025-11-10T00:04:28.5872450Z +        let hash2: Hash = [
2025-11-10T00:04:28.5873463Z +            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
2025-11-10T00:04:28.5874731Z +            25, 26, 27, 28, 29, 30, 31, 33,
2025-11-10T00:04:28.5877032Z +        ];
2025-11-10T00:04:28.5877682Z +
2025-11-10T00:04:28.5878406Z          // Should match standard comparison
2025-11-10T00:04:28.5879529Z          assert_eq!(hash_eq(&hash1, &hash1), hash1 == hash1);
2025-11-10T00:04:28.5880756Z          assert_eq!(hash_eq(&hash1, &hash2), hash1 == hash2);
2025-11-10T00:04:28.5883343Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/hash_compare.rs:108:
2025-11-10T00:04:28.5885480Z      }
2025-11-10T00:04:28.5886128Z  }
2025-11-10T00:04:28.5886756Z -
2025-11-10T00:04:28.5888871Z  
2025-11-10T00:04:28.5890305Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:49:
2025-11-10T00:04:28.5891972Z          Ok(a + b)
2025-11-10T00:04:28.5892675Z      } else {
2025-11-10T00:04:28.5893920Z          // Mixed signs: use checked arithmetic (overflow not possible, but safer)
2025-11-10T00:04:28.5895422Z -        a.checked_add(b).ok_or_else(|| {
2025-11-10T00:04:28.5896840Z -            ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-10T00:04:28.5898205Z -        })
2025-11-10T00:04:28.5898910Z +        a.checked_add(b)
2025-11-10T00:04:28.5900301Z +            .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-10T00:04:28.5901776Z      }
2025-11-10T00:04:28.5902418Z  }
2025-11-10T00:04:28.5903098Z  
2025-11-10T00:04:28.5905814Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:58:
2025-11-10T00:04:28.5910546Z  #[cfg(not(feature = "production"))]
2025-11-10T00:04:28.5912337Z  pub fn safe_add(a: i64, b: i64) -> Result<i64> {
2025-11-10T00:04:28.5914647Z      // Always use checked arithmetic in non-production builds
2025-11-10T00:04:28.5917130Z -    a.checked_add(b).ok_or_else(|| {
2025-11-10T00:04:28.5920769Z -        ConsensusError::TransactionValidation("Arithmetic overflow".to_string())
2025-11-10T00:04:28.5923151Z -    })
2025-11-10T00:04:28.5924482Z +    a.checked_add(b)
2025-11-10T00:04:28.5928122Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic overflow".to_string()))
2025-11-10T00:04:28.5929662Z  }
2025-11-10T00:04:28.5930292Z  
2025-11-10T00:04:28.5931082Z  /// Fast-path subtraction with overflow checking
2025-11-10T00:04:28.5932917Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:98:
2025-11-10T00:04:28.5934880Z  #[cfg(not(feature = "production"))]
2025-11-10T00:04:28.5935930Z  pub fn safe_sub(a: i64, b: i64) -> Result<i64> {
2025-11-10T00:04:28.5938962Z      // Always use checked arithmetic in non-production builds
2025-11-10T00:04:28.5940332Z -    a.checked_sub(b).ok_or_else(|| {
2025-11-10T00:04:28.5941747Z -        ConsensusError::TransactionValidation("Arithmetic underflow".to_string())
2025-11-10T00:04:28.5943118Z -    })
2025-11-10T00:04:28.5943783Z +    a.checked_sub(b)
2025-11-10T00:04:28.5945442Z +        .ok_or_else(|| ConsensusError::TransactionValidation("Arithmetic underflow".to_string()))
2025-11-10T00:04:28.5946909Z  }
2025-11-10T00:04:28.5947546Z  
2025-11-10T00:04:28.5949575Z  #[cfg(test)]
2025-11-10T00:04:28.5951082Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/int_ops.rs:129:
2025-11-10T00:04:28.5953106Z          assert!(safe_sub(i64::MIN, 1).is_err());
2025-11-10T00:04:28.5954219Z      }
2025-11-10T00:04:28.5955022Z  }
2025-11-10T00:04:28.5955662Z -
2025-11-10T00:04:28.5956291Z  
2025-11-10T00:04:28.5957669Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:71:
2025-11-10T00:04:28.5959478Z      }
2025-11-10T00:04:28.5960112Z  
2025-11-10T00:04:28.5960942Z      /// Hash data using the best available implementation
2025-11-10T00:04:28.5961995Z -    /// 
2025-11-10T00:04:28.5962739Z +    ///
2025-11-10T00:04:28.5963869Z      /// Priority:
2025-11-10T00:04:28.5965750Z      /// 1. SHA-NI (Intel SHA Extensions) - 10-15x faster for single hashes
2025-11-10T00:04:28.5968509Z      /// 2. sha2 crate with asm - baseline fallback
2025-11-10T00:04:28.5970249Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:78:
2025-11-10T00:04:28.5971869Z -    /// 
2025-11-10T00:04:28.5972516Z +    ///
2025-11-10T00:04:28.5973704Z      /// For batch operations, see batch_sha256 in optimizations module.
2025-11-10T00:04:28.5975537Z      pub fn hash(&self, data: &[u8]) -> [u8; 32] {
2025-11-10T00:04:28.5977023Z          #[cfg(target_arch = "x86_64")]
2025-11-10T00:04:28.5978685Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:85:
2025-11-10T00:04:28.5980396Z                  return sha_ni::sha256(data);
2025-11-10T00:04:28.5981584Z              }
2025-11-10T00:04:28.5982265Z          }
2025-11-10T00:04:28.5982917Z -        
2025-11-10T00:04:28.5983557Z +
2025-11-10T00:04:28.5984467Z          // Fallback: sha2 crate with asm optimizations
2025-11-10T00:04:28.5985550Z          let mut hasher = Sha256::new();
2025-11-10T00:04:28.5986516Z          hasher.update(data);
2025-11-10T00:04:28.5988103Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:96:
2025-11-10T00:04:28.5990719Z      }
2025-11-10T00:04:28.5991368Z  
2025-11-10T00:04:28.5992152Z      /// Compute double SHA256 (SHA256(SHA256(data)))
2025-11-10T00:04:28.5993162Z -    /// 
2025-11-10T00:04:28.5993816Z +    ///
2025-11-10T00:04:28.5994925Z      /// Uses SHA-NI if available for optimal single-hash performance.
2025-11-10T00:04:28.5996233Z      pub fn hash256(&self, data: &[u8]) -> [u8; 32] {
2025-11-10T00:04:28.5997308Z          #[cfg(target_arch = "x86_64")]
2025-11-10T00:04:28.6001089Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/mod.rs:105:
2025-11-10T00:04:28.6002839Z                  return sha_ni::hash256(data);
2025-11-10T00:04:28.6003780Z              }
2025-11-10T00:04:28.6004792Z          }
2025-11-10T00:04:28.6005559Z -        
2025-11-10T00:04:28.6006282Z +
2025-11-10T00:04:28.6006983Z          let first = self.hash(data);
2025-11-10T00:04:28.6007923Z          self.hash(&first)
2025-11-10T00:04:28.6008713Z      }
2025-11-10T00:04:28.6010950Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:17:
2025-11-10T00:04:28.6013259Z  struct AlignedInitialHash([u32; 8]);
2025-11-10T00:04:28.6014187Z  
2025-11-10T00:04:28.6015294Z  static INITIAL_HASH: AlignedInitialHash = AlignedInitialHash([
2025-11-10T00:04:28.6018003Z -    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a,
2025-11-10T00:04:28.6019143Z -    0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-10T00:04:28.6020759Z +    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,
2025-11-10T00:04:28.6022258Z  ]);
2025-11-10T00:04:28.6022894Z  
2025-11-10T00:04:28.6023553Z  // SHA256 K constants
2025-11-10T00:04:28.6025283Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:27:
2025-11-10T00:04:28.6027772Z  struct AlignedKArray([u32; 64]);
2025-11-10T00:04:28.6028628Z  
2025-11-10T00:04:28.6029418Z  static K_ARRAY: AlignedKArray = AlignedKArray([
2025-11-10T00:04:28.6030564Z -    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,
2025-11-10T00:04:28.6031701Z -    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-10T00:04:28.6032830Z -    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,
2025-11-10T00:04:28.6033974Z -    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-10T00:04:28.6035235Z -    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,
2025-11-10T00:04:28.6036364Z -    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-10T00:04:28.6037493Z -    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-10T00:04:28.6039907Z -    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-10T00:04:28.6041025Z -    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,
2025-11-10T00:04:28.6042141Z -    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-10T00:04:28.6043278Z -    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,
2025-11-10T00:04:28.6044512Z -    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-10T00:04:28.6045629Z -    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,
2025-11-10T00:04:28.6046868Z -    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-10T00:04:28.6048219Z -    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,
2025-11-10T00:04:28.6049546Z -    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-10T00:04:28.6051171Z +    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-10T00:04:28.6053697Z +    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-10T00:04:28.6055957Z +    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-10T00:04:28.6058042Z +    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-10T00:04:28.6060117Z +    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-10T00:04:28.6062193Z +    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-10T00:04:28.6064267Z +    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-10T00:04:28.6066502Z +    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-10T00:04:28.6067999Z  ]);
2025-11-10T00:04:28.6068633Z  
2025-11-10T00:04:28.6069636Z  /// Helper functions for AVX2 operations
2025-11-10T00:04:28.6071439Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:64:
2025-11-10T00:04:28.6073446Z      pub unsafe fn add3(x: __m256i, y: __m256i, z: __m256i) -> __m256i {
2025-11-10T00:04:28.6074757Z          add(add(x, y), z)
2025-11-10T00:04:28.6075547Z      }
2025-11-10T00:04:28.6076191Z -    
2025-11-10T00:04:28.6076822Z +
2025-11-10T00:04:28.6077481Z      #[inline(always)]
2025-11-10T00:04:28.6078573Z      pub unsafe fn add4(x: __m256i, y: __m256i, z: __m256i, w: __m256i) -> __m256i {
2025-11-10T00:04:28.6079978Z          // Core: Add(x, y, z, w) = Add(Add(x, y), Add(z, w))
2025-11-10T00:04:28.6082053Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:71:
2025-11-10T00:04:28.6085636Z          add(add(x, y), add(z, w))
2025-11-10T00:04:28.6086510Z      }
2025-11-10T00:04:28.6087152Z -    
2025-11-10T00:04:28.6087787Z +
2025-11-10T00:04:28.6088435Z      #[inline(always)]
2025-11-10T00:04:28.6090219Z      pub unsafe fn add5(x: __m256i, y: __m256i, z: __m256i, w: __m256i, v: __m256i) -> __m256i {
2025-11-10T00:04:28.6091719Z          // Core: Add(x, y, z, w, v) = Add(Add(x, y, z), Add(w, v))
2025-11-10T00:04:28.6093646Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:171:
2025-11-10T00:04:28.6095553Z  /// One round of SHA-256
2025-11-10T00:04:28.6096393Z  #[cfg(target_arch = "x86_64")]
2025-11-10T00:04:28.6097261Z  macro_rules! round {
2025-11-10T00:04:28.6100118Z -    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {
2025-11-10T00:04:28.6101470Z -        {
2025-11-10T00:04:28.6102397Z -            use helpers::*;
2025-11-10T00:04:28.6103603Z -            // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-10T00:04:28.6105358Z -            let t1 = add(add($h, helpers::sigma1($e)), add(helpers::ch($e, $f, $g), $k));
2025-11-10T00:04:28.6107183Z -            let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-10T00:04:28.6108352Z -            $d = add($d, t1);
2025-11-10T00:04:28.6109216Z -            $h = add(t1, t2);
2025-11-10T00:04:28.6110042Z -        }
2025-11-10T00:04:28.6110801Z -    };
2025-11-10T00:04:28.6111899Z +    ($a:expr, $b:expr, $c:expr, $d:expr, $e:expr, $f:expr, $g:expr, $h:expr, $k:expr) => {{
2025-11-10T00:04:28.6113203Z +        use helpers::*;
2025-11-10T00:04:28.6116217Z +        // Core: Add(h, Sigma1(e), Ch(e, f, g), k) = Add(Add(h, Sigma1(e)), Add(Ch(e, f, g), k))
2025-11-10T00:04:28.6117489Z +        let t1 = add(
2025-11-10T00:04:28.6118322Z +            add($h, helpers::sigma1($e)),
2025-11-10T00:04:28.6119580Z +            add(helpers::ch($e, $f, $g), $k),
2025-11-10T00:04:28.6120516Z +        );
2025-11-10T00:04:28.6121531Z +        let t2 = add(helpers::sigma0($a), helpers::maj($a, $b, $c));
2025-11-10T00:04:28.6122655Z +        $d = add($d, t1);
2025-11-10T00:04:28.6123827Z +        $h = add(t1, t2);
2025-11-10T00:04:28.6124774Z +    }};
2025-11-10T00:04:28.6125425Z  }
2025-11-10T00:04:28.6126055Z  
2025-11-10T00:04:28.6126859Z  /// Read 8 32-bit words from 8 different 64-byte blocks
2025-11-10T00:04:28.6129733Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:190:
2025-11-10T00:04:28.6132148Z      let mut words = [0u32; 8];
2025-11-10T00:04:28.6133418Z      for i in 0..8 {
2025-11-10T00:04:28.6134782Z          let pos = (i * 64) + offset;
2025-11-10T00:04:28.6138227Z -        words[i] = u32::from_le_bytes([
2025-11-10T00:04:28.6139894Z -            input[pos],
2025-11-10T00:04:28.6141233Z -            input[pos + 1],
2025-11-10T00:04:28.6142558Z -            input[pos + 2],
2025-11-10T00:04:28.6144000Z -            input[pos + 3],
2025-11-10T00:04:28.6145609Z -        ]);
2025-11-10T00:04:28.6149029Z +        words[i] = u32::from_le_bytes([input[pos], input[pos + 1], input[pos + 2], input[pos + 3]]);
2025-11-10T00:04:28.6150424Z      }
2025-11-10T00:04:28.6151067Z -    
2025-11-10T00:04:28.6151705Z +
2025-11-10T00:04:28.6168523Z      // _mm256_set_epi32 places first argument at index 7, last at index 0
2025-11-10T00:04:28.6170499Z      // Core: ReadLE32(chunk + 0) is first arg -> index 7, ReadLE32(chunk + 64) is second arg -> index 6, etc.
2025-11-10T00:04:28.6172225Z      // So words[0] (chunk + 0) should be first arg -> index 7
2025-11-10T00:04:28.6174191Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:205:
2025-11-10T00:04:28.6176727Z      // So chunk 0 goes to index 7, chunk 1 (chunk + 64) goes to index 6, etc.
2025-11-10T00:04:28.6178358Z      // This means words[0] -> index 7, words[1] -> index 6, ..., words[7] -> index 0
2025-11-10T00:04:28.6179726Z      let ret = _mm256_set_epi32(
2025-11-10T00:04:28.6181027Z -        words[0] as i32,  // chunk + 0 -> index 7 (first arg)
2025-11-10T00:04:28.6182302Z -        words[1] as i32,  // chunk + 64 -> index 6 (second arg)
2025-11-10T00:04:28.6183484Z -        words[2] as i32,  // chunk + 128 -> index 5
2025-11-10T00:04:28.6184831Z -        words[3] as i32,  // chunk + 192 -> index 4
2025-11-10T00:04:28.6185949Z -        words[4] as i32,  // chunk + 256 -> index 3
2025-11-10T00:04:28.6187052Z -        words[5] as i32,  // chunk + 320 -> index 2
2025-11-10T00:04:28.6189366Z -        words[6] as i32,  // chunk + 384 -> index 1
2025-11-10T00:04:28.6190518Z -        words[7] as i32,  // chunk + 448 -> index 0 (last arg)
2025-11-10T00:04:28.6191751Z +        words[0] as i32, // chunk + 0 -> index 7 (first arg)
2025-11-10T00:04:28.6192973Z +        words[1] as i32, // chunk + 64 -> index 6 (second arg)
2025-11-10T00:04:28.6194147Z +        words[2] as i32, // chunk + 128 -> index 5
2025-11-10T00:04:28.6195482Z +        words[3] as i32, // chunk + 192 -> index 4
2025-11-10T00:04:28.6198099Z +        words[4] as i32, // chunk + 256 -> index 3
2025-11-10T00:04:28.6199484Z +        words[5] as i32, // chunk + 320 -> index 2
2025-11-10T00:04:28.6200603Z +        words[6] as i32, // chunk + 384 -> index 1
2025-11-10T00:04:28.6201770Z +        words[7] as i32, // chunk + 448 -> index 0 (last arg)
2025-11-10T00:04:28.6202820Z      );
2025-11-10T00:04:28.6203561Z -    
2025-11-10T00:04:28.6204664Z +
2025-11-10T00:04:28.6205720Z      // Byte swap within each 32-bit word using shuffle (matching Core exactly)
2025-11-10T00:04:28.6207210Z      // SHA256 operates on big-endian 32-bit words internally
2025-11-10T00:04:28.6208554Z      // We read little-endian, so we need to byte-swap each word
2025-11-10T00:04:28.6210531Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:221:
2025-11-10T00:04:28.6213224Z      // The shuffle mask 0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203
2025-11-10T00:04:28.6214865Z      // reverses bytes within each 32-bit word
2025-11-10T00:04:28.6215855Z -    // 
2025-11-10T00:04:28.6218576Z +    //
2025-11-10T00:04:28.6219780Z      // Note: _mm256_shuffle_epi8 operates on 8-bit elements across the entire vector
2025-11-10T00:04:28.6221396Z      // The mask pattern is designed to swap bytes within each word
2025-11-10T00:04:28.6222627Z      let shuffle_mask = _mm256_set_epi32(
2025-11-10T00:04:28.6224593Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:227:
2025-11-10T00:04:28.6228043Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.6229201Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.6230688Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-10T00:04:28.6232773Z +        0x00010203,
2025-11-10T00:04:28.6233541Z      );
2025-11-10T00:04:28.6234535Z      _mm256_shuffle_epi8(ret, shuffle_mask)
2025-11-10T00:04:28.6235496Z  }
2025-11-10T00:04:28.6237019Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:236:
2025-11-10T00:04:28.6240594Z      // Core's Write8 does: byte-swap with shuffle, then WriteLE32 to each position
2025-11-10T00:04:28.6242112Z      // Byte swap within each 32-bit word using shuffle
2025-11-10T00:04:28.6243208Z      let shuffle_mask = _mm256_set_epi32(
2025-11-10T00:04:28.6244427Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.6245579Z -        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.6247058Z +        0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-10T00:04:28.6248425Z +        0x00010203,
2025-11-10T00:04:28.6249166Z      );
2025-11-10T00:04:28.6249945Z      let v = _mm256_shuffle_epi8(v, shuffle_mask);
2025-11-10T00:04:28.6250976Z -    
2025-11-10T00:04:28.6251628Z +
2025-11-10T00:04:28.6252572Z      // Extract and write to 8 different positions (Core's WriteLE32)
2025-11-10T00:04:28.6255780Z      // Unroll loop because _mm256_extract_epi32 requires compile-time constant index
2025-11-10T00:04:28.6257269Z      let word0 = _mm256_extract_epi32(v, 7) as u32;
2025-11-10T00:04:28.6259150Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:264:
2025-11-10T00:04:28.6261130Z  /// Transform 8 double SHA256 blocks in parallel (SHA256D)
2025-11-10T00:04:28.6262399Z  /// Input: 512 bytes (8 * 64-byte blocks, contiguous)
2025-11-10T00:04:28.6263585Z  /// Output: 256 bytes (8 * 32-byte hashes, contiguous)
2025-11-10T00:04:28.6264745Z -/// 
2025-11-10T00:04:28.6266920Z +///
2025-11-10T00:04:28.6268007Z  /// This performs double SHA256 (SHA256(SHA256(input))) on 8 blocks in parallel.
2025-11-10T00:04:28.6269394Z  #[cfg(target_arch = "x86_64")]
2025-11-10T00:04:28.6270459Z  unsafe fn transform_8way(out: &mut [u8], input: &[u8]) {
2025-11-10T00:04:28.6272888Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:271:
2025-11-10T00:04:28.6274870Z      use helpers::*;
2025-11-10T00:04:28.6275635Z -    
2025-11-10T00:04:28.6276283Z +
2025-11-10T00:04:28.6277375Z      // Initialize state with initial hash values (host byte order, matching Core)
2025-11-10T00:04:28.6279129Z      let mut a = _mm256_set1_epi32(INITIAL_HASH.0[0] as i32);
2025-11-10T00:04:28.6280387Z      let mut b = _mm256_set1_epi32(INITIAL_HASH.0[1] as i32);
2025-11-10T00:04:28.6283068Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:279:
2025-11-10T00:04:28.6286296Z      let mut f = _mm256_set1_epi32(INITIAL_HASH.0[5] as i32);
2025-11-10T00:04:28.6287568Z      let mut g = _mm256_set1_epi32(INITIAL_HASH.0[6] as i32);
2025-11-10T00:04:28.6288822Z      let mut h = _mm256_set1_epi32(INITIAL_HASH.0[7] as i32);
2025-11-10T00:04:28.6290311Z -    
2025-11-10T00:04:28.6291135Z +
2025-11-10T00:04:28.6291836Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6292690Z      {
2025-11-10T00:04:28.6293679Z          let a_init = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6295809Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:312:
2025-11-10T00:04:28.6297551Z      {
2025-11-10T00:04:28.6300250Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.6301539Z          let w0_val_7 = _mm256_extract_epi32(w0, 7) as u32;
2025-11-10T00:04:28.6303201Z -        println!("DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}", w0_val, w0_val_7);
2025-11-10T00:04:28.6305126Z +        println!(
2025-11-10T00:04:28.6306252Z +            "DEBUG: w0 after read8 and shuffle: index 0 = 0x{:08x}, index 7 = 0x{:08x}",
2025-11-10T00:04:28.6307582Z +            w0_val, w0_val_7
2025-11-10T00:04:28.6309659Z +        );
2025-11-10T00:04:28.6310393Z          if w0_val == 0 && w0_val_7 == 0 {
2025-11-10T00:04:28.6311576Z              println!("DEBUG: w0 is zero (expected for zero input)");
2025-11-10T00:04:28.6312718Z          }
2025-11-10T00:04:28.6314252Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:322:
2025-11-10T00:04:28.6316210Z      {
2025-11-10T00:04:28.6317085Z          let a_after_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6318352Z          let h_after_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6320522Z -        println!("DEBUG After round 0: a=0x{:08x}, h=0x{:08x}", a_after_round0, h_after_round0);
2025-11-10T00:04:28.6321944Z +        println!(
2025-11-10T00:04:28.6322821Z +            "DEBUG After round 0: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6323909Z +            a_after_round0, h_after_round0
2025-11-10T00:04:28.6325003Z +        );
2025-11-10T00:04:28.6325677Z      }
2025-11-10T00:04:28.6328462Z      w1 = read8(input, 4);
2025-11-10T00:04:28.6329483Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-10T00:04:28.6331419Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:330:
2025-11-10T00:04:28.6333167Z      {
2025-11-10T00:04:28.6334026Z          let a_after_round1 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6335446Z          let h_after_round1 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6338843Z -        println!("DEBUG After round 1: a=0x{:08x}, h=0x{:08x}", a_after_round1, h_after_round1);
2025-11-10T00:04:28.6340227Z +        println!(
2025-11-10T00:04:28.6341149Z +            "DEBUG After round 1: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6342233Z +            a_after_round1, h_after_round1
2025-11-10T00:04:28.6343169Z +        );
2025-11-10T00:04:28.6343832Z      }
2025-11-10T00:04:28.6344652Z      w2 = read8(input, 8);
2025-11-10T00:04:28.6345662Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-10T00:04:28.6349595Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:349:
2025-11-10T00:04:28.6351605Z          let a_after_round7 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6352937Z          let b_after_round7 = _mm256_extract_epi32(b, 0) as u32;
2025-11-10T00:04:28.6354221Z          let h_after_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6356056Z -        println!("DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}", a_after_round7, b_after_round7, h_after_round7);
2025-11-10T00:04:28.6358589Z +        println!(
2025-11-10T00:04:28.6359523Z +            "DEBUG After round 7: a=0x{:08x}, b=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6360780Z +            a_after_round7, b_after_round7, h_after_round7
2025-11-10T00:04:28.6361799Z +        );
2025-11-10T00:04:28.6362475Z      }
2025-11-10T00:04:28.6363179Z      w8 = read8(input, 32);
2025-11-10T00:04:28.6364176Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[8]), w8));
2025-11-10T00:04:28.6366568Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:371:
2025-11-10T00:04:28.6370050Z      {
2025-11-10T00:04:28.6370933Z          let a_after_round15 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6372220Z          let h_after_round15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6373778Z -        println!("DEBUG After round 15: a=0x{:08x}, h=0x{:08x}", a_after_round15, h_after_round15);
2025-11-10T00:04:28.6375363Z +        println!(
2025-11-10T00:04:28.6376240Z +            "DEBUG After round 15: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6379290Z +            a_after_round15, h_after_round15
2025-11-10T00:04:28.6380308Z +        );
2025-11-10T00:04:28.6381100Z      }
2025-11-10T00:04:28.6381747Z  
2025-11-10T00:04:28.6382453Z      // Rounds 16-63: Message schedule
2025-11-10T00:04:28.6384222Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:382:
2025-11-10T00:04:28.6388403Z          let w14_val = _mm256_extract_epi32(w14, 0) as u32;
2025-11-10T00:04:28.6389589Z          let w9_val = _mm256_extract_epi32(w9, 0) as u32;
2025-11-10T00:04:28.6390747Z          let w1_val = _mm256_extract_epi32(w1, 0) as u32;
2025-11-10T00:04:28.6392485Z -        println!("DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}", w0_before, w14_val, w9_val, w1_val);
2025-11-10T00:04:28.6394108Z +        println!(
2025-11-10T00:04:28.6395428Z +            "DEBUG Round 16 before inc4: w0=0x{:08x}, w14=0x{:08x}, w9=0x{:08x}, w1=0x{:08x}",
2025-11-10T00:04:28.6398085Z +            w0_before, w14_val, w9_val, w1_val
2025-11-10T00:04:28.6399045Z +        );
2025-11-10T00:04:28.6399701Z      }
2025-11-10T00:04:28.6400933Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-10T00:04:28.6402302Z +    helpers::inc4(
2025-11-10T00:04:28.6403044Z +        &mut w0,
2025-11-10T00:04:28.6403836Z +        helpers::sigma1_small(w14),
2025-11-10T00:04:28.6405062Z +        w9,
2025-11-10T00:04:28.6407724Z +        helpers::sigma0_small(w1),
2025-11-10T00:04:28.6408622Z +    );
2025-11-10T00:04:28.6409345Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6410183Z      {
2025-11-10T00:04:28.6411038Z          let w0_after_inc = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.6412965Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:405:
2025-11-10T00:04:28.6417822Z                   a_after_round16, b_after_round16, c_after_round16, d_after_round16,
2025-11-10T00:04:28.6419453Z                   e_after_round16, f_after_round16, g_after_round16, h_after_round16);
2025-11-10T00:04:28.6420845Z      }
2025-11-10T00:04:28.6421967Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-10T00:04:28.6423340Z +    helpers::inc4(
2025-11-10T00:04:28.6424080Z +        &mut w1,
2025-11-10T00:04:28.6425051Z +        helpers::sigma1_small(w15),
2025-11-10T00:04:28.6426348Z +        w10,
2025-11-10T00:04:28.6427103Z +        helpers::sigma0_small(w2),
2025-11-10T00:04:28.6427993Z +    );
2025-11-10T00:04:28.6428837Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[17]), w1));
2025-11-10T00:04:28.6430405Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-10T00:04:28.6431776Z +    helpers::inc4(
2025-11-10T00:04:28.6432515Z +        &mut w2,
2025-11-10T00:04:28.6433327Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.6434224Z +        w11,
2025-11-10T00:04:28.6435199Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.6436080Z +    );
2025-11-10T00:04:28.6437000Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-10T00:04:28.6439811Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6440651Z      {
2025-11-10T00:04:28.6442169Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:414:
2025-11-10T00:04:28.6444119Z          let a_after_round18 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6446046Z          println!("DEBUG After round 18: a=0x{:08x}", a_after_round18);
2025-11-10T00:04:28.6447205Z      }
2025-11-10T00:04:28.6448372Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-10T00:04:28.6449736Z +    helpers::inc4(
2025-11-10T00:04:28.6450469Z +        &mut w3,
2025-11-10T00:04:28.6451232Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.6452121Z +        w12,
2025-11-10T00:04:28.6452865Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.6455756Z +    );
2025-11-10T00:04:28.6456600Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-10T00:04:28.6458097Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-10T00:04:28.6459463Z +    helpers::inc4(
2025-11-10T00:04:28.6460191Z +        &mut w4,
2025-11-10T00:04:28.6460971Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.6461852Z +        w13,
2025-11-10T00:04:28.6462617Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.6463495Z +    );
2025-11-10T00:04:28.6464466Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-10T00:04:28.6465577Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6468198Z      {
2025-11-10T00:04:28.6469705Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:423:
2025-11-10T00:04:28.6471662Z          let a_after_round20 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6473020Z          println!("DEBUG After round 20: a=0x{:08x}", a_after_round20);
2025-11-10T00:04:28.6474164Z      }
2025-11-10T00:04:28.6475449Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-10T00:04:28.6476807Z +    helpers::inc4(
2025-11-10T00:04:28.6477536Z +        &mut w5,
2025-11-10T00:04:28.6478305Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.6479192Z +        w14,
2025-11-10T00:04:28.6479933Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.6481007Z +    );
2025-11-10T00:04:28.6481927Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-10T00:04:28.6483430Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-10T00:04:28.6484927Z +    helpers::inc4(
2025-11-10T00:04:28.6485662Z +        &mut w6,
2025-11-10T00:04:28.6488074Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.6489214Z +        w15,
2025-11-10T00:04:28.6490025Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.6490901Z +    );
2025-11-10T00:04:28.6492068Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-10T00:04:28.6493922Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-10T00:04:28.6495463Z +    helpers::inc4(
2025-11-10T00:04:28.6497991Z +        &mut w7,
2025-11-10T00:04:28.6498756Z +        helpers::sigma1_small(w5),
2025-11-10T00:04:28.6499712Z +        w0,
2025-11-10T00:04:28.6500904Z +        helpers::sigma0_small(w8),
2025-11-10T00:04:28.6502077Z +    );
2025-11-10T00:04:28.6503043Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-10T00:04:28.6504693Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-10T00:04:28.6506051Z +    helpers::inc4(
2025-11-10T00:04:28.6506833Z +        &mut w8,
2025-11-10T00:04:28.6507615Z +        helpers::sigma1_small(w6),
2025-11-10T00:04:28.6508503Z +        w1,
2025-11-10T00:04:28.6509250Z +        helpers::sigma0_small(w9),
2025-11-10T00:04:28.6510128Z +    );
2025-11-10T00:04:28.6510958Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[24]), w8));
2025-11-10T00:04:28.6512451Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-10T00:04:28.6513820Z +    helpers::inc4(
2025-11-10T00:04:28.6514681Z +        &mut w9,
2025-11-10T00:04:28.6515458Z +        helpers::sigma1_small(w7),
2025-11-10T00:04:28.6516345Z +        w2,
2025-11-10T00:04:28.6517315Z +        helpers::sigma0_small(w10),
2025-11-10T00:04:28.6518209Z +    );
2025-11-10T00:04:28.6519160Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[25]), w9));
2025-11-10T00:04:28.6520685Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-10T00:04:28.6522068Z +    helpers::inc4(
2025-11-10T00:04:28.6522805Z +        &mut w10,
2025-11-10T00:04:28.6523575Z +        helpers::sigma1_small(w8),
2025-11-10T00:04:28.6524596Z +        w3,
2025-11-10T00:04:28.6525352Z +        helpers::sigma0_small(w11),
2025-11-10T00:04:28.6526245Z +    );
2025-11-10T00:04:28.6527070Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[26]), w10));
2025-11-10T00:04:28.6528591Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-10T00:04:28.6530320Z +    helpers::inc4(
2025-11-10T00:04:28.6531053Z +        &mut w11,
2025-11-10T00:04:28.6531828Z +        helpers::sigma1_small(w9),
2025-11-10T00:04:28.6532708Z +        w4,
2025-11-10T00:04:28.6533470Z +        helpers::sigma0_small(w12),
2025-11-10T00:04:28.6536024Z +    );
2025-11-10T00:04:28.6536875Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[27]), w11));
2025-11-10T00:04:28.6538406Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-10T00:04:28.6539799Z +    helpers::inc4(
2025-11-10T00:04:28.6540533Z +        &mut w12,
2025-11-10T00:04:28.6541306Z +        helpers::sigma1_small(w10),
2025-11-10T00:04:28.6542194Z +        w5,
2025-11-10T00:04:28.6543100Z +        helpers::sigma0_small(w13),
2025-11-10T00:04:28.6544008Z +    );
2025-11-10T00:04:28.6545295Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[28]), w12));
2025-11-10T00:04:28.6547998Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-10T00:04:28.6549385Z +    helpers::inc4(
2025-11-10T00:04:28.6550117Z +        &mut w13,
2025-11-10T00:04:28.6550888Z +        helpers::sigma1_small(w11),
2025-11-10T00:04:28.6551792Z +        w6,
2025-11-10T00:04:28.6552560Z +        helpers::sigma0_small(w14),
2025-11-10T00:04:28.6553443Z +    );
2025-11-10T00:04:28.6554473Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-10T00:04:28.6556003Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-10T00:04:28.6557406Z +    helpers::inc4(
2025-11-10T00:04:28.6558502Z +        &mut w14,
2025-11-10T00:04:28.6559287Z +        helpers::sigma1_small(w12),
2025-11-10T00:04:28.6560177Z +        w7,
2025-11-10T00:04:28.6560917Z +        helpers::sigma0_small(w15),
2025-11-10T00:04:28.6561797Z +    );
2025-11-10T00:04:28.6562632Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-10T00:04:28.6565926Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6566758Z      {
2025-11-10T00:04:28.6568281Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:468:
2025-11-10T00:04:28.6570153Z          let w0_val = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.6571321Z          let w11_val = _mm256_extract_epi32(w11, 0) as u32;
2025-11-10T00:04:28.6572482Z          let w6_val = _mm256_extract_epi32(w6, 0) as u32;
2025-11-10T00:04:28.6574225Z -        println!("DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}", w15_before, w13_val, w8_val, w0_val);
2025-11-10T00:04:28.6577427Z +        println!(
2025-11-10T00:04:28.6578477Z +            "DEBUG w15 before inc4: 0x{:08x}, w13: 0x{:08x}, w8: 0x{:08x}, w0: 0x{:08x}",
2025-11-10T00:04:28.6579797Z +            w15_before, w13_val, w8_val, w0_val
2025-11-10T00:04:28.6580745Z +        );
2025-11-10T00:04:28.6581960Z          println!("DEBUG w11: 0x{:08x}, w6: 0x{:08x}", w11_val, w6_val);
2025-11-10T00:04:28.6583797Z          let sigma1_w13 = _mm256_extract_epi32(helpers::sigma1_small(w13), 0) as u32;
2025-11-10T00:04:28.6585580Z          let sigma0_w0 = _mm256_extract_epi32(helpers::sigma0_small(w0), 0) as u32;
2025-11-10T00:04:28.6587715Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:475:
2025-11-10T00:04:28.6590380Z -        println!("DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}", sigma1_w13, sigma0_w0);
2025-11-10T00:04:28.6591842Z +        println!(
2025-11-10T00:04:28.6592841Z +            "DEBUG sigma1_small(w13): 0x{:08x}, sigma0_small(w0): 0x{:08x}",
2025-11-10T00:04:28.6594061Z +            sigma1_w13, sigma0_w0
2025-11-10T00:04:28.6595060Z +        );
2025-11-10T00:04:28.6595724Z      }
2025-11-10T00:04:28.6596831Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-10T00:04:28.6598206Z +    helpers::inc4(
2025-11-10T00:04:28.6598937Z +        &mut w15,
2025-11-10T00:04:28.6599711Z +        helpers::sigma1_small(w13),
2025-11-10T00:04:28.6600609Z +        w8,
2025-11-10T00:04:28.6601343Z +        helpers::sigma0_small(w0),
2025-11-10T00:04:28.6602233Z +    );
2025-11-10T00:04:28.6603239Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6604104Z      {
2025-11-10T00:04:28.6605051Z          let w15_after = _mm256_extract_epi32(w15, 0) as u32;
2025-11-10T00:04:28.6606958Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:497:
2025-11-10T00:04:28.6610771Z                   a_after_round31, b_after_round31, c_after_round31, d_after_round31,
2025-11-10T00:04:28.6612312Z                   e_after_round31, f_after_round31, g_after_round31, h_after_round31);
2025-11-10T00:04:28.6613537Z      }
2025-11-10T00:04:28.6614839Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-10T00:04:28.6616200Z +    helpers::inc4(
2025-11-10T00:04:28.6616927Z +        &mut w0,
2025-11-10T00:04:28.6619481Z +        helpers::sigma1_small(w14),
2025-11-10T00:04:28.6620371Z +        w9,
2025-11-10T00:04:28.6621110Z +        helpers::sigma0_small(w1),
2025-11-10T00:04:28.6621990Z +    );
2025-11-10T00:04:28.6622811Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-10T00:04:28.6624452Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-10T00:04:28.6625828Z +    helpers::inc4(
2025-11-10T00:04:28.6626561Z +        &mut w1,
2025-11-10T00:04:28.6627314Z +        helpers::sigma1_small(w15),
2025-11-10T00:04:28.6628208Z +        w10,
2025-11-10T00:04:28.6628942Z +        helpers::sigma0_small(w2),
2025-11-10T00:04:28.6629825Z +    );
2025-11-10T00:04:28.6630646Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-10T00:04:28.6632118Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-10T00:04:28.6633482Z +    helpers::inc4(
2025-11-10T00:04:28.6634208Z +        &mut w2,
2025-11-10T00:04:28.6635163Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.6637922Z +        w11,
2025-11-10T00:04:28.6638673Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.6639550Z +    );
2025-11-10T00:04:28.6640379Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-10T00:04:28.6641896Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-10T00:04:28.6643261Z +    helpers::inc4(
2025-11-10T00:04:28.6644497Z +        &mut w3,
2025-11-10T00:04:28.6645291Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.6646187Z +        w12,
2025-11-10T00:04:28.6646926Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.6649602Z +    );
2025-11-10T00:04:28.6650419Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-10T00:04:28.6651900Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-10T00:04:28.6653247Z +    helpers::inc4(
2025-11-10T00:04:28.6653972Z +        &mut w4,
2025-11-10T00:04:28.6654870Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.6655752Z +        w13,
2025-11-10T00:04:28.6658350Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.6659221Z +    );
2025-11-10T00:04:28.6660047Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-10T00:04:28.6661732Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-10T00:04:28.6663222Z +    helpers::inc4(
2025-11-10T00:04:28.6664161Z +        &mut w5,
2025-11-10T00:04:28.6665111Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.6667862Z +        w14,
2025-11-10T00:04:28.6668613Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.6669496Z +    );
2025-11-10T00:04:28.6670317Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-10T00:04:28.6671813Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-10T00:04:28.6673176Z +    helpers::inc4(
2025-11-10T00:04:28.6673921Z +        &mut w6,
2025-11-10T00:04:28.6674814Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.6675712Z +        w15,
2025-11-10T00:04:28.6678181Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.6679330Z +    );
2025-11-10T00:04:28.6680163Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-10T00:04:28.6681984Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-10T00:04:28.6683373Z +    helpers::inc4(
2025-11-10T00:04:28.6684105Z +        &mut w7,
2025-11-10T00:04:28.6685006Z +        helpers::sigma1_small(w5),
2025-11-10T00:04:28.6685888Z +        w0,
2025-11-10T00:04:28.6686638Z +        helpers::sigma0_small(w8),
2025-11-10T00:04:28.6687523Z +    );
2025-11-10T00:04:28.6688346Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-10T00:04:28.6689831Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-10T00:04:28.6691185Z +    helpers::inc4(
2025-11-10T00:04:28.6691914Z +        &mut w8,
2025-11-10T00:04:28.6692838Z +        helpers::sigma1_small(w6),
2025-11-10T00:04:28.6693888Z +        w1,
2025-11-10T00:04:28.6695161Z +        helpers::sigma0_small(w9),
2025-11-10T00:04:28.6708638Z +    );
2025-11-10T00:04:28.6709598Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-10T00:04:28.6711190Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-10T00:04:28.6712578Z +    helpers::inc4(
2025-11-10T00:04:28.6713319Z +        &mut w9,
2025-11-10T00:04:28.6714097Z +        helpers::sigma1_small(w7),
2025-11-10T00:04:28.6715158Z +        w2,
2025-11-10T00:04:28.6715903Z +        helpers::sigma0_small(w10),
2025-11-10T00:04:28.6716793Z +    );
2025-11-10T00:04:28.6719227Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-10T00:04:28.6720759Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-10T00:04:28.6722147Z +    helpers::inc4(
2025-11-10T00:04:28.6722883Z +        &mut w10,
2025-11-10T00:04:28.6723667Z +        helpers::sigma1_small(w8),
2025-11-10T00:04:28.6724924Z +        w3,
2025-11-10T00:04:28.6725696Z +        helpers::sigma0_small(w11),
2025-11-10T00:04:28.6726598Z +    );
2025-11-10T00:04:28.6727431Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-10T00:04:28.6730806Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-10T00:04:28.6732316Z +    helpers::inc4(
2025-11-10T00:04:28.6733066Z +        &mut w11,
2025-11-10T00:04:28.6733839Z +        helpers::sigma1_small(w9),
2025-11-10T00:04:28.6734875Z +        w4,
2025-11-10T00:04:28.6735625Z +        helpers::sigma0_small(w12),
2025-11-10T00:04:28.6736516Z +    );
2025-11-10T00:04:28.6737348Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-10T00:04:28.6738873Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-10T00:04:28.6740263Z +    helpers::inc4(
2025-11-10T00:04:28.6740996Z +        &mut w12,
2025-11-10T00:04:28.6741771Z +        helpers::sigma1_small(w10),
2025-11-10T00:04:28.6743035Z +        w5,
2025-11-10T00:04:28.6743795Z +        helpers::sigma0_small(w13),
2025-11-10T00:04:28.6745004Z +    );
2025-11-10T00:04:28.6746103Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-10T00:04:28.6747756Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-10T00:04:28.6750033Z +    helpers::inc4(
2025-11-10T00:04:28.6750769Z +        &mut w13,
2025-11-10T00:04:28.6751539Z +        helpers::sigma1_small(w11),
2025-11-10T00:04:28.6752592Z +        w6,
2025-11-10T00:04:28.6753337Z +        helpers::sigma0_small(w14),
2025-11-10T00:04:28.6754231Z +    );
2025-11-10T00:04:28.6755250Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-10T00:04:28.6758032Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-10T00:04:28.6759409Z +    helpers::inc4(
2025-11-10T00:04:28.6760144Z +        &mut w14,
2025-11-10T00:04:28.6760912Z +        helpers::sigma1_small(w12),
2025-11-10T00:04:28.6761820Z +        w7,
2025-11-10T00:04:28.6762582Z +        helpers::sigma0_small(w15),
2025-11-10T00:04:28.6763468Z +    );
2025-11-10T00:04:28.6764441Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-10T00:04:28.6765971Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-10T00:04:28.6767345Z +    helpers::inc4(
2025-11-10T00:04:28.6768069Z +        &mut w15,
2025-11-10T00:04:28.6768848Z +        helpers::sigma1_small(w13),
2025-11-10T00:04:28.6769928Z +        w8,
2025-11-10T00:04:28.6770960Z +        helpers::sigma0_small(w0),
2025-11-10T00:04:28.6771840Z +    );
2025-11-10T00:04:28.6772678Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-10T00:04:28.6774172Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-10T00:04:28.6775928Z +    helpers::inc4(
2025-11-10T00:04:28.6776665Z +        &mut w0,
2025-11-10T00:04:28.6777440Z +        helpers::sigma1_small(w14),
2025-11-10T00:04:28.6778350Z +        w9,
2025-11-10T00:04:28.6779096Z +        helpers::sigma0_small(w1),
2025-11-10T00:04:28.6779998Z +    );
2025-11-10T00:04:28.6781072Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-10T00:04:28.6782594Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-10T00:04:28.6783983Z +    helpers::inc4(
2025-11-10T00:04:28.6784880Z +        &mut w1,
2025-11-10T00:04:28.6785654Z +        helpers::sigma1_small(w15),
2025-11-10T00:04:28.6786538Z +        w10,
2025-11-10T00:04:28.6787281Z +        helpers::sigma0_small(w2),
2025-11-10T00:04:28.6788158Z +    );
2025-11-10T00:04:28.6788978Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-10T00:04:28.6790469Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-10T00:04:28.6791823Z +    helpers::inc4(
2025-11-10T00:04:28.6792550Z +        &mut w2,
2025-11-10T00:04:28.6793321Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.6794209Z +        w11,
2025-11-10T00:04:28.6795215Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.6796117Z +    );
2025-11-10T00:04:28.6796924Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-10T00:04:28.6798420Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-10T00:04:28.6799773Z +    helpers::inc4(
2025-11-10T00:04:28.6800500Z +        &mut w3,
2025-11-10T00:04:28.6801263Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.6802149Z +        w12,
2025-11-10T00:04:28.6802888Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.6803763Z +    );
2025-11-10T00:04:28.6804767Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-10T00:04:28.6806261Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-10T00:04:28.6807625Z +    helpers::inc4(
2025-11-10T00:04:28.6808347Z +        &mut w4,
2025-11-10T00:04:28.6809114Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.6809992Z +        w13,
2025-11-10T00:04:28.6810738Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.6811888Z +    );
2025-11-10T00:04:28.6812732Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-10T00:04:28.6814606Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-10T00:04:28.6816090Z +    helpers::inc4(
2025-11-10T00:04:28.6816833Z +        &mut w5,
2025-11-10T00:04:28.6817604Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.6818499Z +        w14,
2025-11-10T00:04:28.6819248Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.6820138Z +    );
2025-11-10T00:04:28.6820962Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-10T00:04:28.6822494Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-10T00:04:28.6823846Z +    helpers::inc4(
2025-11-10T00:04:28.6824738Z +        &mut w6,
2025-11-10T00:04:28.6825521Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.6826404Z +        w15,
2025-11-10T00:04:28.6827157Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.6828050Z +    );
2025-11-10T00:04:28.6828887Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-10T00:04:28.6830396Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-10T00:04:28.6831752Z +    helpers::inc4(
2025-11-10T00:04:28.6832479Z +        &mut w7,
2025-11-10T00:04:28.6833250Z +        helpers::sigma1_small(w5),
2025-11-10T00:04:28.6834136Z +        w0,
2025-11-10T00:04:28.6835020Z +        helpers::sigma0_small(w8),
2025-11-10T00:04:28.6835903Z +    );
2025-11-10T00:04:28.6836722Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-10T00:04:28.6838213Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-10T00:04:28.6839555Z +    helpers::inc4(
2025-11-10T00:04:28.6840290Z +        &mut w8,
2025-11-10T00:04:28.6841049Z +        helpers::sigma1_small(w6),
2025-11-10T00:04:28.6841929Z +        w1,
2025-11-10T00:04:28.6842666Z +        helpers::sigma0_small(w9),
2025-11-10T00:04:28.6843549Z +    );
2025-11-10T00:04:28.6844504Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-10T00:04:28.6846820Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-10T00:04:28.6848212Z +    helpers::inc4(
2025-11-10T00:04:28.6848942Z +        &mut w9,
2025-11-10T00:04:28.6849712Z +        helpers::sigma1_small(w7),
2025-11-10T00:04:28.6850590Z +        w2,
2025-11-10T00:04:28.6851333Z +        helpers::sigma0_small(w10),
2025-11-10T00:04:28.6852221Z +    );
2025-11-10T00:04:28.6853048Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-10T00:04:28.6854915Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-10T00:04:28.6856343Z +    helpers::inc4(
2025-11-10T00:04:28.6857083Z +        &mut w10,
2025-11-10T00:04:28.6857858Z +        helpers::sigma1_small(w8),
2025-11-10T00:04:28.6858751Z +        w3,
2025-11-10T00:04:28.6859492Z +        helpers::sigma0_small(w11),
2025-11-10T00:04:28.6860399Z +    );
2025-11-10T00:04:28.6861217Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-10T00:04:28.6863261Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-10T00:04:28.6865128Z +    helpers::inc4(
2025-11-10T00:04:28.6865879Z +        &mut w11,
2025-11-10T00:04:28.6866652Z +        helpers::sigma1_small(w9),
2025-11-10T00:04:28.6867863Z +        w4,
2025-11-10T00:04:28.6868632Z +        helpers::sigma0_small(w12),
2025-11-10T00:04:28.6869517Z +    );
2025-11-10T00:04:28.6870945Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-10T00:04:28.6872481Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-10T00:04:28.6873878Z +    helpers::inc4(
2025-11-10T00:04:28.6874773Z +        &mut w12,
2025-11-10T00:04:28.6875551Z +        helpers::sigma1_small(w10),
2025-11-10T00:04:28.6876440Z +        w5,
2025-11-10T00:04:28.6877188Z +        helpers::sigma0_small(w13),
2025-11-10T00:04:28.6878293Z +    );
2025-11-10T00:04:28.6879125Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-10T00:04:28.6880999Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-10T00:04:28.6882416Z +    helpers::inc4(
2025-11-10T00:04:28.6883144Z +        &mut w13,
2025-11-10T00:04:28.6883910Z +        helpers::sigma1_small(w11),
2025-11-10T00:04:28.6884944Z +        w6,
2025-11-10T00:04:28.6885679Z +        helpers::sigma0_small(w14),
2025-11-10T00:04:28.6886570Z +    );
2025-11-10T00:04:28.6887390Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-10T00:04:28.6888900Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-10T00:04:28.6890273Z +    helpers::inc4(
2025-11-10T00:04:28.6891004Z +        &mut w14,
2025-11-10T00:04:28.6891771Z +        helpers::sigma1_small(w12),
2025-11-10T00:04:28.6893087Z +        w7,
2025-11-10T00:04:28.6893876Z +        helpers::sigma0_small(w15),
2025-11-10T00:04:28.6895806Z +    );
2025-11-10T00:04:28.6896696Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[62]), w14));
2025-11-10T00:04:28.6898221Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-10T00:04:28.6899590Z +    helpers::inc4(
2025-11-10T00:04:28.6900319Z +        &mut w15,
2025-11-10T00:04:28.6901086Z +        helpers::sigma1_small(w13),
2025-11-10T00:04:28.6901964Z +        w8,
2025-11-10T00:04:28.6902699Z +        helpers::sigma0_small(w0),
2025-11-10T00:04:28.6903570Z +    );
2025-11-10T00:04:28.6904537Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[63]), w15));
2025-11-10T00:04:28.6905655Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.6906482Z      {
2025-11-10T00:04:28.6907994Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:578:
2025-11-10T00:04:28.6910221Z          // First SHA256 of 64 zero bytes should produce: 0x42fda5f5 (little-endian of first word)
2025-11-10T00:04:28.6911811Z          // So a should be: 0x42fda5f5 - 0x6a09e667 = 0xd8f3bf8e
2025-11-10T00:04:28.6913324Z          println!("DEBUG Expected a after round 63: 0xd8f3bf8e (0x42fda5f5 - 0x6a09e667)");
2025-11-10T00:04:28.6915263Z -        println!("DEBUG Difference: 0x{:08x}", a_after_round63.wrapping_sub(0xd8f3bf8e));
2025-11-10T00:04:28.6916620Z +        println!(
2025-11-10T00:04:28.6917404Z +            "DEBUG Difference: 0x{:08x}",
2025-11-10T00:04:28.6918441Z +            a_after_round63.wrapping_sub(0xd8f3bf8e)
2025-11-10T00:04:28.6920066Z +        );
2025-11-10T00:04:28.6920736Z      }
2025-11-10T00:04:28.6921382Z  
2025-11-10T00:04:28.6922163Z      // Add initial hash values (Transform 1 complete)
2025-11-10T00:04:28.6924029Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:586:
2025-11-10T00:04:28.6925895Z      {
2025-11-10T00:04:28.6926694Z          let a_before = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6927876Z          let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6929558Z -        println!("DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}", a_before, h_before);
2025-11-10T00:04:28.6931112Z +        println!(
2025-11-10T00:04:28.6932193Z +            "DEBUG Transform 1 before adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6933484Z +            a_before, h_before
2025-11-10T00:04:28.6934545Z +        );
2025-11-10T00:04:28.6935585Z          println!("Expected SHA256(64 zeros) first word: 0xf5a5fd42");
2025-11-10T00:04:28.6936737Z      }
2025-11-10T00:04:28.6937454Z      a = add(a, k(INITIAL_HASH.0[0]));
2025-11-10T00:04:28.6939213Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:601:
2025-11-10T00:04:28.6940935Z      {
2025-11-10T00:04:28.6941726Z          let a_after = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6942884Z          let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.6945677Z -        println!("DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}", a_after, h_after);
2025-11-10T00:04:28.6947245Z +        println!(
2025-11-10T00:04:28.6948316Z +            "DEBUG Transform 1 after adding initial hash: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.6949598Z +            a_after, h_after
2025-11-10T00:04:28.6950416Z +        );
2025-11-10T00:04:28.6951679Z          println!("Expected: a=0xf5a5fd42 (from SHA256(64 zeros))");
2025-11-10T00:04:28.6952813Z      }
2025-11-10T00:04:28.6953455Z  
2025-11-10T00:04:28.6955084Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:610:
2025-11-10T00:04:28.6956810Z      {
2025-11-10T00:04:28.6957639Z          let a_before_t2 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.6958836Z          let b_before_t2 = _mm256_extract_epi32(b, 0) as u32;
2025-11-10T00:04:28.6960451Z -        println!("DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}", a_before_t2, b_before_t2);
2025-11-10T00:04:28.6962055Z +        println!(
2025-11-10T00:04:28.6963080Z +            "DEBUG Transform 2 starting state: a=0x{:08x}, b=0x{:08x}",
2025-11-10T00:04:28.6964263Z +            a_before_t2, b_before_t2
2025-11-10T00:04:28.6965267Z +        );
2025-11-10T00:04:28.6966164Z      }
2025-11-10T00:04:28.6967239Z      let t0 = a;
2025-11-10T00:04:28.6970274Z      let t1 = b;
2025-11-10T00:04:28.6971851Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:711:
2025-11-10T00:04:28.6973604Z      {
2025-11-10T00:04:28.6974929Z          let w0_combined = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.6976204Z          let w1_combined = _mm256_extract_epi32(w1, 0) as u32;
2025-11-10T00:04:28.6977911Z -        println!("DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}", w0_combined, w1_combined);
2025-11-10T00:04:28.6979462Z +        println!(
2025-11-10T00:04:28.6980512Z +            "DEBUG After combining Transform 1 and 2: w0=0x{:08x}, w1=0x{:08x}",
2025-11-10T00:04:28.6982028Z +            w0_combined, w1_combined
2025-11-10T00:04:28.6982943Z +        );
2025-11-10T00:04:28.6983600Z      }
2025-11-10T00:04:28.6984237Z  
2025-11-10T00:04:28.6985329Z      // Transform 3: Final SHA256 on the combined state
2025-11-10T00:04:28.6987201Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:730:
2025-11-10T00:04:28.6988928Z      {
2025-11-10T00:04:28.6989701Z          let w0_t3 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.6991102Z          let w1_t3 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-10T00:04:28.6992503Z -        println!("DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}", w0_t3, w1_t3);
2025-11-10T00:04:28.6993915Z +        println!(
2025-11-10T00:04:28.6995626Z +            "DEBUG Transform 3 input w0=0x{:08x}, w1=0x{:08x}",
2025-11-10T00:04:28.6996865Z +            w0_t3, w1_t3
2025-11-10T00:04:28.6997653Z +        );
2025-11-10T00:04:28.6998326Z      }
2025-11-10T00:04:28.6999152Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[0]), w0));
2025-11-10T00:04:28.7000257Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7002308Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:737:
2025-11-10T00:04:28.7004031Z      {
2025-11-10T00:04:28.7005032Z          let a_after_t3_round0 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7006323Z          let h_after_t3_round0 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7008244Z -        println!("DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)", a_after_t3_round0, h_after_t3_round0);
2025-11-10T00:04:28.7009983Z +        println!(
2025-11-10T00:04:28.7011150Z +            "DEBUG Transform 3 after round 0: a=0x{:08x} (old), h=0x{:08x} (new a for next round)",
2025-11-10T00:04:28.7012588Z +            a_after_t3_round0, h_after_t3_round0
2025-11-10T00:04:28.7013756Z +        );
2025-11-10T00:04:28.7014042Z      }
2025-11-10T00:04:28.7014699Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[1]), w1));
2025-11-10T00:04:28.7015313Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[2]), w2));
2025-11-10T00:04:28.7018151Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:750:
2025-11-10T00:04:28.7018435Z      {
2025-11-10T00:04:28.7019563Z          // After round 7, the new a (for next round) is in h
2025-11-10T00:04:28.7020068Z          let h_after_t3_round7 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7020839Z -        println!("DEBUG Transform 3 after round 7: h (new a)=0x{:08x}", h_after_t3_round7);
2025-11-10T00:04:28.7021142Z +        println!(
2025-11-10T00:04:28.7021630Z +            "DEBUG Transform 3 after round 7: h (new a)=0x{:08x}",
2025-11-10T00:04:28.7021967Z +            h_after_t3_round7
2025-11-10T00:04:28.7022269Z +        );
2025-11-10T00:04:28.7022551Z      }
2025-11-10T00:04:28.7022958Z      round!(a, b, c, d, e, f, g, h, k(0x5807aa98));
2025-11-10T00:04:28.7023356Z      round!(h, a, b, c, d, e, f, g, k(0x12835b01));
2025-11-10T00:04:28.7025036Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:778:
2025-11-10T00:04:28.7025509Z          let f_after_15 = _mm256_extract_epi32(f, 0) as u32;
2025-11-10T00:04:28.7025967Z          let g_after_15 = _mm256_extract_epi32(g, 0) as u32;
2025-11-10T00:04:28.7026458Z          let h_after_15 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7027570Z -        println!("DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_after_15, b_after_15, c_after_15, d_after_15);
2025-11-10T00:04:28.7028338Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_after_15, f_after_15, g_after_15, h_after_15);
2025-11-10T00:04:28.7028645Z +        println!(
2025-11-10T00:04:28.7029366Z +            "DEBUG Transform 3 after round 15: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-10T00:04:28.7029796Z +            a_after_15, b_after_15, c_after_15, d_after_15
2025-11-10T00:04:28.7030083Z +        );
2025-11-10T00:04:28.7030394Z +        println!(
2025-11-10T00:04:28.7030791Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.7031203Z +            e_after_15, f_after_15, g_after_15, h_after_15
2025-11-10T00:04:28.7031492Z +        );
2025-11-10T00:04:28.7032193Z          println!("  Expected: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-10T00:04:28.7032488Z      }
2025-11-10T00:04:28.7032771Z  
2025-11-10T00:04:28.7033910Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:795:
2025-11-10T00:04:28.7034507Z          let f_before_16 = _mm256_extract_epi32(f, 0) as u32;
2025-11-10T00:04:28.7034980Z          let g_before_16 = _mm256_extract_epi32(g, 0) as u32;
2025-11-10T00:04:28.7035441Z          let h_before_16 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7036625Z -        println!("DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_16, b_before_16, c_before_16, d_before_16);
2025-11-10T00:04:28.7037418Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_16, f_before_16, g_before_16, h_before_16);
2025-11-10T00:04:28.7038615Z -        println!("  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027");
2025-11-10T00:04:28.7038929Z +        println!(
2025-11-10T00:04:28.7039662Z +            "DEBUG Transform 3 before round 16: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-10T00:04:28.7040101Z +            a_before_16, b_before_16, c_before_16, d_before_16
2025-11-10T00:04:28.7040396Z +        );
2025-11-10T00:04:28.7040988Z +        println!(
2025-11-10T00:04:28.7041404Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.7041850Z +            e_before_16, f_before_16, g_before_16, h_before_16
2025-11-10T00:04:28.7042350Z +        );
2025-11-10T00:04:28.7042659Z +        println!(
2025-11-10T00:04:28.7043510Z +            "  Expected after round 15: a=0xf5539ad2, b=0x2c0362a7, c=0xda1fbbd3, d=0x3c3a4027"
2025-11-10T00:04:28.7043805Z +        );
2025-11-10T00:04:28.7045154Z          let w0_before_t3_round16 = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.7045713Z          let w1_before_t3_round16 = _mm256_extract_epi32(w1, 0) as u32;
2025-11-10T00:04:28.7046748Z -        println!("DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}", w0_before_t3_round16, w1_before_t3_round16);
2025-11-10T00:04:28.7047059Z +        println!(
2025-11-10T00:04:28.7047666Z +            "DEBUG Transform 3 round 16 before inc: w0=0x{:08x}, w1=0x{:08x}",
2025-11-10T00:04:28.7048072Z +            w0_before_t3_round16, w1_before_t3_round16
2025-11-10T00:04:28.7048363Z +        );
2025-11-10T00:04:28.7048654Z      }
2025-11-10T00:04:28.7049265Z      // Save old values before round 16 - these will be needed in round 17
2025-11-10T00:04:28.7049983Z      // Round 16 modifies d and h, so we save c and d (which become $d and $e in round 17)
2025-11-10T00:04:28.7051149Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:818:
2025-11-10T00:04:28.7051436Z      {
2025-11-10T00:04:28.7052080Z          let w0_before = _mm256_extract_epi32(w0, 0) as u32;
2025-11-10T00:04:28.7052614Z          let w1_before = _mm256_extract_epi32(w1, 0) as u32;
2025-11-10T00:04:28.7053296Z -        println!("DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}", w0_before, w1_before);
2025-11-10T00:04:28.7053602Z +        println!(
2025-11-10T00:04:28.7054022Z +            "DEBUG T3 R16 before: w0=0x{:08x} w1=0x{:08x}",
2025-11-10T00:04:28.7054521Z +            w0_before, w1_before
2025-11-10T00:04:28.7054812Z +        );
2025-11-10T00:04:28.7055094Z      }
2025-11-10T00:04:28.7055587Z      helpers::inc(&mut w0, helpers::sigma0_small(w1));
2025-11-10T00:04:28.7055926Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7057077Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:839:
2025-11-10T00:04:28.7057514Z          let g_after = _mm256_extract_epi32(g, 0) as u32;
2025-11-10T00:04:28.7057980Z          println!("DEBUG T3 R17 after: g=0x{:08x}", g_after);
2025-11-10T00:04:28.7058266Z      }
2025-11-10T00:04:28.7058956Z -    helpers::inc3(&mut w2, helpers::sigma1_small(w0), helpers::sigma0_small(w3));
2025-11-10T00:04:28.7059273Z +    helpers::inc3(
2025-11-10T00:04:28.7059566Z +        &mut w2,
2025-11-10T00:04:28.7059918Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.7060270Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.7060553Z +    );
2025-11-10T00:04:28.7061018Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[18]), w2));
2025-11-10T00:04:28.7061699Z -    helpers::inc3(&mut w3, helpers::sigma1_small(w1), helpers::sigma0_small(w4));
2025-11-10T00:04:28.7062019Z +    helpers::inc3(
2025-11-10T00:04:28.7062314Z +        &mut w3,
2025-11-10T00:04:28.7062677Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.7063030Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.7063323Z +    );
2025-11-10T00:04:28.7063784Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[19]), w3));
2025-11-10T00:04:28.7064642Z -    helpers::inc3(&mut w4, helpers::sigma1_small(w2), helpers::sigma0_small(w5));
2025-11-10T00:04:28.7064972Z +    helpers::inc3(
2025-11-10T00:04:28.7065265Z +        &mut w4,
2025-11-10T00:04:28.7065615Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.7065969Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.7066248Z +    );
2025-11-10T00:04:28.7066712Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[20]), w4));
2025-11-10T00:04:28.7067398Z -    helpers::inc3(&mut w5, helpers::sigma1_small(w3), helpers::sigma0_small(w6));
2025-11-10T00:04:28.7067721Z +    helpers::inc3(
2025-11-10T00:04:28.7069950Z +        &mut w5,
2025-11-10T00:04:28.7070309Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.7070845Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.7071130Z +    );
2025-11-10T00:04:28.7071716Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[21]), w5));
2025-11-10T00:04:28.7072844Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), k(0x100), helpers::sigma0_small(w7));
2025-11-10T00:04:28.7073176Z +    helpers::inc4(
2025-11-10T00:04:28.7073469Z +        &mut w6,
2025-11-10T00:04:28.7073819Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.7074117Z +        k(0x100),
2025-11-10T00:04:28.7074606Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.7074890Z +    );
2025-11-10T00:04:28.7075351Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[22]), w6));
2025-11-10T00:04:28.7077717Z      helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, k(0x11002000));
2025-11-10T00:04:28.7078175Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[23]), w7));
2025-11-10T00:04:28.7079323Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:865:
2025-11-10T00:04:28.7079810Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[29]), w13));
2025-11-10T00:04:28.7080395Z      w14 = helpers::add3(helpers::sigma1_small(w12), w7, k(0x400022));
2025-11-10T00:04:28.7081080Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[30]), w14));
2025-11-10T00:04:28.7081871Z -    w15 = helpers::add4(k(0x100), helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-10T00:04:28.7082595Z +    w15 = helpers::add4(
2025-11-10T00:04:28.7082898Z +        k(0x100),
2025-11-10T00:04:28.7083262Z +        helpers::sigma1_small(w13),
2025-11-10T00:04:28.7083551Z +        w8,
2025-11-10T00:04:28.7083902Z +        helpers::sigma0_small(w0),
2025-11-10T00:04:28.7084187Z +    );
2025-11-10T00:04:28.7084823Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[31]), w15));
2025-11-10T00:04:28.7085106Z -    
2025-11-10T00:04:28.7085387Z +
2025-11-10T00:04:28.7088177Z      // Continue with standard message schedule for rounds 32-63 (matching Core Transform 3 pattern)
2025-11-10T00:04:28.7088543Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7088825Z      {
2025-11-10T00:04:28.7089973Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:874:
2025-11-10T00:04:28.7090442Z          let a_before_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7090973Z          println!("DEBUG T3 R32 before: a=0x{:08x}", a_before_32);
2025-11-10T00:04:28.7091255Z      }
2025-11-10T00:04:28.7091977Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-10T00:04:28.7092297Z +    helpers::inc4(
2025-11-10T00:04:28.7092595Z +        &mut w0,
2025-11-10T00:04:28.7092948Z +        helpers::sigma1_small(w14),
2025-11-10T00:04:28.7093237Z +        w9,
2025-11-10T00:04:28.7093591Z +        helpers::sigma0_small(w1),
2025-11-10T00:04:28.7093877Z +    );
2025-11-10T00:04:28.7095119Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[32]), w0));
2025-11-10T00:04:28.7095473Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7095776Z      {
2025-11-10T00:04:28.7096942Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:881:
2025-11-10T00:04:28.7097395Z          let a_after_32 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7097898Z          println!("DEBUG T3 R32 after: a=0x{:08x}", a_after_32);
2025-11-10T00:04:28.7098185Z      }
2025-11-10T00:04:28.7098927Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-10T00:04:28.7099253Z +    helpers::inc4(
2025-11-10T00:04:28.7099546Z +        &mut w1,
2025-11-10T00:04:28.7099900Z +        helpers::sigma1_small(w15),
2025-11-10T00:04:28.7100190Z +        w10,
2025-11-10T00:04:28.7100548Z +        helpers::sigma0_small(w2),
2025-11-10T00:04:28.7100839Z +    );
2025-11-10T00:04:28.7101308Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[33]), w1));
2025-11-10T00:04:28.7102259Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-10T00:04:28.7103057Z +    helpers::inc4(
2025-11-10T00:04:28.7103540Z +        &mut w2,
2025-11-10T00:04:28.7104935Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.7105482Z +        w11,
2025-11-10T00:04:28.7106093Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.7106562Z +    );
2025-11-10T00:04:28.7107365Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[34]), w2));
2025-11-10T00:04:28.7108651Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-10T00:04:28.7109176Z +    helpers::inc4(
2025-11-10T00:04:28.7109661Z +        &mut w3,
2025-11-10T00:04:28.7110258Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.7110738Z +        w12,
2025-11-10T00:04:28.7111318Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.7111797Z +    );
2025-11-10T00:04:28.7112583Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[35]), w3));
2025-11-10T00:04:28.7113862Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-10T00:04:28.7114550Z +    helpers::inc4(
2025-11-10T00:04:28.7115043Z +        &mut w4,
2025-11-10T00:04:28.7115643Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.7116120Z +        w13,
2025-11-10T00:04:28.7116708Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.7117179Z +    );
2025-11-10T00:04:28.7117964Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[36]), w4));
2025-11-10T00:04:28.7120120Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-10T00:04:28.7120663Z +    helpers::inc4(
2025-11-10T00:04:28.7121151Z +        &mut w5,
2025-11-10T00:04:28.7121731Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.7122223Z +        w14,
2025-11-10T00:04:28.7122808Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.7123279Z +    );
2025-11-10T00:04:28.7124065Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[37]), w5));
2025-11-10T00:04:28.7125501Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-10T00:04:28.7126043Z +    helpers::inc4(
2025-11-10T00:04:28.7126526Z +        &mut w6,
2025-11-10T00:04:28.7127130Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.7127609Z +        w15,
2025-11-10T00:04:28.7128197Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.7128669Z +    );
2025-11-10T00:04:28.7129465Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[38]), w6));
2025-11-10T00:04:28.7130739Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-10T00:04:28.7131263Z +    helpers::inc4(
2025-11-10T00:04:28.7131750Z +        &mut w7,
2025-11-10T00:04:28.7132339Z +        helpers::sigma1_small(w5),
2025-11-10T00:04:28.7132822Z +        w0,
2025-11-10T00:04:28.7135436Z +        helpers::sigma0_small(w8),
2025-11-10T00:04:28.7135922Z +    );
2025-11-10T00:04:28.7136709Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[39]), w7));
2025-11-10T00:04:28.7137986Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-10T00:04:28.7138531Z +    helpers::inc4(
2025-11-10T00:04:28.7139015Z +        &mut w8,
2025-11-10T00:04:28.7139615Z +        helpers::sigma1_small(w6),
2025-11-10T00:04:28.7140103Z +        w1,
2025-11-10T00:04:28.7140682Z +        helpers::sigma0_small(w9),
2025-11-10T00:04:28.7141152Z +    );
2025-11-10T00:04:28.7141935Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[40]), w8));
2025-11-10T00:04:28.7142531Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7143002Z      {
2025-11-10T00:04:28.7146072Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:902:
2025-11-10T00:04:28.7146858Z          let a_after_40 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7147611Z          let h_after_40 = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7148770Z -        println!("DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}", a_after_40, h_after_40);
2025-11-10T00:04:28.7150863Z +        println!(
2025-11-10T00:04:28.7151780Z +            "DEBUG T3 R40 after: a=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.7152330Z +            a_after_40, h_after_40
2025-11-10T00:04:28.7153040Z +        );
2025-11-10T00:04:28.7153525Z      }
2025-11-10T00:04:28.7154969Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-10T00:04:28.7155498Z +    helpers::inc4(
2025-11-10T00:04:28.7155990Z +        &mut w9,
2025-11-10T00:04:28.7156579Z +        helpers::sigma1_small(w7),
2025-11-10T00:04:28.7157062Z +        w2,
2025-11-10T00:04:28.7157666Z +        helpers::sigma0_small(w10),
2025-11-10T00:04:28.7158137Z +    );
2025-11-10T00:04:28.7158923Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[41]), w9));
2025-11-10T00:04:28.7160235Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-10T00:04:28.7160768Z +    helpers::inc4(
2025-11-10T00:04:28.7161260Z +        &mut w10,
2025-11-10T00:04:28.7161842Z +        helpers::sigma1_small(w8),
2025-11-10T00:04:28.7162353Z +        w3,
2025-11-10T00:04:28.7162945Z +        helpers::sigma0_small(w11),
2025-11-10T00:04:28.7163418Z +    );
2025-11-10T00:04:28.7164224Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[42]), w10));
2025-11-10T00:04:28.7165688Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-10T00:04:28.7166218Z +    helpers::inc4(
2025-11-10T00:04:28.7169180Z +        &mut w11,
2025-11-10T00:04:28.7169786Z +        helpers::sigma1_small(w9),
2025-11-10T00:04:28.7170268Z +        w4,
2025-11-10T00:04:28.7170857Z +        helpers::sigma0_small(w12),
2025-11-10T00:04:28.7171332Z +    );
2025-11-10T00:04:28.7172138Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[43]), w11));
2025-11-10T00:04:28.7173463Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-10T00:04:28.7173987Z +    helpers::inc4(
2025-11-10T00:04:28.7174688Z +        &mut w12,
2025-11-10T00:04:28.7175286Z +        helpers::sigma1_small(w10),
2025-11-10T00:04:28.7175787Z +        w5,
2025-11-10T00:04:28.7177933Z +        helpers::sigma0_small(w13),
2025-11-10T00:04:28.7178577Z +    );
2025-11-10T00:04:28.7179448Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[44]), w12));
2025-11-10T00:04:28.7181036Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-10T00:04:28.7181863Z +    helpers::inc4(
2025-11-10T00:04:28.7199526Z +        &mut w13,
2025-11-10T00:04:28.7200223Z +        helpers::sigma1_small(w11),
2025-11-10T00:04:28.7200708Z +        w6,
2025-11-10T00:04:28.7201306Z +        helpers::sigma0_small(w14),
2025-11-10T00:04:28.7201787Z +    );
2025-11-10T00:04:28.7202592Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[45]), w13));
2025-11-10T00:04:28.7203921Z -    helpers::inc4(&mut w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15));
2025-11-10T00:04:28.7204607Z +    helpers::inc4(
2025-11-10T00:04:28.7205106Z +        &mut w14,
2025-11-10T00:04:28.7205696Z +        helpers::sigma1_small(w12),
2025-11-10T00:04:28.7206201Z +        w7,
2025-11-10T00:04:28.7206799Z +        helpers::sigma0_small(w15),
2025-11-10T00:04:28.7207285Z +    );
2025-11-10T00:04:28.7208080Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[46]), w14));
2025-11-10T00:04:28.7209381Z -    helpers::inc4(&mut w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0));
2025-11-10T00:04:28.7209910Z +    helpers::inc4(
2025-11-10T00:04:28.7210396Z +        &mut w15,
2025-11-10T00:04:28.7210980Z +        helpers::sigma1_small(w13),
2025-11-10T00:04:28.7211464Z +        w8,
2025-11-10T00:04:28.7212041Z +        helpers::sigma0_small(w0),
2025-11-10T00:04:28.7212508Z +    );
2025-11-10T00:04:28.7213299Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[47]), w15));
2025-11-10T00:04:28.7214721Z -    helpers::inc4(&mut w0, helpers::sigma1_small(w14), w9, helpers::sigma0_small(w1));
2025-11-10T00:04:28.7215247Z +    helpers::inc4(
2025-11-10T00:04:28.7215734Z +        &mut w0,
2025-11-10T00:04:28.7217212Z +        helpers::sigma1_small(w14),
2025-11-10T00:04:28.7217698Z +        w9,
2025-11-10T00:04:28.7218278Z +        helpers::sigma0_small(w1),
2025-11-10T00:04:28.7218995Z +    );
2025-11-10T00:04:28.7219792Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[48]), w0));
2025-11-10T00:04:28.7220352Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7220816Z      {
2025-11-10T00:04:28.7222876Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:924:
2025-11-10T00:04:28.7223636Z          let a_after_48 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7224631Z          println!("DEBUG T3 R48 after: a=0x{:08x}", a_after_48);
2025-11-10T00:04:28.7225116Z      }
2025-11-10T00:04:28.7226413Z -    helpers::inc4(&mut w1, helpers::sigma1_small(w15), w10, helpers::sigma0_small(w2));
2025-11-10T00:04:28.7226934Z +    helpers::inc4(
2025-11-10T00:04:28.7227414Z +        &mut w1,
2025-11-10T00:04:28.7228006Z +        helpers::sigma1_small(w15),
2025-11-10T00:04:28.7228505Z +        w10,
2025-11-10T00:04:28.7229081Z +        helpers::sigma0_small(w2),
2025-11-10T00:04:28.7229559Z +    );
2025-11-10T00:04:28.7230350Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[49]), w1));
2025-11-10T00:04:28.7231623Z -    helpers::inc4(&mut w2, helpers::sigma1_small(w0), w11, helpers::sigma0_small(w3));
2025-11-10T00:04:28.7232148Z +    helpers::inc4(
2025-11-10T00:04:28.7232632Z +        &mut w2,
2025-11-10T00:04:28.7233209Z +        helpers::sigma1_small(w0),
2025-11-10T00:04:28.7233673Z +        w11,
2025-11-10T00:04:28.7234261Z +        helpers::sigma0_small(w3),
2025-11-10T00:04:28.7234846Z +    );
2025-11-10T00:04:28.7235642Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[50]), w2));
2025-11-10T00:04:28.7236922Z -    helpers::inc4(&mut w3, helpers::sigma1_small(w1), w12, helpers::sigma0_small(w4));
2025-11-10T00:04:28.7237447Z +    helpers::inc4(
2025-11-10T00:04:28.7237923Z +        &mut w3,
2025-11-10T00:04:28.7238500Z +        helpers::sigma1_small(w1),
2025-11-10T00:04:28.7239004Z +        w12,
2025-11-10T00:04:28.7239576Z +        helpers::sigma0_small(w4),
2025-11-10T00:04:28.7240043Z +    );
2025-11-10T00:04:28.7241283Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[51]), w3));
2025-11-10T00:04:28.7242570Z -    helpers::inc4(&mut w4, helpers::sigma1_small(w2), w13, helpers::sigma0_small(w5));
2025-11-10T00:04:28.7243086Z +    helpers::inc4(
2025-11-10T00:04:28.7243564Z +        &mut w4,
2025-11-10T00:04:28.7244153Z +        helpers::sigma1_small(w2),
2025-11-10T00:04:28.7244812Z +        w13,
2025-11-10T00:04:28.7245393Z +        helpers::sigma0_small(w5),
2025-11-10T00:04:28.7245857Z +    );
2025-11-10T00:04:28.7246645Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[52]), w4));
2025-11-10T00:04:28.7247911Z -    helpers::inc4(&mut w5, helpers::sigma1_small(w3), w14, helpers::sigma0_small(w6));
2025-11-10T00:04:28.7248426Z +    helpers::inc4(
2025-11-10T00:04:28.7248910Z +        &mut w5,
2025-11-10T00:04:28.7249486Z +        helpers::sigma1_small(w3),
2025-11-10T00:04:28.7249967Z +        w14,
2025-11-10T00:04:28.7250555Z +        helpers::sigma0_small(w6),
2025-11-10T00:04:28.7251027Z +    );
2025-11-10T00:04:28.7251821Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[53]), w5));
2025-11-10T00:04:28.7253077Z -    helpers::inc4(&mut w6, helpers::sigma1_small(w4), w15, helpers::sigma0_small(w7));
2025-11-10T00:04:28.7253602Z +    helpers::inc4(
2025-11-10T00:04:28.7254076Z +        &mut w6,
2025-11-10T00:04:28.7254808Z +        helpers::sigma1_small(w4),
2025-11-10T00:04:28.7255295Z +        w15,
2025-11-10T00:04:28.7255880Z +        helpers::sigma0_small(w7),
2025-11-10T00:04:28.7256349Z +    );
2025-11-10T00:04:28.7257124Z      round!(c, d, e, f, g, h, a, b, add(k(K_ARRAY.0[54]), w6));
2025-11-10T00:04:28.7258388Z -    helpers::inc4(&mut w7, helpers::sigma1_small(w5), w0, helpers::sigma0_small(w8));
2025-11-10T00:04:28.7258909Z +    helpers::inc4(
2025-11-10T00:04:28.7259390Z +        &mut w7,
2025-11-10T00:04:28.7259975Z +        helpers::sigma1_small(w5),
2025-11-10T00:04:28.7260686Z +        w0,
2025-11-10T00:04:28.7261268Z +        helpers::sigma0_small(w8),
2025-11-10T00:04:28.7261736Z +    );
2025-11-10T00:04:28.7262710Z      round!(b, c, d, e, f, g, h, a, add(k(K_ARRAY.0[55]), w7));
2025-11-10T00:04:28.7265361Z -    helpers::inc4(&mut w8, helpers::sigma1_small(w6), w1, helpers::sigma0_small(w9));
2025-11-10T00:04:28.7265908Z +    helpers::inc4(
2025-11-10T00:04:28.7266394Z +        &mut w8,
2025-11-10T00:04:28.7266971Z +        helpers::sigma1_small(w6),
2025-11-10T00:04:28.7267447Z +        w1,
2025-11-10T00:04:28.7268023Z +        helpers::sigma0_small(w9),
2025-11-10T00:04:28.7268497Z +    );
2025-11-10T00:04:28.7269274Z      round!(a, b, c, d, e, f, g, h, add(k(K_ARRAY.0[56]), w8));
2025-11-10T00:04:28.7269838Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7270313Z      {
2025-11-10T00:04:28.7272396Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:945:
2025-11-10T00:04:28.7273168Z          let a_after_56 = _mm256_extract_epi32(a, 0) as u32;
2025-11-10T00:04:28.7274007Z          println!("DEBUG T3 R56 after: a=0x{:08x}", a_after_56);
2025-11-10T00:04:28.7274631Z      }
2025-11-10T00:04:28.7275904Z -    helpers::inc4(&mut w9, helpers::sigma1_small(w7), w2, helpers::sigma0_small(w10));
2025-11-10T00:04:28.7276426Z +    helpers::inc4(
2025-11-10T00:04:28.7276912Z +        &mut w9,
2025-11-10T00:04:28.7277491Z +        helpers::sigma1_small(w7),
2025-11-10T00:04:28.7277971Z +        w2,
2025-11-10T00:04:28.7278564Z +        helpers::sigma0_small(w10),
2025-11-10T00:04:28.7279033Z +    );
2025-11-10T00:04:28.7279810Z      round!(h, a, b, c, d, e, f, g, add(k(K_ARRAY.0[57]), w9));
2025-11-10T00:04:28.7281390Z -    helpers::inc4(&mut w10, helpers::sigma1_small(w8), w3, helpers::sigma0_small(w11));
2025-11-10T00:04:28.7281913Z +    helpers::inc4(
2025-11-10T00:04:28.7282398Z +        &mut w10,
2025-11-10T00:04:28.7282970Z +        helpers::sigma1_small(w8),
2025-11-10T00:04:28.7283454Z +        w3,
2025-11-10T00:04:28.7284048Z +        helpers::sigma0_small(w11),
2025-11-10T00:04:28.7284653Z +    );
2025-11-10T00:04:28.7285455Z      round!(g, h, a, b, c, d, e, f, add(k(K_ARRAY.0[58]), w10));
2025-11-10T00:04:28.7288139Z -    helpers::inc4(&mut w11, helpers::sigma1_small(w9), w4, helpers::sigma0_small(w12));
2025-11-10T00:04:28.7288656Z +    helpers::inc4(
2025-11-10T00:04:28.7289139Z +        &mut w11,
2025-11-10T00:04:28.7289722Z +        helpers::sigma1_small(w9),
2025-11-10T00:04:28.7290195Z +        w4,
2025-11-10T00:04:28.7290778Z +        helpers::sigma0_small(w12),
2025-11-10T00:04:28.7291243Z +    );
2025-11-10T00:04:28.7292036Z      round!(f, g, h, a, b, c, d, e, add(k(K_ARRAY.0[59]), w11));
2025-11-10T00:04:28.7293346Z -    helpers::inc4(&mut w12, helpers::sigma1_small(w10), w5, helpers::sigma0_small(w13));
2025-11-10T00:04:28.7293866Z +    helpers::inc4(
2025-11-10T00:04:28.7294491Z +        &mut w12,
2025-11-10T00:04:28.7295078Z +        helpers::sigma1_small(w10),
2025-11-10T00:04:28.7295569Z +        w5,
2025-11-10T00:04:28.7297830Z +        helpers::sigma0_small(w13),
2025-11-10T00:04:28.7298305Z +    );
2025-11-10T00:04:28.7299099Z      round!(e, f, g, h, a, b, c, d, add(k(K_ARRAY.0[60]), w12));
2025-11-10T00:04:28.7300408Z -    helpers::inc4(&mut w13, helpers::sigma1_small(w11), w6, helpers::sigma0_small(w14));
2025-11-10T00:04:28.7300933Z +    helpers::inc4(
2025-11-10T00:04:28.7301416Z +        &mut w13,
2025-11-10T00:04:28.7301996Z +        helpers::sigma1_small(w11),
2025-11-10T00:04:28.7302473Z +        w6,
2025-11-10T00:04:28.7303065Z +        helpers::sigma0_small(w14),
2025-11-10T00:04:28.7303532Z +    );
2025-11-10T00:04:28.7304457Z      round!(d, e, f, g, h, a, b, c, add(k(K_ARRAY.0[61]), w13));
2025-11-10T00:04:28.7306079Z      // Core Transform 3 rounds 62-63: Use Add with 5 args, w14/w15 NOT modified (different from Transform 1)
2025-11-10T00:04:28.7308153Z -    round!(c, d, e, f, g, h, a, b, helpers::add5(k(K_ARRAY.0[62]), w14, helpers::sigma1_small(w12), w7, helpers::sigma0_small(w15)));
2025-11-10T00:04:28.7310574Z -    round!(b, c, d, e, f, g, h, a, helpers::add5(k(K_ARRAY.0[63]), w15, helpers::sigma1_small(w13), w8, helpers::sigma0_small(w0)));
2025-11-10T00:04:28.7311070Z +    round!(
2025-11-10T00:04:28.7311594Z +        c,
2025-11-10T00:04:28.7312068Z +        d,
2025-11-10T00:04:28.7312543Z +        e,
2025-11-10T00:04:28.7313023Z +        f,
2025-11-10T00:04:28.7314033Z +        g,
2025-11-10T00:04:28.7314695Z +        h,
2025-11-10T00:04:28.7315178Z +        a,
2025-11-10T00:04:28.7315647Z +        b,
2025-11-10T00:04:28.7316183Z +        helpers::add5(
2025-11-10T00:04:28.7316718Z +            k(K_ARRAY.0[62]),
2025-11-10T00:04:28.7317246Z +            w14,
2025-11-10T00:04:28.7317847Z +            helpers::sigma1_small(w12),
2025-11-10T00:04:28.7318299Z +            w7,
2025-11-10T00:04:28.7318879Z +            helpers::sigma0_small(w15)
2025-11-10T00:04:28.7319351Z +        )
2025-11-10T00:04:28.7319816Z +    );
2025-11-10T00:04:28.7320289Z +    round!(
2025-11-10T00:04:28.7320793Z +        b,
2025-11-10T00:04:28.7321245Z +        c,
2025-11-10T00:04:28.7321728Z +        d,
2025-11-10T00:04:28.7322199Z +        e,
2025-11-10T00:04:28.7322699Z +        f,
2025-11-10T00:04:28.7323176Z +        g,
2025-11-10T00:04:28.7323645Z +        h,
2025-11-10T00:04:28.7324126Z +        a,
2025-11-10T00:04:28.7324808Z +        helpers::add5(
2025-11-10T00:04:28.7325364Z +            k(K_ARRAY.0[63]),
2025-11-10T00:04:28.7327751Z +            w15,
2025-11-10T00:04:28.7328360Z +            helpers::sigma1_small(w13),
2025-11-10T00:04:28.7328838Z +            w8,
2025-11-10T00:04:28.7329429Z +            helpers::sigma0_small(w0)
2025-11-10T00:04:28.7329908Z +        )
2025-11-10T00:04:28.7330377Z +    );
2025-11-10T00:04:28.7330842Z  
2025-11-10T00:04:28.7331503Z      // Add initial hash values and write output
2025-11-10T00:04:28.7332301Z      // Core: Add initial hash values before writing output
2025-11-10T00:04:28.7334511Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:976:
2025-11-10T00:04:28.7335356Z          let f_before_final = _mm256_extract_epi32(f, 0) as u32;
2025-11-10T00:04:28.7337877Z          let g_before_final = _mm256_extract_epi32(g, 0) as u32;
2025-11-10T00:04:28.7338689Z          let h_before_final = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7340976Z -        println!("DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}", a_before_final, b_before_final, c_before_final, d_before_final);
2025-11-10T00:04:28.7342668Z -        println!("  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}", e_before_final, f_before_final, g_before_final, h_before_final);
2025-11-10T00:04:28.7344593Z -        println!("DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)", a_before_final);
2025-11-10T00:04:28.7345105Z +        println!(
2025-11-10T00:04:28.7346367Z +            "DEBUG Transform 3 after round 63: a=0x{:08x}, b=0x{:08x}, c=0x{:08x}, d=0x{:08x}",
2025-11-10T00:04:28.7347354Z +            a_before_final, b_before_final, c_before_final, d_before_final
2025-11-10T00:04:28.7347829Z +        );
2025-11-10T00:04:28.7348334Z +        println!(
2025-11-10T00:04:28.7349011Z +            "  e=0x{:08x}, f=0x{:08x}, g=0x{:08x}, h=0x{:08x}",
2025-11-10T00:04:28.7349989Z +            e_before_final, f_before_final, g_before_final, h_before_final
2025-11-10T00:04:28.7350465Z +        );
2025-11-10T00:04:28.7350968Z +        println!(
2025-11-10T00:04:28.7352300Z +            "DEBUG Transform 3 before adding initial hash: a=0x{:08x} (expected 0x78ec3678)",
2025-11-10T00:04:28.7352833Z +            a_before_final
2025-11-10T00:04:28.7353307Z +        );
2025-11-10T00:04:28.7353780Z      }
2025-11-10T00:04:28.7354538Z      // Write8(out, 0, Add(a, K(0x6a09e667ul)));
2025-11-10T00:04:28.7355203Z      let a_final = add(a, k(INITIAL_HASH.0[0]));
2025-11-10T00:04:28.7357323Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:985:
2025-11-10T00:04:28.7358096Z      #[cfg(debug_assertions)]
2025-11-10T00:04:28.7358566Z      {
2025-11-10T00:04:28.7359609Z          let a_final_val = _mm256_extract_epi32(a_final, 0) as u32;
2025-11-10T00:04:28.7361417Z -        println!("DEBUG Transform 3 final a (after adding initial): 0x{:08x}", a_final_val);
2025-11-10T00:04:28.7361921Z +        println!(
2025-11-10T00:04:28.7362889Z +            "DEBUG Transform 3 final a (after adding initial): 0x{:08x}",
2025-11-10T00:04:28.7363406Z +            a_final_val
2025-11-10T00:04:28.7363877Z +        );
2025-11-10T00:04:28.7364483Z      }
2025-11-10T00:04:28.7365034Z      write8(out, 0, a_final);
2025-11-10T00:04:28.7365715Z      write8(out, 4, add(b, k(INITIAL_HASH.0[1])));
2025-11-10T00:04:28.7367802Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1015:
2025-11-10T00:04:28.7368860Z      // For inputs that aren't exactly 64 bytes, we need to handle padding
2025-11-10T00:04:28.7369750Z      // For now, use sha2 crate as fallback for non-64-byte inputs
2025-11-10T00:04:28.7370564Z      use bitcoin_hashes::{sha256d, Hash as BitcoinHash};
2025-11-10T00:04:28.7371052Z -    
2025-11-10T00:04:28.7371524Z +
2025-11-10T00:04:28.7372187Z      // Check if all inputs are exactly 64 bytes
2025-11-10T00:04:28.7373156Z      let all_64_bytes = inputs.iter().all(|input| input.len() == 64);
2025-11-10T00:04:28.7373628Z -    
2025-11-10T00:04:28.7374089Z +
2025-11-10T00:04:28.7374804Z      if !all_64_bytes {
2025-11-10T00:04:28.7375544Z          // Fallback to sha2 crate for non-64-byte inputs
2025-11-10T00:04:28.7376142Z          let mut results = [[0u8; 32]; 8];
2025-11-10T00:04:28.7378230Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1028:
2025-11-10T00:04:28.7378702Z          }
2025-11-10T00:04:28.7379227Z          return results;
2025-11-10T00:04:28.7379692Z      }
2025-11-10T00:04:28.7380152Z -    
2025-11-10T00:04:28.7380611Z +
2025-11-10T00:04:28.7381591Z      // Pack 8 inputs into contiguous 512-byte buffer
2025-11-10T00:04:28.7382159Z      let mut input_buf = [0u8; 512];
2025-11-10T00:04:28.7382862Z      for (i, input) in inputs.iter().enumerate() {
2025-11-10T00:04:28.7385075Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1035:
2025-11-10T00:04:28.7385878Z          input_buf[i * 64..(i + 1) * 64].copy_from_slice(input);
2025-11-10T00:04:28.7386340Z      }
2025-11-10T00:04:28.7386800Z -    
2025-11-10T00:04:28.7387270Z +
2025-11-10T00:04:28.7387843Z      // Transform (double SHA256)
2025-11-10T00:04:28.7388420Z      let mut output_buf = [0u8; 256];
2025-11-10T00:04:28.7389118Z      transform_8way(&mut output_buf, &input_buf);
2025-11-10T00:04:28.7391198Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1041:
2025-11-10T00:04:28.7391668Z -    
2025-11-10T00:04:28.7392129Z +
2025-11-10T00:04:28.7392650Z      // Unpack results
2025-11-10T00:04:28.7393235Z      let mut results = [[0u8; 32]; 8];
2025-11-10T00:04:28.7393733Z      for i in 0..8 {
2025-11-10T00:04:28.7395974Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1045:
2025-11-10T00:04:28.7396921Z          results[i].copy_from_slice(&output_buf[i * 32..(i + 1) * 32]);
2025-11-10T00:04:28.7397385Z      }
2025-11-10T00:04:28.7397853Z -    
2025-11-10T00:04:28.7398312Z +
2025-11-10T00:04:28.7398785Z      results
2025-11-10T00:04:28.7399248Z  }
2025-11-10T00:04:28.7399716Z  
2025-11-10T00:04:28.7402165Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1085:
2025-11-10T00:04:28.7402713Z          input_buf[1] = 0x45;
2025-11-10T00:04:28.7403262Z          input_buf[2] = 0x23;
2025-11-10T00:04:28.7403796Z          input_buf[3] = 0x01;
2025-11-10T00:04:28.7404265Z -        
2025-11-10T00:04:28.7404855Z +
2025-11-10T00:04:28.7405345Z          unsafe {
2025-11-10T00:04:28.7405893Z              // Read from offset 0
2025-11-10T00:04:28.7406709Z              let v = read8(&input_buf, 0);
2025-11-10T00:04:28.7409005Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1092:
2025-11-10T00:04:28.7409917Z -            
2025-11-10T00:04:28.7410386Z +
2025-11-10T00:04:28.7410965Z              // Extract the first word
2025-11-10T00:04:28.7411722Z              // After _mm256_set_epi32(words[7], ..., words[0]):
2025-11-10T00:04:28.7412336Z              // - Index 0 = words[0] (block 0)
2025-11-10T00:04:28.7414810Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1096:
2025-11-10T00:04:28.7415426Z              // - Index 7 = words[7] (block 7)
2025-11-10T00:04:28.7417706Z              // So we extract from index 0 for block 0
2025-11-10T00:04:28.7418421Z              let word0 = _mm256_extract_epi32(v, 0) as u32;
2025-11-10T00:04:28.7418896Z -            
2025-11-10T00:04:28.7419364Z +
2025-11-10T00:04:28.7420003Z              println!("Read8 shuffle test:");
2025-11-10T00:04:28.7420900Z              println!("  Input: 0x01234567 (LE bytes: [67, 45, 23, 01])");
2025-11-10T00:04:28.7421601Z              println!("  Output word0: 0x{:08x}", word0);
2025-11-10T00:04:28.7423681Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1103:
2025-11-10T00:04:28.7425415Z              println!("  Expected: 0x01234567 (if no swap) or 0x67452301 (if byte-reversed)");
2025-11-10T00:04:28.7428128Z              println!("  Or maybe: 0x23014567 or something else depending on shuffle");
2025-11-10T00:04:28.7428605Z -            
2025-11-10T00:04:28.7429068Z +
2025-11-10T00:04:28.7429718Z              // Also check what the shuffle mask does
2025-11-10T00:04:28.7430477Z              let test_word = _mm256_set1_epi32(0x01234567);
2025-11-10T00:04:28.7431101Z              let shuffle_mask = _mm256_set_epi32(
2025-11-10T00:04:28.7433185Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1109:
2025-11-10T00:04:28.7433943Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.7434796Z -                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203,
2025-11-10T00:04:28.7436149Z +                0x0C0D0E0F, 0x08090A0B, 0x04050607, 0x00010203, 0x0C0D0E0F, 0x08090A0B, 0x04050607,
2025-11-10T00:04:28.7436664Z +                0x00010203,
2025-11-10T00:04:28.7437204Z              );
2025-11-10T00:04:28.7438157Z              let shuffled = _mm256_shuffle_epi8(test_word, shuffle_mask);
2025-11-10T00:04:28.7439113Z              let shuffled_word = _mm256_extract_epi32(shuffled, 0) as u32;
2025-11-10T00:04:28.7441206Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1134:
2025-11-10T00:04:28.7441768Z              let mut f = k(0x9b05688c);
2025-11-10T00:04:28.7442326Z              let mut g = k(0x1f83d9ab);
2025-11-10T00:04:28.7442901Z              let mut h = k(0x5be0cd19);
2025-11-10T00:04:28.7443395Z -            
2025-11-10T00:04:28.7443837Z +
2025-11-10T00:04:28.7444763Z              let d_before = _mm256_extract_epi32(d, 0) as u32;
2025-11-10T00:04:28.7445516Z              let h_before = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7446000Z -            
2025-11-10T00:04:28.7446472Z +
2025-11-10T00:04:28.7447021Z              // Call round macro
2025-11-10T00:04:28.7447705Z              round!(a, b, c, d, e, f, g, h, k(0x428a2f98));
2025-11-10T00:04:28.7450058Z -            
2025-11-10T00:04:28.7450517Z +
2025-11-10T00:04:28.7451257Z              let d_after = _mm256_extract_epi32(d, 0) as u32;
2025-11-10T00:04:28.7451985Z              let h_after = _mm256_extract_epi32(h, 0) as u32;
2025-11-10T00:04:28.7452459Z -            
2025-11-10T00:04:28.7452925Z +
2025-11-10T00:04:28.7453720Z              println!("Round macro state modification test:");
2025-11-10T00:04:28.7455231Z -            println!("  d before: 0x{:08x}, after: 0x{:08x} (should be different)", d_before, d_after);
2025-11-10T00:04:28.7456917Z -            println!("  h before: 0x{:08x}, after: 0x{:08x} (should be different)", h_before, h_after);
2025-11-10T00:04:28.7457405Z -            
2025-11-10T00:04:28.7459561Z +            println!(
2025-11-10T00:04:28.7460442Z +                "  d before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-10T00:04:28.7460995Z +                d_before, d_after
2025-11-10T00:04:28.7461466Z +            );
2025-11-10T00:04:28.7461968Z +            println!(
2025-11-10T00:04:28.7462841Z +                "  h before: 0x{:08x}, after: 0x{:08x} (should be different)",
2025-11-10T00:04:28.7463393Z +                h_before, h_after
2025-11-10T00:04:28.7463866Z +            );
2025-11-10T00:04:28.7464588Z +
2025-11-10T00:04:28.7465167Z              if d_before == d_after {
2025-11-10T00:04:28.7465863Z                  println!("  ERROR: d was not modified!");
2025-11-10T00:04:28.7466334Z              }
2025-11-10T00:04:28.7468434Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1168:
2025-11-10T00:04:28.7469094Z          // Test with 8 identical 64-byte inputs
2025-11-10T00:04:28.7469642Z          let test_data = [0u8; 64];
2025-11-10T00:04:28.7470192Z          let inputs: [&[u8]; 8] = [
2025-11-10T00:04:28.7470936Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-10T00:04:28.7471669Z -            &test_data, &test_data, &test_data, &test_data,
2025-11-10T00:04:28.7473286Z +            &test_data, &test_data, &test_data, &test_data, &test_data, &test_data, &test_data,
2025-11-10T00:04:28.7473807Z +            &test_data,
2025-11-10T00:04:28.7474279Z          ];
2025-11-10T00:04:28.7474884Z  
2025-11-10T00:04:28.7475362Z          unsafe {
2025-11-10T00:04:28.7477592Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1176:
2025-11-10T00:04:28.7478307Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-10T00:04:28.7478796Z -            
2025-11-10T00:04:28.7479263Z +
2025-11-10T00:04:28.7480283Z              // Compute expected result using bitcoin_hashes (double SHA256)
2025-11-10T00:04:28.7481782Z              // bitcoin_hashes::sha256d is the standard Bitcoin double SHA256 implementation
2025-11-10T00:04:28.7482471Z              let mut engine = sha256d::Hash::engine();
2025-11-10T00:04:28.7484720Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1181:
2025-11-10T00:04:28.7485322Z              engine.input(&test_data);
2025-11-10T00:04:28.7487815Z              let expected = sha256d::Hash::from_engine(engine);
2025-11-10T00:04:28.7488524Z              let expected_bytes = expected.into_inner();
2025-11-10T00:04:28.7488996Z -            
2025-11-10T00:04:28.7489462Z +
2025-11-10T00:04:28.7490072Z              // Debug: print first few bytes
2025-11-10T00:04:28.7490844Z              println!("Expected: {:?}", &expected_bytes[..8]);
2025-11-10T00:04:28.7491609Z              println!("Got:      {:?}", &avx2_results[0][..8]);
2025-11-10T00:04:28.7493713Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1188:
2025-11-10T00:04:28.7494193Z -            
2025-11-10T00:04:28.7494788Z +
2025-11-10T00:04:28.7495541Z              // All 8 results should be identical (same input)
2025-11-10T00:04:28.7496342Z              for (i, result) in avx2_results.iter().enumerate() {
2025-11-10T00:04:28.7496958Z                  if result != &expected_bytes {
2025-11-10T00:04:28.7499426Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1192:
2025-11-10T00:04:28.7500384Z -                    println!("Mismatch at index {}: expected {:?}, got {:?}", 
2025-11-10T00:04:28.7501072Z -                        i, &expected_bytes[..16], &result[..16]);
2025-11-10T00:04:28.7501602Z +                    println!(
2025-11-10T00:04:28.7502393Z +                        "Mismatch at index {}: expected {:?}, got {:?}",
2025-11-10T00:04:28.7503125Z +                        i,
2025-11-10T00:04:28.7503896Z +                        &expected_bytes[..16],
2025-11-10T00:04:28.7504594Z +                        &result[..16]
2025-11-10T00:04:28.7505097Z +                    );
2025-11-10T00:04:28.7505573Z                  }
2025-11-10T00:04:28.7506092Z                  assert_eq!(
2025-11-10T00:04:28.7506692Z                      result, &expected_bytes,
2025-11-10T00:04:28.7508764Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1215:
2025-11-10T00:04:28.7509339Z              input_data[i][0] = i as u8;
2025-11-10T00:04:28.7509809Z          }
2025-11-10T00:04:28.7510365Z          let inputs: [&[u8]; 8] = [
2025-11-10T00:04:28.7511395Z -            &input_data[0], &input_data[1], &input_data[2], &input_data[3],
2025-11-10T00:04:28.7512353Z -            &input_data[4], &input_data[5], &input_data[6], &input_data[7],
2025-11-10T00:04:28.7512911Z +            &input_data[0],
2025-11-10T00:04:28.7513442Z +            &input_data[1],
2025-11-10T00:04:28.7513967Z +            &input_data[2],
2025-11-10T00:04:28.7514662Z +            &input_data[3],
2025-11-10T00:04:28.7515195Z +            &input_data[4],
2025-11-10T00:04:28.7515851Z +            &input_data[5],
2025-11-10T00:04:28.7516381Z +            &input_data[6],
2025-11-10T00:04:28.7516915Z +            &input_data[7],
2025-11-10T00:04:28.7517384Z          ];
2025-11-10T00:04:28.7517842Z  
2025-11-10T00:04:28.7518332Z          unsafe {
2025-11-10T00:04:28.7521187Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1223:
2025-11-10T00:04:28.7521911Z              let avx2_results = sha256_8way_avx2(&inputs);
2025-11-10T00:04:28.7522384Z -            
2025-11-10T00:04:28.7522852Z +
2025-11-10T00:04:28.7523556Z              // Compute expected results using sha2 crate
2025-11-10T00:04:28.7524444Z              for (i, input) in input_data.iter().enumerate() {
2025-11-10T00:04:28.7525179Z                  let mut engine = sha256d::Hash::engine();
2025-11-10T00:04:28.7527278Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha256_avx2.rs:1228:
2025-11-10T00:04:28.7527862Z                  engine.input(input);
2025-11-10T00:04:28.7529014Z                  let expected = sha256d::Hash::from_engine(engine);
2025-11-10T00:04:28.7529738Z                  let expected_bytes = expected.into_inner();
2025-11-10T00:04:28.7530218Z -                
2025-11-10T00:04:28.7530677Z +
2025-11-10T00:04:28.7531206Z                  assert_eq!(
2025-11-10T00:04:28.7532200Z                      &avx2_results[i], &expected_bytes,
2025-11-10T00:04:28.7533268Z                      "AVX2 result {} does not match expected double SHA256 for input {}",
2025-11-10T00:04:28.7535311Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:59:
2025-11-10T00:04:28.7535769Z  
2025-11-10T00:04:28.7537175Z      // SHA256 constants (first 32 bits of fractional parts of cube roots of first 64 primes)
2025-11-10T00:04:28.7537721Z      const K: [u32; 64] = [
2025-11-10T00:04:28.7539392Z -        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,
2025-11-10T00:04:28.7541006Z -        0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,
2025-11-10T00:04:28.7542632Z -        0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,
2025-11-10T00:04:28.7544236Z -        0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,
2025-11-10T00:04:28.7545967Z -        0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,
2025-11-10T00:04:28.7547570Z -        0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,
2025-11-10T00:04:28.7549184Z -        0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-10T00:04:28.7551199Z -        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2,
2025-11-10T00:04:28.7552553Z +        0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4,
2025-11-10T00:04:28.7553906Z +        0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe,
2025-11-10T00:04:28.7555405Z +        0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f,
2025-11-10T00:04:28.7556761Z +        0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,
2025-11-10T00:04:28.7558102Z +        0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc,
2025-11-10T00:04:28.7559448Z +        0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b,
2025-11-10T00:04:28.7561107Z +        0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116,
2025-11-10T00:04:28.7562663Z +        0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,
2025-11-10T00:04:28.7564067Z +        0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7,
2025-11-10T00:04:28.7564700Z +        0xc67178f2,
2025-11-10T00:04:28.7565170Z      ];
2025-11-10T00:04:28.7565643Z  
2025-11-10T00:04:28.7566250Z      // Process input data with padding
2025-11-10T00:04:28.7568156Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:73:
2025-11-10T00:04:28.7569222Z      let mut padded = Vec::with_capacity(((data.len() + 9 + 63) / 64) * 64);
2025-11-10T00:04:28.7569825Z      padded.extend_from_slice(data);
2025-11-10T00:04:28.7570288Z -    
2025-11-10T00:04:28.7570755Z +
2025-11-10T00:04:28.7571587Z      // Add padding: 0x80 byte, then zeros, then 64-bit length
2025-11-10T00:04:28.7572127Z      padded.push(0x80);
2025-11-10T00:04:28.7572730Z      let bit_len = (data.len() as u64) * 8;
2025-11-10T00:04:28.7574822Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:102:
2025-11-10T00:04:28.7575388Z          let state1_save = state1;
2025-11-10T00:04:28.7575848Z  
2025-11-10T00:04:28.7576355Z          // Rounds 0-3
2025-11-10T00:04:28.7577649Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32));
2025-11-10T00:04:28.7580047Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7580524Z +            msg0,
2025-11-10T00:04:28.7581701Z +            _mm_set_epi32(K[3] as i32, K[2] as i32, K[1] as i32, K[0] as i32),
2025-11-10T00:04:28.7582171Z +        );
2025-11-10T00:04:28.7582958Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7583568Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-10T00:04:28.7584470Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7586393Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:109:
2025-11-10T00:04:28.7586881Z  
2025-11-10T00:04:28.7587378Z          // Rounds 4-7
2025-11-10T00:04:28.7590526Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32));
2025-11-10T00:04:28.7591060Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7591549Z +            msg1,
2025-11-10T00:04:28.7592455Z +            _mm_set_epi32(K[7] as i32, K[6] as i32, K[5] as i32, K[4] as i32),
2025-11-10T00:04:28.7592927Z +        );
2025-11-10T00:04:28.7593715Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7594450Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-10T00:04:28.7595233Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7597141Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:115:
2025-11-10T00:04:28.7597781Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-10T00:04:28.7598494Z  
2025-11-10T00:04:28.7599003Z          // Rounds 8-11
2025-11-10T00:04:28.7600544Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32));
2025-11-10T00:04:28.7601088Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7601571Z +            msg2,
2025-11-10T00:04:28.7602512Z +            _mm_set_epi32(K[11] as i32, K[10] as i32, K[9] as i32, K[8] as i32),
2025-11-10T00:04:28.7602984Z +        );
2025-11-10T00:04:28.7603761Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7604565Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-10T00:04:28.7605797Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7607718Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:122:
2025-11-10T00:04:28.7608345Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-10T00:04:28.7608812Z  
2025-11-10T00:04:28.7609322Z          // Rounds 12-15
2025-11-10T00:04:28.7610633Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32));
2025-11-10T00:04:28.7611206Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7611687Z +            msg3,
2025-11-10T00:04:28.7612630Z +            _mm_set_epi32(K[15] as i32, K[14] as i32, K[13] as i32, K[12] as i32),
2025-11-10T00:04:28.7613103Z +        );
2025-11-10T00:04:28.7613893Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7614658Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-10T00:04:28.7615248Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-10T00:04:28.7617170Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:132:
2025-11-10T00:04:28.7617801Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-10T00:04:28.7618269Z  
2025-11-10T00:04:28.7618784Z          // Rounds 16-19
2025-11-10T00:04:28.7620113Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32));
2025-11-10T00:04:28.7620660Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7621137Z +            msg0,
2025-11-10T00:04:28.7622089Z +            _mm_set_epi32(K[19] as i32, K[18] as i32, K[17] as i32, K[16] as i32),
2025-11-10T00:04:28.7622568Z +        );
2025-11-10T00:04:28.7623346Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7624014Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-10T00:04:28.7624733Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-10T00:04:28.7626638Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:142:
2025-11-10T00:04:28.7627270Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-10T00:04:28.7627742Z  
2025-11-10T00:04:28.7628256Z          // Rounds 20-23
2025-11-10T00:04:28.7629579Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32));
2025-11-10T00:04:28.7630123Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7630617Z +            msg1,
2025-11-10T00:04:28.7631574Z +            _mm_set_epi32(K[23] as i32, K[22] as i32, K[21] as i32, K[20] as i32),
2025-11-10T00:04:28.7632045Z +        );
2025-11-10T00:04:28.7632831Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7633453Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-10T00:04:28.7634032Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-10T00:04:28.7637877Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:152:
2025-11-10T00:04:28.7638523Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-10T00:04:28.7638989Z  
2025-11-10T00:04:28.7639510Z          // Rounds 24-27
2025-11-10T00:04:28.7640832Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32));
2025-11-10T00:04:28.7641371Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7641854Z +            msg2,
2025-11-10T00:04:28.7642800Z +            _mm_set_epi32(K[27] as i32, K[26] as i32, K[25] as i32, K[24] as i32),
2025-11-10T00:04:28.7643520Z +        );
2025-11-10T00:04:28.7644906Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7645584Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-10T00:04:28.7647996Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-10T00:04:28.7650014Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:162:
2025-11-10T00:04:28.7650650Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-10T00:04:28.7651117Z  
2025-11-10T00:04:28.7651629Z          // Rounds 28-31
2025-11-10T00:04:28.7652960Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32));
2025-11-10T00:04:28.7653506Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7653986Z +            msg3,
2025-11-10T00:04:28.7655072Z +            _mm_set_epi32(K[31] as i32, K[30] as i32, K[29] as i32, K[28] as i32),
2025-11-10T00:04:28.7655573Z +        );
2025-11-10T00:04:28.7656358Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7656991Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-10T00:04:28.7657575Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-10T00:04:28.7659500Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:172:
2025-11-10T00:04:28.7660128Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-10T00:04:28.7660589Z  
2025-11-10T00:04:28.7661112Z          // Rounds 32-35
2025-11-10T00:04:28.7662523Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32));
2025-11-10T00:04:28.7663052Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7663551Z +            msg0,
2025-11-10T00:04:28.7664627Z +            _mm_set_epi32(K[35] as i32, K[34] as i32, K[33] as i32, K[32] as i32),
2025-11-10T00:04:28.7665110Z +        );
2025-11-10T00:04:28.7665896Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7666538Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-10T00:04:28.7667131Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-10T00:04:28.7670389Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:182:
2025-11-10T00:04:28.7671027Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-10T00:04:28.7671490Z  
2025-11-10T00:04:28.7672008Z          // Rounds 36-39
2025-11-10T00:04:28.7673329Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32));
2025-11-10T00:04:28.7673874Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7674484Z +            msg1,
2025-11-10T00:04:28.7675435Z +            _mm_set_epi32(K[39] as i32, K[38] as i32, K[37] as i32, K[36] as i32),
2025-11-10T00:04:28.7675920Z +        );
2025-11-10T00:04:28.7676702Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7677326Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-10T00:04:28.7679933Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-10T00:04:28.7682057Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:192:
2025-11-10T00:04:28.7682691Z          msg0 = _mm_sha256msg1_epu32(msg0, msg1);
2025-11-10T00:04:28.7683159Z  
2025-11-10T00:04:28.7683678Z          // Rounds 40-43
2025-11-10T00:04:28.7685147Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32));
2025-11-10T00:04:28.7685689Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7686178Z +            msg2,
2025-11-10T00:04:28.7687119Z +            _mm_set_epi32(K[43] as i32, K[42] as i32, K[41] as i32, K[40] as i32),
2025-11-10T00:04:28.7687589Z +        );
2025-11-10T00:04:28.7688376Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7688995Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-10T00:04:28.7689577Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-10T00:04:28.7691729Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:202:
2025-11-10T00:04:28.7692524Z          msg1 = _mm_sha256msg1_epu32(msg1, msg2);
2025-11-10T00:04:28.7692992Z  
2025-11-10T00:04:28.7693505Z          // Rounds 44-47
2025-11-10T00:04:28.7694971Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32));
2025-11-10T00:04:28.7695519Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7695999Z +            msg3,
2025-11-10T00:04:28.7696937Z +            _mm_set_epi32(K[47] as i32, K[46] as i32, K[45] as i32, K[44] as i32),
2025-11-10T00:04:28.7697461Z +        );
2025-11-10T00:04:28.7698248Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7698864Z          tmp = _mm_alignr_epi8(msg3, msg2, 4);
2025-11-10T00:04:28.7699453Z          msg0 = _mm_add_epi32(msg0, tmp);
2025-11-10T00:04:28.7701368Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:212:
2025-11-10T00:04:28.7702012Z          msg2 = _mm_sha256msg1_epu32(msg2, msg3);
2025-11-10T00:04:28.7702482Z  
2025-11-10T00:04:28.7703007Z          // Rounds 48-51
2025-11-10T00:04:28.7704457Z -        msg = _mm_add_epi32(msg0, _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32));
2025-11-10T00:04:28.7704999Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7705486Z +            msg0,
2025-11-10T00:04:28.7706500Z +            _mm_set_epi32(K[51] as i32, K[50] as i32, K[49] as i32, K[48] as i32),
2025-11-10T00:04:28.7706980Z +        );
2025-11-10T00:04:28.7707766Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7708387Z          tmp = _mm_alignr_epi8(msg0, msg3, 4);
2025-11-10T00:04:28.7708969Z          msg1 = _mm_add_epi32(msg1, tmp);
2025-11-10T00:04:28.7710885Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:222:
2025-11-10T00:04:28.7711520Z          msg3 = _mm_sha256msg1_epu32(msg3, msg0);
2025-11-10T00:04:28.7711998Z  
2025-11-10T00:04:28.7712508Z          // Rounds 52-55
2025-11-10T00:04:28.7713862Z -        msg = _mm_add_epi32(msg1, _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32));
2025-11-10T00:04:28.7714542Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7715029Z +            msg1,
2025-11-10T00:04:28.7715975Z +            _mm_set_epi32(K[55] as i32, K[54] as i32, K[53] as i32, K[52] as i32),
2025-11-10T00:04:28.7716445Z +        );
2025-11-10T00:04:28.7717224Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7717845Z          tmp = _mm_alignr_epi8(msg1, msg0, 4);
2025-11-10T00:04:28.7718435Z          msg2 = _mm_add_epi32(msg2, tmp);
2025-11-10T00:04:28.7720340Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:231:
2025-11-10T00:04:28.7721125Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7721596Z  
2025-11-10T00:04:28.7722125Z          // Rounds 56-59
2025-11-10T00:04:28.7723459Z -        msg = _mm_add_epi32(msg2, _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32));
2025-11-10T00:04:28.7724000Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7724623Z +            msg2,
2025-11-10T00:04:28.7725565Z +            _mm_set_epi32(K[59] as i32, K[58] as i32, K[57] as i32, K[56] as i32),
2025-11-10T00:04:28.7726038Z +        );
2025-11-10T00:04:28.7726821Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7727437Z          tmp = _mm_alignr_epi8(msg2, msg1, 4);
2025-11-10T00:04:28.7728063Z          msg3 = _mm_add_epi32(msg3, tmp);
2025-11-10T00:04:28.7729990Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:240:
2025-11-10T00:04:28.7730773Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7731236Z  
2025-11-10T00:04:28.7731751Z          // Rounds 60-63
2025-11-10T00:04:28.7733078Z -        msg = _mm_add_epi32(msg3, _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32));
2025-11-10T00:04:28.7733833Z +        msg = _mm_add_epi32(
2025-11-10T00:04:28.7734676Z +            msg3,
2025-11-10T00:04:28.7735637Z +            _mm_set_epi32(K[63] as i32, K[62] as i32, K[61] as i32, K[60] as i32),
2025-11-10T00:04:28.7736108Z +        );
2025-11-10T00:04:28.7736884Z          state1 = _mm_sha256rnds2_epu32(state1, state0, msg);
2025-11-10T00:04:28.7737499Z          msg = _mm_shuffle_epi32(msg, 0x0E);
2025-11-10T00:04:28.7738278Z          state0 = _mm_sha256rnds2_epu32(state0, state1, msg);
2025-11-10T00:04:28.7740615Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:254:
2025-11-10T00:04:28.7741557Z      // state0 contains h0,h1,h4,h5 and state1 contains h2,h3,h6,h7
2025-11-10T00:04:28.7742215Z      // Need to reorder to h0,h1,h2,h3,h4,h5,h6,h7
2025-11-10T00:04:28.7742773Z      let mut result = [0u8; 32];
2025-11-10T00:04:28.7743235Z -    
2025-11-10T00:04:28.7743724Z +
2025-11-10T00:04:28.7744488Z      // Extract and byte-swap each 32-bit word
2025-11-10T00:04:28.7745389Z      let state0_swapped = _mm_shuffle_epi8(state0, shuf_mask);
2025-11-10T00:04:28.7746279Z      let state1_swapped = _mm_shuffle_epi8(state1, shuf_mask);
2025-11-10T00:04:28.7748193Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:261:
2025-11-10T00:04:28.7748658Z -    
2025-11-10T00:04:28.7749119Z +
2025-11-10T00:04:28.7750206Z      _mm_storeu_si128(result.as_mut_ptr() as *mut __m128i, state0_swapped);
2025-11-10T00:04:28.7751387Z      _mm_storeu_si128(result.as_mut_ptr().add(16) as *mut __m128i, state1_swapped);
2025-11-10T00:04:28.7751853Z  
2025-11-10T00:04:28.7753775Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:286:
2025-11-10T00:04:28.7754470Z              fallback_sha256(data)
2025-11-10T00:04:28.7754943Z          }
2025-11-10T00:04:28.7755407Z      }
2025-11-10T00:04:28.7755889Z -    
2025-11-10T00:04:28.7756348Z +
2025-11-10T00:04:28.7756946Z      #[cfg(not(target_arch = "x86_64"))]
2025-11-10T00:04:28.7757409Z      {
2025-11-10T00:04:28.7757968Z          fallback_sha256(data)
2025-11-10T00:04:28.7759889Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:316:
2025-11-10T00:04:28.7760442Z      fn test_sha256_empty() {
2025-11-10T00:04:28.7760969Z          let input = b"";
2025-11-10T00:04:28.7761532Z          let result = sha256(input);
2025-11-10T00:04:28.7762011Z -        
2025-11-10T00:04:28.7762472Z +
2025-11-10T00:04:28.7763987Z          // Expected SHA256(""): e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2025-11-10T00:04:28.7764719Z          let expected = [
2025-11-10T00:04:28.7767427Z -            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24,
2025-11-10T00:04:28.7768748Z -            0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55,
2025-11-10T00:04:28.7769961Z +            0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f,
2025-11-10T00:04:28.7771167Z +            0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b,
2025-11-10T00:04:28.7771703Z +            0x78, 0x52, 0xb8, 0x55,
2025-11-10T00:04:28.7772178Z          ];
2025-11-10T00:04:28.7772653Z -        
2025-11-10T00:04:28.7773116Z +
2025-11-10T00:04:28.7773755Z          assert_eq!(result, expected);
2025-11-10T00:04:28.7774271Z      }
2025-11-10T00:04:28.7774867Z  
2025-11-10T00:04:28.7777557Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:330:
2025-11-10T00:04:28.7778126Z      fn test_sha256_hello_world() {
2025-11-10T00:04:28.7778701Z          let input = b"hello world";
2025-11-10T00:04:28.7779266Z          let result = sha256(input);
2025-11-10T00:04:28.7779735Z -        
2025-11-10T00:04:28.7780285Z +
2025-11-10T00:04:28.7781066Z          // Compare with sha2 crate
2025-11-10T00:04:28.7781924Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.7782723Z          let expected = Sha256::digest(input);
2025-11-10T00:04:28.7784793Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:337:
2025-11-10T00:04:28.7785271Z -        
2025-11-10T00:04:28.7785732Z +
2025-11-10T00:04:28.7786370Z          assert_eq!(&result[..], &expected[..]);
2025-11-10T00:04:28.7786827Z      }
2025-11-10T00:04:28.7787291Z  
2025-11-10T00:04:28.7789224Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:343:
2025-11-10T00:04:28.7789794Z          // Test various input sizes
2025-11-10T00:04:28.7790367Z          let zeros_64 = vec![0u8; 64];
2025-11-10T00:04:28.7790932Z          let ff_128 = vec![0xffu8; 128];
2025-11-10T00:04:28.7791405Z -        
2025-11-10T00:04:28.7791865Z +
2025-11-10T00:04:28.7792451Z          let test_cases: Vec<&[u8]> = vec![
2025-11-10T00:04:28.7792998Z              b"" as &[u8],
2025-11-10T00:04:28.7793479Z              b"a",
2025-11-10T00:04:28.7795552Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:357:
2025-11-10T00:04:28.7796017Z  
2025-11-10T00:04:28.7796595Z          for input in test_cases {
2025-11-10T00:04:28.7797617Z              let result = sha256(input);
2025-11-10T00:04:28.7798097Z -            
2025-11-10T00:04:28.7798563Z +
2025-11-10T00:04:28.7799132Z              // Must match sha2 crate
2025-11-10T00:04:28.7799732Z              use sha2::{Digest, Sha256};
2025-11-10T00:04:28.7800375Z              let expected = Sha256::digest(input);
2025-11-10T00:04:28.7802299Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:364:
2025-11-10T00:04:28.7802772Z -            
2025-11-10T00:04:28.7804036Z -            assert_eq!(&result[..], &expected[..], "Mismatch for input length {}", input.len());
2025-11-10T00:04:28.7804730Z +
2025-11-10T00:04:28.7805265Z +            assert_eq!(
2025-11-10T00:04:28.7805786Z +                &result[..],
2025-11-10T00:04:28.7806331Z +                &expected[..],
2025-11-10T00:04:28.7806963Z +                "Mismatch for input length {}",
2025-11-10T00:04:28.7807485Z +                input.len()
2025-11-10T00:04:28.7807953Z +            );
2025-11-10T00:04:28.7808427Z          }
2025-11-10T00:04:28.7808892Z      }
2025-11-10T00:04:28.7809348Z  
2025-11-10T00:04:28.7811266Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:370:
2025-11-10T00:04:28.7811832Z      fn test_double_sha256() {
2025-11-10T00:04:28.7812394Z          let input = b"hello world";
2025-11-10T00:04:28.7812967Z          let result = hash256(input);
2025-11-10T00:04:28.7813439Z -        
2025-11-10T00:04:28.7813897Z +
2025-11-10T00:04:28.7814913Z          // Manually compute double SHA256 with sha2 crate
2025-11-10T00:04:28.7815507Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.7816131Z          let first = Sha256::digest(input);
2025-11-10T00:04:28.7818053Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:377:
2025-11-10T00:04:28.7818692Z          let expected = Sha256::digest(&first);
2025-11-10T00:04:28.7819181Z -        
2025-11-10T00:04:28.7819646Z +
2025-11-10T00:04:28.7820278Z          assert_eq!(&result[..], &expected[..]);
2025-11-10T00:04:28.7820751Z      }
2025-11-10T00:04:28.7821211Z  
2025-11-10T00:04:28.7823170Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:384:
2025-11-10T00:04:28.7823861Z          // Test with 64 zero bytes (same as AVX2 test)
2025-11-10T00:04:28.7824553Z          let input = vec![0u8; 64];
2025-11-10T00:04:28.7825135Z          let result = hash256(&input);
2025-11-10T00:04:28.7825605Z -        
2025-11-10T00:04:28.7826070Z +
2025-11-10T00:04:28.7826638Z          // Compare with sha2 crate
2025-11-10T00:04:28.7827209Z          use sha2::{Digest, Sha256};
2025-11-10T00:04:28.7828057Z          let first = Sha256::digest(&input);
2025-11-10T00:04:28.7830160Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:391:
2025-11-10T00:04:28.7830800Z          let expected = Sha256::digest(&first);
2025-11-10T00:04:28.7831277Z -        
2025-11-10T00:04:28.7831735Z +
2025-11-10T00:04:28.7832366Z          assert_eq!(&result[..], &expected[..]);
2025-11-10T00:04:28.7832833Z      }
2025-11-10T00:04:28.7833297Z  }
2025-11-10T00:04:28.7835346Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/sha_ni.rs:396:
2025-11-10T00:04:28.7837435Z -
2025-11-10T00:04:28.7837905Z  
2025-11-10T00:04:28.7840057Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/crypto/simd_bytes.rs:99:
2025-11-10T00:04:28.7840606Z          assert_eq!(dst, src);
2025-11-10T00:04:28.7841069Z      }
2025-11-10T00:04:28.7841541Z  }
2025-11-10T00:04:28.7841998Z -
2025-11-10T00:04:28.7842478Z  
2025-11-10T00:04:28.7844519Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:47:
2025-11-10T00:04:28.7845071Z  pub mod transaction;
2025-11-10T00:04:28.7845641Z  pub mod transaction_hash;
2025-11-10T00:04:28.7847805Z  pub mod types;
2025-11-10T00:04:28.7848708Z +#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-10T00:04:28.7849796Z +pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-10T00:04:28.7850369Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.7851023Z  pub use script::batch_verify_signatures;
2025-11-10T00:04:28.7851907Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-10T00:04:28.7853577Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/lib.rs:53:
2025-11-10T00:04:28.7854100Z  pub use script::{
2025-11-10T00:04:28.7855847Z -    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool,
2025-11-10T00:04:28.7874837Z -    disable_caching, reset_benchmarking_state,
2025-11-10T00:04:28.7877728Z +    clear_all_caches, clear_hash_cache, clear_script_cache, clear_stack_pool, disable_caching,
2025-11-10T00:04:28.7880441Z +    reset_benchmarking_state,
2025-11-10T00:04:28.7882103Z  };
2025-11-10T00:04:28.7883605Z -#[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-10T00:04:28.7887632Z -pub use block::{reset_assume_valid_height, set_assume_valid_height};
2025-11-10T00:04:28.7890196Z  #[cfg(all(feature = "production", feature = "benchmarking"))]
2025-11-10T00:04:28.7892475Z  pub use transaction_hash::clear_sighash_templates;
2025-11-10T00:04:28.7894471Z  pub mod bip113;
2025-11-10T00:04:28.7897680Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mempool.rs:99:
2025-11-10T00:04:28.7900592Z                  .map(|(i, opt_utxo)| {
2025-11-10T00:04:28.7902277Z                      if let Some(utxo) = opt_utxo {
2025-11-10T00:04:28.7904087Z                          let input = &tx.inputs[*i];
2025-11-10T00:04:28.7906118Z -                        let witness: Option<&ByteString> =
2025-11-10T00:04:28.7908330Z -                            witnesses.and_then(|wits| wits.get(*i)).and_then(|wit| {
2025-11-10T00:04:28.7910475Z -                                wit.first()
2025-11-10T00:04:28.7912101Z -                            });
2025-11-10T00:04:28.7913804Z +                        let witness: Option<&ByteString> = witnesses
2025-11-10T00:04:28.7917854Z +                            .and_then(|wits| wits.get(*i))
2025-11-10T00:04:28.7919701Z +                            .and_then(|wit| wit.first());
2025-11-10T00:04:28.7921383Z  
2025-11-10T00:04:28.7923184Z                          verify_script(&input.script_sig, &utxo.script_pubkey, witness, flags)
2025-11-10T00:04:28.7925714Z                      } else {
2025-11-10T00:04:28.7930062Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/mining.rs:440:
2025-11-10T00:04:28.7932868Z  }
2025-11-10T00:04:28.7933922Z  
2025-11-10T00:04:28.7935487Z  /// Simple SHA256 hash function
2025-11-10T00:04:28.7936943Z -/// 
2025-11-10T00:04:28.7938009Z +///
2025-11-10T00:04:28.7940342Z  /// Performance optimization: Uses OptimizedSha256 (SHA-NI or AVX2) instead of sha2 crate
2025-11-10T00:04:28.7943232Z  /// for faster hashing in Merkle tree construction.
2025-11-10T00:04:28.7945175Z  #[inline(always)]
2025-11-10T00:04:28.7949505Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:239:
2025-11-10T00:04:28.7953256Z      /// - Small batches (< 4 items): Sequential (overhead not worth parallelization)
2025-11-10T00:04:28.7957727Z      /// - Medium batches (4-7 items): Chunked sequential
2025-11-10T00:04:28.7960401Z      /// - Large batches (≥8 items): Multi-core parallelization with Rayon
2025-11-10T00:04:28.7962970Z -    /// 
2025-11-10T00:04:28.7964061Z +    ///
2025-11-10T00:04:28.7965342Z      /// # Optimizations
2025-11-10T00:04:28.7967134Z      /// - Uses sha2 crate with "asm" feature for optimized assembly
2025-11-10T00:04:28.7969767Z      /// - For large batches, leverages Rayon for multi-core parallelization
2025-11-10T00:04:28.7973428Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/optimizations.rs:287:
2025-11-10T00:04:28.7977223Z                  return avx2_batch::batch_sha256_avx2(inputs);
2025-11-10T00:04:28.7979008Z              }
2025-11-10T00:04:28.7980151Z          }
2025-11-10T00:04:28.7981456Z -        
2025-11-10T00:04:28.7982531Z +
2025-11-10T00:04:28.7983917Z          // Fallback: Multi-core parallelization using Rayon
2025-11-10T00:04:28.7986213Z          // Rayon is enabled via the 'production' feature
2025-11-10T00:04:28.7988440Z          // This leverages multiple CPU cores for parallel hashing
2025-11-10T00:04:28.7991630Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:20:
2025-11-10T00:04:28.7994706Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.7997980Z  use std::collections::VecDeque;
2025-11-10T00:04:28.7999648Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.8001623Z -use std::sync::{OnceLock, RwLock, atomic::{AtomicBool, Ordering}};
2025-11-10T00:04:28.8003722Z +use std::sync::{
2025-11-10T00:04:28.8005392Z +    atomic::{AtomicBool, Ordering},
2025-11-10T00:04:28.8008130Z +    OnceLock, RwLock,
2025-11-10T00:04:28.8009391Z +};
2025-11-10T00:04:28.8010549Z  #[cfg(feature = "production")]
2025-11-10T00:04:28.8012053Z  use std::thread_local;
2025-11-10T00:04:28.8013350Z  
2025-11-10T00:04:28.8015865Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1044:
2025-11-10T00:04:28.8020468Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-10T00:04:28.8023048Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-10T00:04:28.8025588Z                          if tx.inputs.len() > 1 {
2025-11-10T00:04:28.8028053Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-10T00:04:28.8031104Z +                            let sighashes =
2025-11-10T00:04:28.8033266Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-10T00:04:28.8035623Z                              sighashes[input_index]
2025-11-10T00:04:28.8039196Z                          } else {
2025-11-10T00:04:28.8041073Z                              // Single input: use individual calculation (no overhead)
2025-11-10T00:04:28.8044524Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1051:
2025-11-10T00:04:28.8050363Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-10T00:04:28.8053032Z +                            calculate_transaction_sighash(
2025-11-10T00:04:28.8058028Z +                                tx,
2025-11-10T00:04:28.8059662Z +                                input_index,
2025-11-10T00:04:28.8061743Z +                                prevouts,
2025-11-10T00:04:28.8063735Z +                                SighashType::All,
2025-11-10T00:04:28.8065820Z +                            )?
2025-11-10T00:04:28.8068721Z                          }
2025-11-10T00:04:28.8070049Z                      }
2025-11-10T00:04:28.8071485Z                      #[cfg(not(feature = "production"))]
2025-11-10T00:04:28.8074610Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1091:
2025-11-10T00:04:28.8077890Z                          use crate::transaction_hash::batch_compute_sighashes;
2025-11-10T00:04:28.8080476Z                          // Use batch computation if we have multiple inputs (more efficient)
2025-11-10T00:04:28.8083050Z                          if tx.inputs.len() > 1 {
2025-11-10T00:04:28.8086230Z -                            let sighashes = batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-10T00:04:28.8089042Z +                            let sighashes =
2025-11-10T00:04:28.8091206Z +                                batch_compute_sighashes(tx, prevouts, SighashType::All)?;
2025-11-10T00:04:28.8093435Z                              sighashes[input_index]
2025-11-10T00:04:28.8095277Z                          } else {
2025-11-10T00:04:28.8097155Z                              // Single input: use individual calculation (no overhead)
2025-11-10T00:04:28.8100462Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1098:
2025-11-10T00:04:28.8104255Z -                            calculate_transaction_sighash(tx, input_index, prevouts, SighashType::All)?
2025-11-10T00:04:28.8107034Z +                            calculate_transaction_sighash(
2025-11-10T00:04:28.8108824Z +                                tx,
2025-11-10T00:04:28.8110393Z +                                input_index,
2025-11-10T00:04:28.8112046Z +                                prevouts,
2025-11-10T00:04:28.8115787Z +                                SighashType::All,
2025-11-10T00:04:28.8117559Z +                            )?
2025-11-10T00:04:28.8118953Z                          }
2025-11-10T00:04:28.8120288Z                      }
2025-11-10T00:04:28.8121739Z                      #[cfg(not(feature = "production"))]
2025-11-10T00:04:28.8124851Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/script.rs:1474:
2025-11-10T00:04:28.8127991Z      clear_all_caches();
2025-11-10T00:04:28.8129372Z      clear_stack_pool();
2025-11-10T00:04:28.8131095Z      disable_caching(false); // Re-enable caching by default
2025-11-10T00:04:28.8133934Z -    // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-10T00:04:28.8138952Z +                            // Also clear sighash templates (currently no-op as templates aren't populated yet)
2025-11-10T00:04:28.8141615Z      #[cfg(feature = "benchmarking")]
2025-11-10T00:04:28.8143499Z      crate::transaction_hash::clear_sighash_templates();
2025-11-10T00:04:28.8147077Z  }
2025-11-10T00:04:28.8149394Z Diff in /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus/src/types.rs:32:
2025-11-10T00:04:28.8152734Z  #[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize)]
2025-11-10T00:04:28.8154994Z  pub struct TransactionInput {
2025-11-10T00:04:28.8157005Z      pub prevout: OutPoint,      // Hot: 40 bytes (frequently accessed)
2025-11-10T00:04:28.8159608Z -    pub sequence: Natural,     // Hot: 8 bytes (frequently accessed)
2025-11-10T00:04:28.8162196Z +    pub sequence: Natural,      // Hot: 8 bytes (frequently accessed)
2025-11-10T00:04:28.8165134Z      pub script_sig: ByteString, // Cold: Vec (pointer, less frequently accessed)
2025-11-10T00:04:28.8168434Z  }
2025-11-10T00:04:28.8169486Z  
2025-11-10T00:04:28.8685114Z ##[error]Process completed with exit code 1.
2025-11-10T00:04:28.8880527Z Post job cleanup.
2025-11-10T00:04:29.0314075Z [command]/usr/bin/git version
2025-11-10T00:04:29.0365991Z git version 2.43.0
2025-11-10T00:04:29.0422010Z Copying '/home/jswift/.gitconfig' to '/home/jswift/actions-runner-org2/_work/_temp/3ed97e5d-578a-40df-983a-8e9238630ac4/.gitconfig'
2025-11-10T00:04:29.0441704Z Temporarily overriding HOME='/home/jswift/actions-runner-org2/_work/_temp/3ed97e5d-578a-40df-983a-8e9238630ac4' before making global git config changes
2025-11-10T00:04:29.0448098Z Adding repository directory to the temporary git global config as a safe directory
2025-11-10T00:04:29.0452525Z [command]/usr/bin/git config --global --add safe.directory /home/jswift/actions-runner-org2/_work/bllvm-consensus/bllvm-consensus
2025-11-10T00:04:29.0510040Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-11-10T00:04:29.0562838Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-11-10T00:04:29.0946520Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-11-10T00:04:29.0981797Z http.https://github.com/.extraheader
2025-11-10T00:04:29.1014605Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2025-11-10T00:04:29.1067016Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-11-10T00:04:29.1609332Z A job completed hook has been configured by the self-hosted runner administrator
2025-11-10T00:04:29.1697535Z ##[group]Run '/home/jswift/actions-runner-org2/cleanup-hooks/job-completed.sh'
2025-11-10T00:04:29.1743484Z shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
2025-11-10T00:04:29.1745606Z ##[endgroup]
2025-11-10T00:04:29.1872921Z Job completed: Mon Nov 10 12:04:29 AM UTC 2025
2025-11-10T00:04:29.1921446Z Available disk space: 9.2G
2025-11-10T00:04:29.1927932Z Cleaning up after job completion...
2025-11-10T00:04:29.3076792Z Cleanup completed. Available disk space: 9.2G
2025-11-10T00:04:29.3145692Z Cleaning up orphan processes
